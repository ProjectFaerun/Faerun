namespace = EME

###MISSIONS### (start on 1000)

#Mission tombola
character_event = {
	id = EME.1000
	hide_window = yes

	is_triggered_only = yes
	is_in_society = yes
	only_capable = yes

	trigger = {
		OR = {
			society_member_of = shadow_druids
			society_member_of = emerald_enclave
		}
		has_any_quest = no
		NOT = { has_character_modifier = quest_cooldown_timer }
		NOT = { is_inaccessible_trigger = yes }
	}

	immediate = {
		random_society_member = {
			limit = {
				NOT = { character = ROOT }
				same_society_as = ROOT
			}
			save_event_target_as = quest_giver
		}

		random_list = {
			10 = {
        modifier = {
					factor = 0
					is_playable = no
				}
				modifier = {
					factor = 0
					has_character_modifier = worshipped_spirits_timer
				}
				character_event = { id = EME.1001 } #appease spirits
			}
      10 = {
        modifier = {
          factor = 0
          NOR = {
    	      society_rank = {
    	        rank >= 2
    	        society = emerald_enclave
    	      }
    				society_rank = {
    	        rank >= 2
    	        society = shadow_druids
    	      }
    			}
        }
				modifier = {
					factor = 0
					has_character_modifier = scrying_cooldown
				}
				modifier = {
					factor = 0
					has_an_omen_modifier_trigger = yes
				}
				character_event = { id = EME.1004 } #perform scrying
			}
			20 = {
				modifier = {
					factor = 0
					ai = no
				}
				#Do nothing for AI
			}
		}
	}
}

#MISSION: Appease Spirits
character_event = {
	id = EME.1001
	hide_window = yes

	is_triggered_only = yes

	immediate = {
    event_target:quest_giver = {
      character_event = { id = EME.1002 }
    }
	}
}
#Ping event for quest giver
character_event = {
	id = EME.1002
	hide_window = yes

	is_triggered_only = yes

	immediate = {
		FROM = { society_quest_event = { id = EME.1003 days = 7 random = 7 } }
	}
}
#You get the mission
society_quest_event = {
	id = EME.1003
	title = quest_appease_spirits
  desc = EVTDESC_EME_1003
	border = GFX_event_letter_frame_religion

	trigger = {
		is_in_society = yes
	}

	is_triggered_only = yes

  option = {
		name = ACCEPT
		set_quest = quest_appease_spirits
	}
	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }

		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}

		ai_chance = { factor = 0 }
	}
}

#MISSION: Perform Scrying
character_event = {
	id = EME.1004
	hide_window = yes

	is_triggered_only = yes

	immediate = {
    event_target:quest_giver = {
      character_event = { id = EME.1005 }
    }
	}
}
#Ping event for quest giver
character_event = {
	id = EME.1005
	hide_window = yes

	is_triggered_only = yes

	immediate = {
		FROM = { society_quest_event = { id = EME.1006 days = 7 random = 7 } }
	}
}
#You get the mission
society_quest_event = {
	id = EME.1006
	title = quest_perform_scrying
  desc = EVTDESC_EME_1006
	border = GFX_event_letter_frame_religion

	trigger = {
		is_in_society = yes
	}

	is_triggered_only = yes

  option = {
		name = ACCEPT
		set_quest = quest_perform_scrying
	}
	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }

		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}

		ai_chance = { factor = 0 }
	}
}

###Invite Druid###

  #druid invited
  character_event = {
      id = EME.25000
      desc = EVTDESC_EME_25000
  		picture = GFX_evt_tribal_shrine
      border = GFX_event_normal_frame_war

      is_triggered_only = yes

      option = {
          name = EVTOPTA_EME_25000
          event_target:invited_lodge_soldier = {
              show_scope_change = no
              opinion = {
                  modifier = opinion_loyal_servant
                  who = ROOT
                  years = 10
              }
          }
          ai_chance = {
              factor = 100
          }
      }
  }

###Appease Spirits###

  #Start appease
  character_event = {
  	id = EME.7000
  	desc = EVTDESC_EME_7000
  	border = GFX_event_normal_frame_religion
  	picture = GFX_evt_tribal_shrine

  	is_triggered_only = yes

  	#Health
  	option = {
  		name = EVTOPTA_EME_7000

  		ai_chance = {
  			factor = 100

  			modifier = {
  				factor = 2
  				NOT = { health = 3 }
  			}
  			modifier = {
  				factor = 2
  				trait = paranoid
  			}
  		}

  		trigger = {
  			OR = {
  				has_disease_trigger = yes
  				trait = ill
  				NOT = { health = 4 }
  				has_character_flag = developing_illness
  			}
  		}
  		set_character_flag = ancestors_health
  		hidden_tooltip = { character_event = { id = EME.7001 days = 3 } }
  	}

  	#Relationships - family, friends & love
  	option = {
  		name = EVTOPTB_EME_7000

  		ai_chance = {
  			factor = 33

  			modifier = {
  				factor = 2
  				trait = kind
  			}
  			modifier = {
  				factor = 2
  				trait = gregarious
  			}
  			modifier = {
  				factor = 2
  				trait = lustful
  			}
  			modifier = {
  				factor = 2
  				trait = socializer
  			}
  		}

  		trigger = {	NOT = { trait = cruel } }
  		set_character_flag = ancestors_relationships
  		hidden_tooltip = { character_event = { id = EME.7001 days = 3 } }
  	}

  	#War
  	option = {
  		name = EVTOPTC_EME_7000

  		ai_chance = {
  			factor = 33

  			modifier = {
  				factor = 2
  				trait = brave
  			}
  			modifier = {
  				factor = 2
  				is_strong_trigger = yes
  			}
  			modifier = {
  				factor = 2
  				trait = ambitious
  			}
  			modifier = {
  				factor = 2
  				trait = strategist
  			}
  		}

  		trigger = {	NOT = { trait = craven } }
  		set_character_flag = ancestors_war
  		hidden_tooltip = { character_event = { id = EME.7001 days = 3 } }
  	}

  	#Prosperity
  	option = {
  		name = EVTOPTD_EME_7000

  		ai_chance = {
  			factor = 33

  			modifier = {
  				factor = 2
  				trait = diligent
  			}
  			modifier = {
  				factor = 2
  				trait = patient
  			}
  			modifier = {
  				factor = 2
  				trait = content
  			}
  			modifier = {
  				factor = 2
  				trait = gardener
  			}
  		}

  		trigger = {	is_nomadic = no }
  		set_character_flag = ancestors_prosperity
  		hidden_tooltip = { character_event = { id = EME.7001 days = 3 } }
  	}

  	#Wisdom
  	option = {
  		name = EVTOPTE_EME_7000

  		ai_chance = {
  			factor = 33

  			modifier = {
  				factor = 2
  				trait = erudite
  			}
  			modifier = {
  				factor = 2
  				is_smart_trigger = yes
  			}
  			modifier = {
  				factor = 2
  				trait = humble
  			}
  			modifier = {
  				factor = 2
  				trait = scholar
  			}
  		}

  		trigger = {	is_dumb_trigger = no }
  		set_character_flag = ancestors_wisdom
  		hidden_tooltip = { character_event = { id = EME.7001 days = 3 } }
  	}
  }

  #Make an offer
  character_event = {
  	id = EME.7001
  	border = GFX_event_normal_frame_religion
  	picture = GFX_evt_tribal_shrine

  	hide_from = yes

  	desc = {
  		trigger = { has_character_flag = ancestors_health }
  		text = EVTDESC_EME_7001_health
  	}
  	desc = {
  		trigger = { has_character_flag = ancestors_relationships }
  		text = EVTDESC_EME_7001_relationships
  	}
  	desc = {
  		trigger = { has_character_flag = ancestors_war }
  		text = EVTDESC_EME_7001_war
  	}
  	desc = {
  		trigger = { has_character_flag = ancestors_prosperity }
  		text = EVTDESC_EME_7001_prosperity
  	}
  	desc = {
  		trigger = { has_character_flag = ancestors_wisdom }
  		text = EVTDESC_EME_7001_wisdom
  	}

  	is_triggered_only = yes

		immediate = {
			hidden_effect = {
				random_courtier = {
					limit = {
						prisoner = yes
						age = 12
						host = { character = ROOT }
					}
					save_event_target_as = human_sacrifice_prisoner
				}
			}
		}

  	#Massive gift
  	option = {
  		name = EVTOPTA_EME_7001
  		custom_tooltip = { text = EVTOPTA_EME_7001_TOOLTIP }

  		piety = 100

  		ai_chance = {
  			factor = 0.01

  			modifier = {
  				factor = 0.5
  				trait = greedy
  			}
  		}

  		scaled_wealth = { value = -2.5 min = -100 max = -2500 }

  		hidden_tooltip = { character_event = { id = EME.7002 days = 3 } }

  		set_character_flag = ancestors_massive_gift
  	}

    #Sacrifice prisoner
  	option = {
  		name = EVTOPTB_TOG_7001
  		custom_tooltip = { text = EVTOPTB_TOG_7001_TOOLTIP }

      trigger = {
        society_member_of = shadow_druids
				event_target:human_sacrifice_prisoner = { always = yes }
      }

  		piety = 60

  		ai_chance = {
  			factor = 20

  			modifier = {
  				factor = 2
  				trait = cruel
  			}
  			modifier = {
  				factor = 2
  				trait = arbitrary
  			}
  		}

  		set_character_flag = ancestors_human

  		event_target:human_sacrifice_prisoner = {
  			show_scope_change = no
  			death = { death_reason = death_sacrificed_ancestors killer = ROOT }
  		}

  		event_target:human_sacrifice_prisoner = { save_event_target_as = kinslayer_target }
  		add_kinslayer_trait_effect = yes

  		event_target:human_sacrifice_prisoner = { save_event_target_as = portrait_target }

  		hidden_tooltip = { character_event = { id = EME.7002 days = 3 } }
  	}

  	#Great gift
  	option = {
  		name = EVTOPTB_EME_7001
  		custom_tooltip = { text = EVTOPTB_EME_7001_TOOLTIP }

      trigger = {
				society_member_of = emerald_enclave
      }

  		piety = 60

  		ai_chance = {
  			factor = 1

  			modifier = {
  				factor = 0.5
  				trait = greedy
  			}
  		}

  		scaled_wealth = { value = -1 min = -40 max = -1000 }

  		hidden_tooltip = { character_event = { id = EME.7002 days = 3 } }

  		set_character_flag = ancestors_great_gift
  	}

  	#Great feast
  	option = {
  		name = EVTOPTC_EME_7001
  		custom_tooltip = { text = EVTOPTC_EME_7001_TOOLTIP }

  		piety = 40

  		ai_chance = {
  			factor = 10
  		}

  		scaled_wealth = { value = -0.5 min = -20 max = -500 }

  		hidden_tooltip = { character_event = { id = EME.7002 days = 3 } }

  		set_character_flag = ancestors_feast
  	}

  	#Minor Sacrifice
  	option = {
  		name = EVTOPTD_EME_7001
  		custom_tooltip = { text = EVTOPTD_EME_7001_TOOLTIP }

  		piety = 10

  		ai_chance = {
  			factor = 10

  			modifier = {
  				factor = 2
  				trait = greedy
  			}
  		}

  		treasury = -5

  		hidden_tooltip = { character_event = { id = EME.7002 days = 3 } }

  		set_character_flag = ancestors_carving
  	}
  }

  #End of offer
  character_event = {
  	id = EME.7002
  	border = GFX_event_normal_frame_religion
  	picture = GFX_evt_tribal_shrine
  	portrait = event_target:portrait_target

  	desc = {
  		trigger = { has_character_flag = ancestors_massive_gift }
  		text = EVTDESC_EME_7002_massive
  		picture = GFX_evt_forest_a
  	}
		desc = {
			trigger = { has_character_flag = ancestors_human }
			text = EVTDESC_TOG_7002_human
			picture = GFX_evt_torture
		}
  	desc = {
  		trigger = { has_character_flag = ancestors_great_gift }
  		text = EVTDESC_EME_7002_great
  		picture = GFX_evt_treasure
  	}
  	desc = {
  		trigger = { has_character_flag = ancestors_feast }
  		text = EVTDESC_EME_7002_feast
  	}
  	desc = {
  		trigger = { has_character_flag = ancestors_carving }
  		text = EVTDESC_EME_7002_carving
  	}

  	is_triggered_only = yes

  	option = {
  		name = EVTOPTA_TOG_7002

  		clr_character_flag = do_not_disturb

  		#OUTCOMES

  		#Health
  		if = {
  			limit = { has_character_flag = ancestors_health }

  			#Massive gift
  			if = {
  				limit = { has_character_flag = ancestors_massive_gift }

  				hidden_tooltip = {
  					random_list = {
              20 = {
                modifier = { factor = 0 is_strong_trigger = yes } #Robust
                character_event = { id = EME.7011 days = 300 }
              }
  						30 = { character_event = { id = EME.7010 days = 30 } } #Remove disease/blessing of health
  						30 = { character_event = { id = EME.7012 days = 200 } } #Health bonus
  						20 = { } #Nothing
  					}
  				}
  			}
  			#Great gift
  			if = {
					limit = {
						OR = {
							has_character_flag = ancestors_great_gift
							has_character_flag = ancestors_human
						}
					}

  				hidden_tooltip = {
  					random_list = {
              10 = {
                modifier = { factor = 0 is_strong_trigger = yes } #Robust
                character_event = { id = EME.7011 days = 300 }
              }
  						15 = { character_event = { id = EME.7010 days = 30 } } #Remove disease/blessing of health

  						40 = { character_event = { id = EME.7012 days = 200 } } #Health bonus
  						5 = { character_event = { id = EME.7013 days = 150 } } #Illness
  						30 = { } #Nothing
  					}
  				}
  			}
  			#Big gift
  			if = {
  				limit = { has_character_flag = ancestors_feast }

  				hidden_tooltip = {
  					random_list = {
              4 = {
                modifier = { factor = 0 is_strong_trigger = yes } #Robust
                character_event = { id = EME.7011 days = 300 }
              }
  						6 = { character_event = { id = EME.7010 days = 30 } } #Remove disease/blessing of health
  						40 = { character_event = { id = EME.7012 days = 200 } } #Health bonus
  						10 = { character_event = { id = EME.7013 days = 150 } } #Illness
  						40 = { } #Nothing
  					}
  				}
  			}
  			#Small gift
  			if = {
  				limit = { has_character_flag = ancestors_carving }

  				hidden_tooltip = {
  					random_list = {
  						2 = {
  							modifier = { factor = 0 is_strong_trigger = yes } #Robust
  						 	character_event = { id = EME.7011 days = 300 }
  						}
              3 = { character_event = { id = EME.7010 days = 30 } } #Remove disease/blessing of health
  						30 = { character_event = { id = EME.7012 days = 200 } } #Health bonus
  						25 = { character_event = { id = EME.7013 days = 150 } } #Illness
  						40 = { } #Nothing
  					}
  				}
  			}
  		}

  		#Relationships
  		if = {
  			limit = { has_character_flag = ancestors_relationships }
  			clr_character_flag = ancestors_relationships

  			#Massive
  			if = {
  				limit = { has_character_flag = ancestors_massive_gift }

  				hidden_tooltip = {
  					random_list = {
  						10 = { character_event = { id = EME.7024 days = 350 } } #Good with people
  						15 = { character_event = { id = EME.7020 days = 100 } } #Lover
  						15 = { character_event = { id = EME.7021 days = 150 } } #Friend
  						20 = { character_event = { id = EME.7022 days = 300 } } #Diplomacy bonus
  						20 = { character_event = { id = EME.7025 days = 100 } } #Cat
  						20 = { } #Nothing
  					}
  				}
  			}
  			#Great
  			if = {
					limit = {
						OR = {
							has_character_flag = ancestors_great_gift
							has_character_flag = ancestors_human
						}
					}

  				hidden_tooltip = {
  					random_list = {
  						5 = { character_event = { id = EME.7024 days = 350 } } #Good with people
  						15 = { character_event = { id = EME.7020 days = 100 } } #Lover
  						15 = { character_event = { id = EME.7021 days = 150 } } #Friend
  						15 = { character_event = { id = EME.7022 days = 300 } } #Diplomacy bonus
  						15 = { character_event = { id = EME.7025 days = 100 } } #Cat
  						5 = { character_event = { id = EME.7023 days = 150 } } #Rival
  						30 = { } #Nothing
  					}
  				}
  			}
  			#Big gift
  			if = {
  				limit = { has_character_flag = ancestors_feast }

  				hidden_tooltip = {
  					random_list = {
  						3 = { character_event = { id = EME.7024 days = 350 } } #Good with people
  						10 = { character_event = { id = EME.7020 days = 100 } } #Lover
  						10 = { character_event = { id = EME.7021 days = 150 } } #Friend
  						12 = { character_event = { id = EME.7022 days = 300 } } #Diplomacy bonus
  						15 = { character_event = { id = EME.7025 days = 100 } } #Cat
  						10 = { character_event = { id = EME.7023 days = 150 } } #Rival
  						40 = { } #Nothing
  					}
  				}
  			}
  			#Small gift
  			if = {
  				limit = { has_character_flag = ancestors_carving }

  				hidden_tooltip = {
  					random_list = {
  						1 = { character_event = { id = EME.7024 days = 300 } } #Good with people
  						7 = { character_event = { id = EME.7020 days = 100 } } #Lover
  						7 = { character_event = { id = EME.7021 days = 150 } } #Friend
  						10 = { character_event = { id = EME.7022 days = 300 } } #Diplomacy bonus
  						10 = { character_event = { id = EME.7025 days = 100 } } #Cat
  						25 = { character_event = { id = EME.7023 days = 150 } } #Rival
  						40 = { } #Nothing
  					}
  				}
  			}
  		}

  		#War
  		if = {
  			limit = { has_character_flag = ancestors_war }
  			clr_character_flag = ancestors_war

  			#Massive
  			if = {
  				limit = { has_character_flag = ancestors_massive_gift }

  				hidden_tooltip = {
  					random_list = {
              20 = {
                modifier = { factor = 0 is_strong_trigger = yes } #Robust
                character_event = { id = EME.7011 days = 360 }
              }
              10 = {
  							modifier = { factor = 0 can_have_more_leadership_traits = no } #Leadership trait
  							character_event = { id = EME.7032 days = 360 }
  						}
  						15 = { character_event = { id = EME.7035 days = 150 } } #Increased levy
  						15 = { character_event = { id = EME.7034 days = 100 } } #War tech
  						20 = { character_event = { id = EME.7030 days = 100 } } #Commander
  						20 = { } #Nothing
  					}
  				}
  			}
  			#Great
  			if = {
					limit = {
						OR = {
							has_character_flag = ancestors_great_gift
							has_character_flag = ancestors_human
						}
					}

  				hidden_tooltip = {
  					random_list = {
              10 = {
                modifier = { factor = 0 is_strong_trigger = yes } #Robust
                character_event = { id = EME.7011 days = 360 }
              }
              5 = {
  							modifier = { factor = 0 can_have_more_leadership_traits = no } #Leadership trait
  							character_event = { id = EME.7032 days = 360 }
  						}
  						15 = { character_event = { id = EME.7035 days = 150 } } #Increased levy
  						15 = { character_event = { id = EME.7034 days = 100 } } #War tech
  						20 = { character_event = { id = EME.7030 days = 100 } } #Commander
  						5 = { character_event = { id = EME.7033 days = 100 } } #Maimed
  						30 = { } #Nothing
  					}
  				}
  			}
  			#Big gift
  			if = {
  				limit = { has_character_flag = ancestors_feast }

  				hidden_tooltip = {
  					random_list = {
              5 = {
                modifier = { factor = 0 is_strong_trigger = yes } #Robust
                character_event = { id = EME.7011 days = 360 }
              }
              5 = {
  							modifier = { factor = 0 can_have_more_leadership_traits = no } #Leadership trait
  							character_event = { id = EME.7032 days = 360 }
  						}
  						10 = { character_event = { id = EME.7035 days = 150 } } #Increased levy
  						10 = { character_event = { id = EME.7034 days = 100 } } #War tech
  						20 = { character_event = { id = EME.7030 days = 100 } } #Commander
  						10 = { character_event = { id = EME.7033 days = 100 } } #Maimed
  						40 = { } #Nothing
  					}
  				}
  			}
  			#Small gift
  			if = {
  				limit = { has_character_flag = ancestors_carving }

  				hidden_tooltip = {
  					random_list = {
              2 = {
                modifier = { factor = 0 is_strong_trigger = yes } #Robust
                character_event = { id = EME.7011 days = 360 }
              }
              3 = {
  							modifier = { factor = 0 can_have_more_leadership_traits = no } #Leadership trait
  							character_event = { id = EME.7032 days = 360 }
  						}
  						10 = { character_event = { id = EME.7035 days = 150 } } #Increased levy
  						10 = { character_event = { id = EME.7034 days = 100 } } #War tech
  						10 = { character_event = { id = EME.7030 days = 100 } } #Commander
  						25 = { character_event = { id = EME.7033 days = 100 } } #Maimed
  						40 = { } #Nothing
  					}
  				}
  			}
  		}

  		#Prosperity
  		if = {
  			limit = { has_character_flag = ancestors_prosperity }

  			if = { #Massive
  				limit = { has_character_flag = ancestors_massive_gift }

  				hidden_tooltip = {
  					random_list = {
  						20 = {
  							if = {
  								limit = {
  									capital_scope = {
  										NOR = {
  											has_province_modifier = depopulated_1
  											has_province_modifier = depopulated_2
  											has_province_modifier = depopulated_3
  										}
  									}
  								}
  								character_event = { id = EME.7040 days = 500 } #Increase prosperity level
  							}
  							if = {
  								limit = {
  									capital_scope = {
  										OR = {
  											has_province_modifier = depopulated_1
  											has_province_modifier = depopulated_2
  											has_province_modifier = depopulated_3
  										}
  									}
  								}
  								character_event = { id = EME.7044 days = 500 } #Decrease depopulation level
  							}
  						}
  						30 = { character_event = { id = EME.7041 days = 100 } } #Economy tech points
  						30 = { character_event = { id = EME.7042 days = 200 } } #Stewardship bonus
  						20 = { } #Nothing
  					}
  				}
  			}
  			if = { #Great
					limit = {
						OR = {
							has_character_flag = ancestors_great_gift
							has_character_flag = ancestors_human
						}
					}

  				hidden_tooltip = {
  					random_list = {
  						10 = {
  							if = {
  								limit = {
  									capital_scope = {
  										NOR = {
  											has_province_modifier = depopulated_1
  											has_province_modifier = depopulated_2
  											has_province_modifier = depopulated_3
  										}
  									}
  								}
  								character_event = { id = EME.7040 days = 500 } #Increase prosperity level
  							}
  							if = {
  								limit = {
  									capital_scope = {
  										OR = {
  											has_province_modifier = depopulated_1
  											has_province_modifier = depopulated_2
  											has_province_modifier = depopulated_3
  										}
  									}
  								}
  								character_event = { id = EME.7044 days = 500 } #Decrease depopulation level
  							}
  						}
  						15 = { character_event = { id = EME.7041 days = 100 } } #Economy tech points
  						40 = { character_event = { id = EME.7042 days = 200 } } #Stewardship bonus
  						5 = { character_event = { id = EME.7043 days = 300 } } #Less tax
  						30 = { } #Nothing
  					}
  				}
  			}
  			#Big gift
  			if = {
  				limit = { has_character_flag = ancestors_feast }

  				hidden_tooltip = {
  					random_list = {
  						5 = {
  							if = {
  								limit = {
  									capital_scope = {
  										NOR = {
  											has_province_modifier = depopulated_1
  											has_province_modifier = depopulated_2
  											has_province_modifier = depopulated_3
  										}
  									}
  								}
  								character_event = { id = EME.7040 days = 500 } #Increase prosperity level
  							}
  							if = {
  								limit = {
  									capital_scope = {
  										OR = {
  											has_province_modifier = depopulated_1
  											has_province_modifier = depopulated_2
  											has_province_modifier = depopulated_3
  										}
  									}
  								}
  								character_event = { id = EME.7044 days = 500 } #Decrease depopulation level
  							}
  						}
  						15 = { character_event = { id = EME.7041 days = 100 } } #Economy tech points
  						30 = { character_event = { id = EME.7042 days = 200 } } #Stewardship bonus
  						10 = { character_event = { id = EME.7043 days = 300 } } #Less tax
  						40 = { } #Nothing
  					}
  				}
  			}
  			#Small gift
  			if = {
  				limit = { has_character_flag = ancestors_carving }

  				hidden_tooltip = {
  					random_list = {
  						2 = {
  							if = {
  								limit = {
  									capital_scope = {
  										NOR = {
  											has_province_modifier = depopulated_1
  											has_province_modifier = depopulated_2
  											has_province_modifier = depopulated_3
  										}
  									}
  								}
  								character_event = { id = EME.7040 days = 500 } #Increase prosperity level
  							}
  							if = {
  								limit = {
  									capital_scope = {
  										OR = {
  											has_province_modifier = depopulated_1
  											has_province_modifier = depopulated_2
  											has_province_modifier = depopulated_3
  										}
  									}
  								}
  								character_event = { id = EME.7044 days = 500 } #Decrease depopulation level
  							}
  						}
  						10 = { character_event = { id = EME.7041 days = 100 } } #Economy tech points
  						23 = { character_event = { id = EME.7042 days = 200 } } #Stewardship bonus
  						25 = { character_event = { id = EME.7043 days = 300 } } #Less tax
  						40 = { } #Nothing
  					}
  				}
  			}
  		}

  		#Wisdom
  		if = {
  			limit = { has_character_flag = ancestors_wisdom }

  			if = { #Massive
  				limit = { has_character_flag = ancestors_massive_gift }

  				hidden_tooltip = {
  					random_list = {
  						20 = {
  							modifier = { factor = 0 is_smart_trigger = yes } #Shrewd
  							character_event = { id = EME.7050 days = 400 }
  						}
  						20 = { character_event = { id = EME.7051 days = 200 } } #Wise woman
  						20 = { character_event = { id = EME.7054 days = 300 } } #Owl
  						20 = { character_event = { id = EME.7052 days = 300 } } #Learning bonus
  						20 = { } #Nothing
  					}
  				}
  			}
  			if = { #Great
					limit = {
						OR = {
							has_character_flag = ancestors_great_gift
							has_character_flag = ancestors_human
						}
					}

  				hidden_tooltip = {
  					random_list = {
  						10 = {
  							modifier = { factor = 0 is_smart_trigger = yes } #Shrewd
  							character_event = { id = EME.7050 days = 400 }
  						}
  						15 = { character_event = { id = EME.7051 days = 200 } } #Wise woman
  						20 = { character_event = { id = EME.7054 days = 300 } } #Owl
  						20 = { character_event = { id = EME.7052 days = 300 } } #Learning bonus
  						5 = {
  							modifier = { factor = 0 is_dumb_trigger = yes } #Dull
  							character_event = { id = EME.7053 days = 200 }
  						}
  						30 = { } #Nothing
  					}
  				}
  			}
  			#Big gift
  			if = {
  				limit = { has_character_flag = ancestors_feast }

  				hidden_tooltip = {
  					random_list = {
  						5 = {
  							modifier = { factor = 0 is_smart_trigger = yes } #Shrewd
  							character_event = { id = EME.7050 days = 400 }
  						}
  						10 = { character_event = { id = EME.7051 days = 200 } } #Wise woman
  						15 = { character_event = { id = EME.7054 days = 300 } } #Owl
  						20 = { character_event = { id = EME.7052 days = 300 } } #Learning bonus
  						10 = {
  							modifier = { factor = 0 is_dumb_trigger = yes } #Dull
  							character_event = { id = EME.7053 days = 200 }
  						}
  						40 = { } #Nothing
  					}
  				}
  			}
  			#Small gift
  			if = {
  				limit = { has_character_flag = ancestors_carving }

  				hidden_tooltip = {
  					random_list = {
  						2 = {
  							modifier = { factor = 0 is_smart_trigger = yes } #Shrewd
  							character_event = { id = EME.7050 days = 400 }
  						}
  						5 = { character_event = { id = EME.7051 days = 200 } } #Wise woman
  						10 = { character_event = { id = EME.7054 days = 300 } } #Owl
  						18 = { character_event = { id = EME.7052 days = 300 } } #Learning bonus
  						25 = {
  							modifier = { factor = 0 is_dumb_trigger = yes } #Dull
  							character_event = { id = EME.7053 days = 200 }
  						}
  						40 = { } #Nothing
  					}
  				}
  			}
  		}
			clr_character_flag = ancestors_health
			clr_character_flag = ancestors_relationships
			clr_character_flag = ancestors_war
			clr_character_flag = ancestors_prosperity
			clr_character_flag = ancestors_wisdom
			clr_character_flag = ancestors_limb
			clr_character_flag = ancestors_human
			clr_character_flag = ancestors_massive_gift
			clr_character_flag = ancestors_great_gift
			clr_character_flag = ancestors_feast
			clr_character_flag = ancestors_carving
  	}
  }

  #HEALTH OUTCOMES

  #Get healed or blessing of health?
  character_event = {
  	id = EME.7010

  	is_triggered_only = yes
  	hide_window = yes

  	option = {
  		if = {
  			limit = {
  				has_disease_trigger = no
  			}
  			character_event = { id = EME.7014 }
  		}
  		if = {
  			limit = {
  				has_disease_trigger = yes
  			}
  			character_event = { id = EME.7016 }
  		}
  	}
  }

  #Blessing of health
  character_event = {
  	id = EME.7014
  	desc = EVTDESC_TOG_7014
  	border = GFX_event_normal_frame_religion
  	picture = GFX_evt_tribal_shrine

  	is_triggered_only = yes

  	option = {
  		name = EVTOPTA_TOG_7014
  		set_character_flag = old_gods_blessing
  		add_character_modifier = {
  			name = blessing_of_health
  			duration = -1
  		}
  	}
  }

  #Blessing of health healing illness
#  character_event = {
#  	id = EME.7015
#  	desc = EVTDESC_TOG_7015
#  	border = GFX_event_normal_frame_religion
# 	picture = GFX_evt_tribal_shrine
#
#  	is_triggered_only = yes
#
#  	trigger = {
#  		has_disease_trigger = yes
#  	}
#
#  	option = {
#  		name = EVTOPTA_TOG_7015
#  		remove_disease_trait_effect = yes
#  		remove_character_modifier = blessing_of_health
#
#  		if = {
#  			limit = { trait = cynical }
#  			remove_trait = cynical
#  		}
#  		if = {
#  			limit = { NOT = { trait = zealous } }
#  			add_trait = zealous
#  		}
#  		clr_character_flag = old_gods_blessing
#  	}
#  }

  #Healing illness
  character_event = {
  	id = EME.7016
  	desc = EVTDESC_TOG_7016
  	border = GFX_event_normal_frame_religion
  	picture = GFX_evt_tribal_shrine

  	is_triggered_only = yes

  	option = {
  		name = EVTOPTA_TOG_7016
  		remove_disease_trait_effect = yes
  	}
  }


  #Robust
  character_event = {
  	id = EME.7011
  	desc = EVTDESC_TOG_7011
  	border = GFX_event_normal_frame_religion
  	picture = GFX_evt_tribal_shrine

  	is_triggered_only = yes

  	option = {
  		name = EVTOPTA_TOG_7011
		if = {
			limit = { is_weak_congenital_trigger = yes }

			upgrade_strong_congenital_trait_effect = yes
		}
		upgrade_strong_non_congenital_trait_effect = yes
  	}
  }

  #Small health bonus
  character_event = {
  	id = EME.7012
  	desc = EVTDESC_TOG_7012
  	border = GFX_event_normal_frame_religion
  	picture = GFX_evt_tribal_shrine

  	is_triggered_only = yes

  	option = {
  		name = EVTOPTA_TOG_7012
  		add_character_modifier = {
  			name = invigorated
  			years = 10
  		}
  	}
  }

  #Illness
  character_event = {
  	id = EME.7013
  	border = GFX_event_normal_frame_religion
  	picture = GFX_evt_illness

  	desc = {
  		trigger = { has_dlc = "Reapers" }
  		text = EVTDESC_TOG_7013
  		picture = GFX_evt_doctor_tending_to_sick
  	}
  	desc = {
  		trigger = { NOT = { has_dlc = "Reapers" } }
  		text = EVTDESC_TOG_7013
  		picture = GFX_evt_illness
  	}

  	is_triggered_only = yes

  	option = {
  		name = EVTOPTA_TOG_7013
  		hidden_tooltip = { character_event = { id = 6063 days = 20 } }
  	}
  }


  #RELATIONSHIPS

  #Lover
  character_event = {
  	id = EME.7020
  	desc = EVTDESC_TOG_7020
  	border = GFX_event_normal_frame_diplomacy
  	picture = GFX_evt_lovers

  	is_triggered_only = yes

  	immediate = {
  		#Targets male lover
  		if = {
  			limit = { prefers_men_trigger = yes }

  			#Grabs random courtier
  			if = {
  				limit = {
  					any_courtier = {
  						is_adult = yes
  						is_female = no
  						NOT = { is_lover = ROOT }
  						NOT = { is_close_relative = ROOT }
  						ai = yes
  						prisoner = no
  						NOT = { trait = incapable }
  						is_alive = yes
  					}
  				}

  				random_courtier = {
  					limit = {
  						is_adult = yes
  						is_female = no
  						NOT = { is_lover = ROOT }
  						NOT = { is_close_relative = ROOT }
  						ai = yes
  						prisoner = no
  						NOT = { trait = incapable }
  						is_alive = yes
  					}
  					save_event_target_as = ancestors_lover
  				}
  			}

  			#Or creates a new one
  			else = {
  				create_character = {
  					female = no
  					random_traits = yes
  					dynasty = none
  				}
  				new_character = {
  					save_event_target_as = ancestors_lover
  				}
  			}
  		}

  		#Targets female lover
  		if = {
  			limit = { prefers_men_trigger = no }

  			#Grabs random courtier
  			if = {
  				limit = {
  					any_courtier = {
  						is_adult = yes
  						is_female = yes
  						NOT = { is_lover = ROOT }
  						NOT = { is_close_relative = ROOT }
  						ai = yes
  						prisoner = no
  						NOT = { trait = incapable }
  						is_alive = yes
  					}
  				}

  				random_courtier = {
  					limit = {
  						is_adult = yes
  						is_female = yes
  						NOT = { is_lover = ROOT }
  						NOT = { is_close_relative = ROOT }
  						ai = yes
  						prisoner = no
  						NOT = { trait = incapable }
  						is_alive = yes
  					}
  					save_event_target_as = ancestors_lover
  				}
  			}

  			#Or creates a new one
  			else = {
  				create_character = {
  					female = yes
  					random_traits = yes
  					dynasty = none
  				}
  				new_character = {
  					save_event_target_as = ancestors_lover
  				}
  			}
  		}
  	}

  	#Confess
  	option = {
  		name = EVTOPTA_TOG_7020

		event_target:ancestors_lover = {
			save_event_target_as = new_lover
		}
  		new_lover_effect = yes

  		#Makes lover bisexual if both are same sex
  		hidden_tooltip = {
  			if = {
  				limit = { event_target:ancestors_lover = { same_sex = ROOT } }
  				event_target:ancestors_lover = { add_trait = bisexual }
  			}

  			if = {
  				limit = {
  					ROOT = { 
						is_female = no 
						fertility = 0.25
					}
  					event_target:ancestors_lover = {
						is_female = yes 
						fertility = 0.25
					}
  				}
  				random = {
  					chance = 50
  					impregnate = event_target:ancestors_lover
  				}
  			}
  			if = {
  				limit = {
  					ROOT = {
						is_female = yes 
						fertility = 0.25
					}
  					event_target:ancestors_lover = { 
						is_female = no 
						fertility = 0.25
					}
  				}
  				random = {
  					chance = 50
  					event_target:ancestors_lover = { impregnate = ROOT }
  				}
  			}
  		}
  	}

  	#Or don't
  	option = {
  		name = EVTOPTB_TOG_7020

  		ai_chance = {
  			factor = 0
  		}
  	}
  }

  #Friend
  character_event = {
  	id = EME.7021
  	desc = EVTDESC_TOG_7021
  	border = GFX_event_normal_frame_diplomacy
  	picture = GFX_evt_feast

  	is_triggered_only = yes

  	immediate = {
  		#Target a friend
  		if = {
  			limit = {
  				any_courtier = {
  					NOR = {
  						is_friend = ROOT
  						is_rival = ROOT
  						is_lover = ROOT
  						prisoner = yes
  						trait = incapable
  						is_inaccessible_trigger = yes
  						is_alive = no
  					}
  				}
  			}

  			random_courtier = {
  				limit = {
  					NOR = {
  						is_friend = ROOT
  						is_rival = ROOT
  						is_lover = ROOT
  						prisoner = yes
  						trait = incapable
  						is_inaccessible_trigger = yes
  						is_alive = no
  					}
  				}
  				save_event_target_as = ancestors_friend
  			}
  		}

  		#Or create new one
  		else = {
  			create_character = {
  				random_traits = yes
  				dynasty = none
  			}
  			new_character = {
  				save_event_target_as = ancestors_friend
  			}
  		}
  	}

  	#Make friend
  	option = {
  		name = EVTOPTA_TOG_7021
  		add_friend = event_target:ancestors_friend
  	}
  	option = {
  		name = EVTOPTB_TOG_7021
  		ai_chance = {
  			factor = 0
  		}
  	}
  }

  #Small diplomacy bonus
  character_event = {
  	id = EME.7022
  	desc = EVTDESC_TOG_7022
  	border = GFX_event_normal_frame_diplomacy
  	picture = GFX_evt_courtiers_talking

  	is_triggered_only = yes

  	option = {
  		name = EVTOPTA_TOG_7022

  		add_character_modifier = {
  			name = good_listener
  			years = 10
  		}
  	}
  }

  #Rival
  character_event = {
  	id = EME.7023
  	desc = EVTDESC_TOG_7023
  	border = GFX_event_normal_frame_diplomacy
  	picture = GFX_evt_tribal_shrine

  	is_triggered_only = yes

  	immediate = {
  		#Target a rival
  		if = {
  			limit = {
  				any_courtier = {
  					NOR = {
  						is_friend = ROOT
  						is_rival = ROOT
  						is_lover = ROOT
  						prisoner = yes
  						trait = incapable
  						is_inaccessible_trigger = yes
  						is_alive = no
  					}
  				}
  			}

  			random_courtier = {
  				limit = {
  					NOR = {
  						is_friend = ROOT
  						is_rival = ROOT
  						is_lover = ROOT
  						prisoner = yes
  						trait = incapable
  						is_inaccessible_trigger = yes
  						is_alive = no
  					}
  				}
  				save_event_target_as = ancestors_rival
  			}
  		}

  		#Or create new one
  		else = {
  			create_character = {
  				random_traits = yes
  				dynasty = none
  			}
  			new_character = {
  				save_event_target_as = ancestors_rival
  			}
  		}
  	}

  	option = {
  		name = EVTOPTA_TOG_7023
  		add_rival = event_target:ancestors_rival
  	}
  }

  #Good with people
  character_event = {
  	id = EME.7024
  	desc = EVTDESC_TOG_7024
  	border = GFX_event_normal_frame_diplomacy
  	picture = GFX_evt_courtiers_talking

  	is_triggered_only = yes

  	option = {
  		name = EVTOPTA_TOG_7024
  		add_character_modifier = {
  			name = respected_by_the_people
  			duration = -1
  		}
  	}
  }

  #Get a cat
  character_event = {
  	id = EME.7025
  	border = GFX_event_normal_frame_diplomacy
  	picture = GFX_evt_recovery

  	desc = {
  		trigger = { has_dlc = "Reapers" }
  		text = EVTDESC_TOG_7025
  		picture = GFX_evt_cat
  	}
  	desc = {
  		trigger = { NOT = { has_dlc = "Reapers" } }
  		text = EVTDESC_TOG_7025
  		picture = GFX_evt_recovery
  	}


  	is_triggered_only = yes

  	option = {
  		name = EVTOPTA_TOG_7025
  		add_cat_effect = yes
  	}

  	option = {
  		name = EVTOPTB_TOG_7025

  		ai_chance = {
  			factor = 0
  		}

  		add_character_modifier = {
  			name = bad_person
  			years = 1
  		}
  	}
  }


  #WAR

  #Brilliant commander appears
  character_event = {
  	id = EME.7030
  	desc = EVTDESC_TOG_7030
  	border = GFX_event_normal_frame_war
  	picture = GFX_evt_melee

  	is_triggered_only = yes

  	immediate = {
  		if = {
  			limit = {
  				OR = {
  					has_law = status_of_women_3
  					has_law = status_of_women_4
  					has_game_rule = {
  						name = gender
  						value = all
  					}
  					has_religion_feature = religion_matriarchal
  				}
  			}

  			create_character = {
  				female = yes
  				age = 35
  				random_traits = yes
  				trait = strong
  				trait = brave
  				trait = brilliant_strategist
  				trait = holy_warrior
				dynasty = none
  			}
  			new_character = {
  				remove_trait = feeble
  				remove_trait = weak
  				remove_trait = craven
  				remove_trait = imbecile
  				remove_trait = slow
  				remove_trait = dull
  				save_event_target_as = ancestors_commander
  			}
  		}
  		if = {
  			limit = {
  				NOR = {
  					#religion = cathar
  					#religion = messalian
  					has_law = status_of_women_3
  					has_law = status_of_women_4
  					has_game_rule = {
  						name = gender
  						value = all
  					}
  				}
  			}

  			create_character = {
  				female = no
  				age = 35
  				random_traits = yes
  				trait = strong
  				trait = brave
  				trait = brilliant_strategist
  				trait = holy_warrior
				dynasty = none
  			}
  			new_character = {
  				remove_trait = feeble
  				remove_trait = weak
  				remove_trait = craven
  				remove_trait = imbecile
  				remove_trait = slow
  				remove_trait = dull
  				save_event_target_as = ancestors_commander
  			}
  		}
  	}

  	option = {
  		name = EVTOPTA_TOG_7030

  		event_target:ancestors_commander = {
  			opinion = {
  				modifier = opinion_loyal_servant
  				who = ROOT
  				months = 120
  			}
  		}
  	}
  }

  #Robust is TOG.7011

  #Random leadership trait
  character_event = {
  	id = EME.7032
  	desc = EVTDESC_TOG_7032
  	border = GFX_event_normal_frame_war
  	picture = GFX_evt_battle

  	is_triggered_only = yes

  	option = {
  		name = EVTOPTA_TOG_7032

  		random_list = {
  			10 = {
  				modifier = {
  					factor = 0
  					trait = light_foot_leader
  				}
  				add_trait = light_foot_leader
  			}
  			10 = {
  				modifier = {
  					factor = 0
  					trait = heavy_infantry_leader
  				}
  				add_trait = heavy_infantry_leader
  			}
  			10 = {
  				modifier = {
  					factor = 0
  					trait = cavalry_leader
  				}
  				add_trait = cavalry_leader
  			}
  			10 = {
  				modifier = {
  					factor = 0
  					trait = inspiring_leader
  				}
  				add_trait = inspiring_leader
  			}
  			10 = {
  				modifier = {
  					factor = 0
  					trait = defensive_leader
  				}
  				add_trait = defensive_leader
  			}
  			10 = {
  				modifier = {
  					factor = 0
  					trait = flanker
  				}
  				add_trait = flanker
  			}
  			10 = {
  				modifier = {
  					factor = 0
  					trait = siege_leader
  				}
  				add_trait = siege_leader
  			}
  		}
  	}
  }

  #Maimed while practising swordfighting
  character_event = {
  	id = EME.7033
  	desc = EVTDESC_TOG_7033
  	border = GFX_event_normal_frame_war
  	picture = GFX_evt_bloody_man

  	is_triggered_only = yes

  	option = {
  		name = EVTOPTA_TOG_7033

  		add_maimed_trait_effect = yes
  	}
  }

  #War tech
  character_event = {
  	id = EME.7034
  	border = GFX_event_normal_frame_war
  	picture = GFX_evt_large_army

  	hide_from = yes

  	portrait = event_target:ancestors_marshal

  	desc = {
  		trigger = { job_marshal = { always = yes } }
  		text = EVTDESC_TOG_7034_A
  	}
  	desc = {
  		trigger = { NOT = { job_marshal = { always = yes } } }
  		text = EVTDESC_TOG_7034_B
  	}

  	immediate = { job_marshal = { save_event_target_as = ancestors_marshal } }

  	is_triggered_only = yes

  	option = {
  		name = EVTOPTA_TOG_7034

  		military_techpoints = 100

  		if = {
  			limit = { job_marshal = { always = yes } }
  			show_portrait = event_target:ancestors_marshal
  		}
  	}
  }

  #Levy reinforcement
  character_event = {
  	id = EME.7035
  	desc = EVTDESC_TOG_7035
  	border = GFX_event_normal_frame_war
  	picture = GFX_evt_large_army

  	is_triggered_only = yes

  	option = {
  		name = EVTOPTA_TOG_7035

  		capital_scope = {
  			add_province_modifier = {
  				name = inspired_warriors
  				years = 10
  			}
  		}
  	}
  }



  #PROSPERITY

  #Increase prosperity level of capital
  character_event = {
  	id = EME.7040
  	desc = EVTDESC_TOG_7040
  	border = GFX_event_normal_frame_economy
  	picture = GFX_evt_tribal_lands

  	is_triggered_only = yes

  	trigger = {
  		capital_scope = {
  			NOR = {
  				has_province_modifier = depopulated_1
  				has_province_modifier = depopulated_2
  				has_province_modifier = depopulated_3
  			}
  		}
  	}

  	option = {
  		name = EVTOPTA_TOG_7040

  		if = {
  			limit = {
  				has_dlc = "Reapers"
  				NOT = { capital_scope = { has_province_modifier = prosperity_modifier_3 } }
  			}
  			capital_scope = { increase_prosperity_effect = yes }
  		}

  		if = {
  			limit = {
  				OR = {
  					NOT = { has_dlc = "Reapers" }
  					capital_scope = { has_province_modifier = prosperity_modifier_3 }
  				}
  			}
  			scaled_wealth = { value = 1 min = 50 }
  		}
  	}
  }

  #Give economy tech
  character_event = {
  	id = EME.7041
  	border = GFX_event_normal_frame_economy
  	picture = GFX_evt_council

  	desc = {
  		trigger = { job_treasurer = { always = yes } }
  		text = EVTDESC_TOG_7041_A
  	}
  	desc = {
  		trigger = { NOT = { job_treasurer = { always = yes } } }
  		text = EVTDESC_TOG_7041_B
  	}

  	hide_from = yes

  	immediate = { job_treasurer = { save_event_target_as = ancestors_treasurer } }

  	is_triggered_only = yes

  	option = {
  		name = EVTOPTA_TOG_7041
  		economy_techpoints = 100
  	}
  }


  #Small stewardship bonus
  character_event = {
  	id = EME.7042
  	desc = EVTDESC_TOG_7042
  	border = GFX_event_normal_frame_economy
  	picture = GFX_evt_market

  	is_triggered_only = yes

  	option = {
  		name = EVTOPTA_TOG_7042

  		add_character_modifier = {
  			name = bargainer
  			years = 10
  		}
  	}
  }

  #Bad tax modifier
  character_event = {
  	id = EME.7043
  	desc = EVTDESC_TOG_7043
  	border = GFX_event_normal_frame_economy
  	picture = GFX_evt_tribal_shrine

  	is_triggered_only = yes

  	option = {
  		name = EVTOPTA_TOG_7043

  		add_character_modifier = {
  			name = overtaxed_subjects
  			years = 5
  		}
  	}
  }

  #Decrease depopulation
  character_event = {
  	id = EME.7044
  	desc = EVTDESC_TOG_7044
  	border = GFX_event_normal_frame_economy
  	picture = GFX_evt_tribal_lands

  	is_triggered_only = yes

  	trigger = {
  		capital_scope = {
  			OR = {
  				has_province_modifier = depopulated_1
  				has_province_modifier = depopulated_2
  				has_province_modifier = depopulated_3
  			}
  		}
  	}

  	option = {
  		name = EVTOPTA_TOG_7044

  		capital_scope = {

  			if = {
  				limit = { has_province_modifier = depopulated_1 }

  				remove_province_modifier = depopulated_1
  				break = yes
  			}

  			if = {
  				limit = { has_province_modifier = depopulated_2 }

  				remove_province_modifier = depopulated_2
  				add_province_modifier = { name = depopulated_1 duration = -1 }
  				break = yes
  			}

  			if = {
  				limit = { has_province_modifier = depopulated_3 }

  				remove_province_modifier = depopulated_3
  				add_province_modifier = { name = depopulated_2 duration = -1 }
  				break = yes
  			}
  		}
  	}
  }

  #WISDOM

  #Shrewd
  character_event = {
  	id = EME.7050
  	desc = EVTDESC_TOG_7050
  	border = GFX_event_normal_frame_religion
  	picture = GFX_evt_library

  	is_triggered_only = yes

  	option = {
  		name = EVTOPTA_TOG_7050

  		if = {
  			limit = { is_smart_non_congenital_trait_upgradeable_trigger = yes }
  			upgrade_smart_non_congenital_trait_effect = yes
  		}
  		else_if = {
  			limit = { is_dumb_congenital_trigger = yes }
  			upgrade_smart_congenital_trait_effect = yes
  		}
  	}
  }

  #Wise woman joins court
  character_event = {
  	id = EME.7051
  	desc = EVTDESC_TOG_7051
  	border = GFX_event_normal_frame_religion
  	picture = GFX_evt_tribal_shrine

  	is_triggered_only = yes

  	immediate = {
  		create_character = {
  			religion = ROOT
  			age = 32
  			female = yes
  			random_traits = yes
  			dynasty = none
  			trait = mystic
  			trait = genius
  			trait = mastermind_theologian
  		}
  		new_character = {
  			remove_trait = dull
  			remove_trait = imbecile
  			save_event_target_as = ancestors_wise_woman
  		}
  	}

  	option = {
  		name = EVTOPTA_TOG_7051

  		event_target:ancestors_wise_woman = {
  			opinion = {
  				modifier = opinion_loyal_servant
  				who = ROOT
  				months = 120
  			}
  		}
  	}
  }

  #Small learning bonus
  character_event = {
  	id = EME.7052
  	desc = EVTDESC_TOG_7052
  	border = GFX_event_normal_frame_religion
  	picture = GFX_evt_library

  	is_triggered_only = yes

  	option = {
  		name = EVTOPTA_TOG_7052
  		add_character_modifier = {
  			name = new_insights
  			years = 10
  		}
  	}
  }

  #Dull
  character_event = {
  	id = EME.7053
  	desc = EVTDESC_TOG_7053
  	border = GFX_event_normal_frame_religion
  	picture = GFX_evt_library

  	is_triggered_only = yes

  	option = {
  		name = EVTOPTA_TOG_7053

		downgrade_smart_non_congenital_trait_effect = yes
  	}
  }

  #Get an owl
  character_event = {
  	id = EME.7054
  	desc = EVTDESC_TOG_7054
  	border = GFX_event_normal_frame_religion
  	picture = GFX_evt_falconing

  	is_triggered_only = yes

  	option = {
  		name = EVTOPTA_TOG_7054
  		add_character_modifier = {
  			name = pet_owl
  			duration = -1
  		}
  		hidden_tooltip = { character_event = { id = 77800 days = 3500 random = 2000 } } # Owl dies
  	}

  	option = {
  		name = EVTOPTB_TOG_7054

  		ai_chance = {
  			factor = 0
  		}
  	}
  }

###Nature's Favor

  character_event = {
  	id = EME.300
  	desc = EVTDESC_EME_300
  	picture = GFX_evt_forest_b

  	is_triggered_only = yes

  	option = {
  		name = EVTOPTA_EME_300

  		any_realm_province = {
        add_province_modifier = {
          modifier = nature_favor_attrition
          duration = 365
        }
  		}
    }
  }

########################JOINING SHADOW DRUIDS############################

#From on_character_ask_to_join_society
character_event = {
    id = EME.100
    hide_window = yes
    is_triggered_only = yes
    trigger = {
    	FROM = { leader = { society_member_of = shadow_druids } }
    }
    immediate = {
    	if = { #Find a non-prisoner member
    		limit = { FROM = { leader = { prisoner = yes } } }
    		FROM = {
    			any_society_member = {
    				limit = {
    					society_member_of = shadow_druids
    					society_rank == 4
    					prisoner = no
    				}
    				character_event = { id = EME.101 }
    				break = yes
    			}
    			any_society_member = {
    				limit = {
    					society_member_of = shadow_druids
    					society_rank == 3
    					prisoner = no
    				}
    				character_event = { id = EME.101 }
    				break = yes
    			}
    			any_society_member = {
    				limit = {
    					society_member_of = shadow_druids
    					society_rank == 2
    					prisoner = no
    				}
    				character_event = { id = EME.101 }
    				break = yes
    			}
    			any_society_member = {
    				limit = {
    					society_member_of = shadow_druids
    					society_rank == 1
    					prisoner = no
    				}
    				character_event = { id = EME.101 }
    				break = yes
    			}
    		}
			#Everyone is somehow in prison so just use teh leader anyway
    	}
    	FROM = { leader = { character_event = { id = EME.101 } } }
    }
}

#Ping event
character_event = {
    id = EME.101
    hide_window = yes
    is_triggered_only = yes
    immediate = {
    	FROM = { letter_event = { id = EME.102 } }
    }
}

#Welcome letter
letter_event = {
    id = EME.102
    desc = EVTDESC_EME_102
    border = GFX_event_letter_frame_religion

    is_triggered_only = yes

    immediate = { set_character_flag = society_join_block }

    option = {
      name = EVTOPTA_EME_102

      join_society = shadow_druids
      clr_character_flag = society_join_block
    }
}

########################AI JOIN AND AI RANK UP SHADOW DRUIDS###########################

character_event = { #force the AI to join a society
  id = EME.110
  hide_window = yes
  is_triggered_only = yes

	immediate = {
		if = {
			limit = { #if he's already a member, will force a rank up 25% of the time
				ai = yes
				prisoner = no
				NOT = { trait = incapable }
				higher_tier_than = BARON
				society_member_of = shadow_druids
				society_rank <= 3
				society_can_rank_up = yes
			}
			random_list = {
				75 = {}
				25 = {
					society_rank_up = 1
				}
			}
		}
		if = { #force the joining event on AI
      limit = {
        ai = yes
        prisoner = no
        NOT = { trait = incapable }
        is_adult = yes
        is_in_society = no
        controls_religion = no
        block_general_event_trigger = no
      }
			character_event = { id = EME.111 }
		}
	}
}

character_event = { #AI join event
	id = EME.111
	hide_window = yes

	is_triggered_only = yes

  immediate = {
    random_list = {
      60 = { # do nothing
      }
      40 = {
        trigger = { #meet the requirement
          can_join_society = shadow_druids
        }
        modifier = {
          factor = 2
          trait = brave
        }
        modifier = {
          factor = 2
          trait = cruel
        }
        modifier = {
          factor = 2
          trait = wroth
        }
        modifier = {
          factor = 2
          trait = paranoid
        }
        modifier = {
          factor = 0.2
          OR = {
            trait = cynical
            trait = trusting
            trait = craven
          }
        }
        modifier = {
          factor = 0.2
          z_druid = no
          z_barbarian = no
          z_ranger = no
        }
        modifier = {
          factor = 0.1
          is_landed = no
        }
        modifier = {
          factor = 0.5
          z_druid = no
          z_barbarian = no
          z_ranger = no
        }
        join_society = shadow_druids
        random_list = {
          75 = {
            modifier = {
              factor = 0
              society_influence >= 30
            }
          }
          25 = {
          }
        }
        if = { # Make grandmaster is there is none
          limit = {
            NOT = {
              society = {
                any_society_member = {
                  is_society_grandmaster = yes
                }
              }
            }
          }
          set_society_grandmaster = yes
        }
      }
    }
  }
}
