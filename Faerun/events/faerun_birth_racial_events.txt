###These events assign the racial traits on birth and make stillborn children of unions that are not allowed########

namespace = racialbirth

character_event = {
	id = racialbirth.0
	hide_window = yes
	
	is_triggered_only = yes #on birth
	
	trigger = {
		faerun_any_race = no
			#has_character_flag = faerun_generated
	}
	
	option = {
		trigger = { # Both parents available
			true_father_even_if_dead = { always = yes }
			mother_even_if_dead = { always = yes }
		}

		# Default inheritance of graphical culture.
		random_list = {
			1 = {
				trigger = {
					mother_even_if_dead = {
						has_undead_portrait = no
						NAND = {
							ROOT = { is_female = no }
							OR = {
								trait = creature_angel
								trait = creature_fiend
							}
							gfx_culture_scope = {
								OR = {
									culture = moonmaiden
									culture = erinyes
									culture = marilith
								}
							}
						}
					}
				}
				mother_even_if_dead = {
					tb_graph_culture_racial = yes
				}
			}
			1 = {
				trigger = {
					true_father_even_if_dead = { has_undead_portrait = no }
				}
				true_father_even_if_dead = {
					tb_graph_culture_racial = yes
				}
			}
		}

		#Secret dragon handling
		if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_dragon }
						mother_even_if_dead = { has_character_flag = secret_dragon }
					}
					AND = {
						mother_even_if_dead = { trait = creature_dragon }
						true_father_even_if_dead = { has_character_flag = secret_dragon }
					}
				}
			}
			dragon_race_inheritance = yes
		}
		#First we do all the normal racial births where both parents are from the same race
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_human }
				mother_even_if_dead = { trait = creature_human }
			}
			add_trait = creature_human
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_elf }
				mother_even_if_dead = { trait = creature_elf }
			}
			add_trait = creature_elf
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_drow }
				mother_even_if_dead = { trait = creature_drow }
			}
			add_trait = creature_drow
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_feyri }
				mother_even_if_dead = { trait = creature_feyri }
			}
			add_trait = creature_feyri
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_half_elf }
				mother_even_if_dead = { trait = creature_half_elf }
			}
			add_trait = creature_half_elf
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_treant }
				mother_even_if_dead = { trait = creature_treant }
			}
			add_trait = creature_treant
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_satyr }
				mother_even_if_dead = { trait = creature_satyr }
			}
			add_trait = creature_satyr
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_dwarf }
				mother_even_if_dead = { trait = creature_dwarf }
			}
			add_trait = creature_dwarf
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_half_dwarf }
				mother_even_if_dead = { trait = creature_half_dwarf }
			}
			add_trait = creature_half_dwarf
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_gnome }
				mother_even_if_dead = { trait = creature_gnome }
			}
			add_trait = creature_gnome
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_giant }
				mother_even_if_dead = { trait = creature_giant }
			}
			add_trait = creature_giant
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_goliath }
				mother_even_if_dead = { trait = creature_goliath }
			}
			add_trait = creature_goliath
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_goblin }
				mother_even_if_dead = { trait = creature_goblin }
			}
			add_trait = creature_goblin
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_hobgoblin }
				mother_even_if_dead = { trait = creature_hobgoblin }
			}
			add_trait = creature_hobgoblin
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_bugbear }
				mother_even_if_dead = { trait = creature_bugbear }
			}
			add_trait = creature_bugbear
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_halfling }
				mother_even_if_dead = { trait = creature_halfling }
			}
			add_trait = creature_halfling
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_orc }
				mother_even_if_dead = { trait = creature_orc }
			}
			add_trait = creature_orc
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_half_orc }
				mother_even_if_dead = { trait = creature_half_orc }
			}
			add_trait = creature_half_orc
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_ogre }
				mother_even_if_dead = { trait = creature_ogre }
			}
			add_trait = creature_ogre
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_half_ogre }
				mother_even_if_dead = { trait = creature_half_ogre }
			}
			add_trait = creature_half_ogre
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_ogrillon }
				mother_even_if_dead = { trait = creature_ogrillon }
			}
			add_trait = creature_ogrillon
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_troll }
				mother_even_if_dead = { trait = creature_troll }
			}
			add_trait = creature_troll
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_tabaxi }
				mother_even_if_dead = { trait = creature_tabaxi }
			}
			add_trait = creature_tabaxi
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_gith }
				mother_even_if_dead = { trait = creature_gith }
			}
			add_trait = creature_gith
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_yikarian }
				mother_even_if_dead = { trait = creature_yikarian }
			}
			add_trait = creature_yikarian
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_gnoll }
				mother_even_if_dead = { trait = creature_gnoll }
			}
			add_trait = creature_gnoll
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_half_giant }
				mother_even_if_dead = { trait = creature_half_giant }
			}
			add_trait = creature_half_giant
		}
		#yuan-ti
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_pureblood }
				mother_even_if_dead = { trait = creature_pureblood }
			}
			random_list = {
				90 = {
					add_trait = creature_pureblood
					#set_graphical_culture = yuanti
				}
				10 = {
					add_trait = creature_malison
					set_graphical_culture = halfblood
				}
			}
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_malison }
				mother_even_if_dead = { trait = creature_malison }
			}
			random_list = {
				25 = {
					add_trait = creature_pureblood
					set_graphical_culture = yuanti
				}
				25 = {
					add_trait = creature_malison
					set_graphical_culture = halfblood
				}
				25 = {
					add_trait = creature_malison
					set_graphical_culture = malison
				}
				25 = {
					add_trait = creature_abomination
					set_graphical_culture = abomination
				}
			}
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_abomination }
				mother_even_if_dead = { trait = creature_abomination }
			}
			random_list = {
				50 = {
					add_trait = creature_abomination
					set_graphical_culture = abomination
				}
				25 = {
					add_trait = creature_malison
					set_graphical_culture = malison
				}
				25 = {
					add_trait = creature_pureblood
					set_graphical_culture = yuanti
				}
			}
		}
		#naga
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_naga }
				mother_even_if_dead = { trait = creature_naga }
			}
			add_trait = creature_naga
		}
		#sarrukh
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_sarrukh }
				mother_even_if_dead = { trait = creature_sarrukh }
			}
			add_trait = creature_sarrukh
		}
		#lizardfolk
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_lizardfolk }
				mother_even_if_dead = { trait = creature_lizardfolk }
			}
			add_trait = creature_lizardfolk
		}
		#dragonborn
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_dragonborn }
				mother_even_if_dead = { trait = creature_dragonborn }
			}
			add_trait = creature_dragonborn
		}
		#birbs
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_tengu }
				mother_even_if_dead = { trait = creature_tengu }
			}
			add_trait = creature_tengu
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_aarakocra }
				mother_even_if_dead = { trait = creature_aarakocra }
			}
			add_trait = creature_aarakocra
		}
		#sahuagin
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_sahuagin }
				mother_even_if_dead = { trait = creature_sahuagin }
			}
			random_list = {
				95 = {
					add_trait = creature_sahuagin
				}
				5 = {
					add_trait = creature_malenti
					set_graphical_culture = malenti
				}
			}
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_malenti }
				mother_even_if_dead = { trait = creature_malenti }
			}
			add_trait = creature_malenti
		}
		# tieflings
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_tiefling }
				mother_even_if_dead = {trait = creature_tiefling }
			}
			add_trait = creature_tiefling
		}
		# genasi
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_genasi }
				mother_even_if_dead = {trait = creature_genasi }
			}
			add_trait = creature_genasi
		}
		# aasimar
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_aasimar }
				mother_even_if_dead = {trait = creature_aasimar }
			}
			add_trait = creature_aasimar
			if = {
				limit = { race_part_animal = yes }
				spawn_random_ardling = yes
			}
		}
		# tanarukk
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_tanarukk }
				mother_even_if_dead = {trait = creature_tanarukk }
			}
			add_trait = creature_tanarukk
		}
		#outsiders
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_fiend }
				mother_even_if_dead = {trait = creature_fiend }
			}
			add_trait = creature_fiend
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_angel }
				mother_even_if_dead = { trait = creature_angel }
			}
			add_trait = creature_angel
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_genie }
				mother_even_if_dead = {trait = creature_genie }
			}
			add_trait = creature_genie
		}
		#centaurs
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_centaur }
				mother_even_if_dead = { trait = creature_centaur }
			}
			add_trait = creature_centaur
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_wemic }
				mother_even_if_dead = { trait = creature_wemic }
			}
			add_trait = creature_wemic
		}
		#minotaurs#
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_minotaur }
				mother_even_if_dead = { trait = creature_minotaur }
			}
			add_trait = creature_minotaur
		}
		#saurials#
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_saurial }
				mother_even_if_dead = { trait = creature_saurial }
			}
			add_trait = creature_saurial
			set_graphical_culture = saurial
		}
		#pterafolk#
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_pterafolk }
				mother_even_if_dead = { trait = creature_pterafolk }
			}
			add_trait = creature_pterafolk
		}
		#dragons#
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_dragon }
				mother_even_if_dead = { trait = creature_dragon }
			}
			add_trait = creature_dragon
		}
		#spirit folk#
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_spirit_folk }
				mother_even_if_dead = { trait = creature_spirit_folk }
			}
			add_trait = creature_spirit_folk
		}
		# kobolds
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_kobold }
				mother_even_if_dead = { trait = creature_kobold }
			}
			add_trait = creature_kobold
		}
		#Lamia
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_lamia }
				mother_even_if_dead = { trait = creature_lamia }
			}
			add_trait = creature_lamia
		}
		#Kuo-Toa
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_kuotoa }
				mother_even_if_dead = { trait = creature_kuotoa }
			}
			add_trait = creature_kuotoa
		}
		#Hengeyokai
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_hengeyokai }
				mother_even_if_dead = { trait = creature_hengeyokai }
			}
			add_trait = creature_hengeyokai
		}
		#Draegloth
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_draegloth }
				mother_even_if_dead = { trait = creature_draegloth }
			}
			add_trait = creature_draegloth
		}
		#Deep Imaskari
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = creature_deep_imaskari }
				mother_even_if_dead = { trait = creature_deep_imaskari }
			}
			add_trait = creature_deep_imaskari
		}
		###Now for the allowed bi-racial unions###
		#drow + elf = drow#
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_elf }
						mother_even_if_dead = { trait = creature_drow }
					}
					AND = {
						true_father_even_if_dead = { trait = creature_drow }
						mother_even_if_dead = { trait = creature_elf }
					}
				}
			}
			add_trait = creature_drow
			if = {
				limit = {
					mother_even_if_dead = { trait = creature_drow }
				}
				mother_even_if_dead = { tb_graph_culture_racial = yes }
			}
			else = {
				true_father_even_if_dead = { tb_graph_culture_racial = yes }
			}
		}
		#feyri + elf = feyri#
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_feyri }
						mother_even_if_dead = { trait = creature_elf }
					}
					AND = {
						true_father_even_if_dead = { trait = creature_elf }
						mother_even_if_dead = { trait = creature_feyri }
					}
				}
			}
			add_trait = creature_feyri
			if = {
				limit = {
					mother_even_if_dead = { trait = creature_feyri }
				}
				mother_even_if_dead = { tb_graph_culture_racial = yes }
			}
			else = {
				true_father_even_if_dead = { tb_graph_culture_racial = yes }
			}
		}
		#feyri + drow = draegloth
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_feyri }
						mother_even_if_dead = { trait = creature_drow }
					}
					AND = {
						true_father_even_if_dead = { trait = creature_drow }
						mother_even_if_dead = { trait = creature_feyri }
					}
				}
			}
			add_trait = creature_draegloth
			set_graphical_culture = draegloth
		}
		#draegloth + elf or feyri = 50/50 of draegloth or feyri
		else_if = {
			limit = {
				OR = {
					AND = {
						mother_even_if_dead = { trait = creature_draegloth }
						true_father_even_if_dead = {
							OR = {
								trait = creature_elf
								trait = creature_feyri
							}
						}
					}
					AND = {
						true_father_even_if_dead = { trait = creature_draegloth }
						mother_even_if_dead = {
							OR = {
								trait = creature_elf
								trait = creature_feyri
							}
						}
					}
				}
			}
			random_list = {
				1 = {
					add_trait = creature_feyri
					set_graphical_culture = feyri
				}
				1 = {
					add_trait = creature_draegloth
					set_graphical_culture = draegloth
				}
			}
		}
		#elf + half-elf = 4/1 half-elf or elf
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_elf }
						mother_even_if_dead = { trait = creature_half_elf }
					}
					AND = {
						mother_even_if_dead = { trait = creature_elf }
						true_father_even_if_dead = { trait = creature_half_elf }
					}
				}
			}
			random_list = {
				1  = {
					add_trait = creature_elf
					if = {
						limit = {
							mother_even_if_dead = { trait = creature_elf }
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
				2 = {
					halfelf_race_inheritance = yes
				}
				2  = {
					add_trait = creature_half_elf
					if = {
						limit = {
							mother_even_if_dead = { trait = creature_half_elf }
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
			}
		}
		#drow + half-elf = 4/1 half-drow or drow
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_drow }
						mother_even_if_dead = { trait = creature_half_elf }
					}
					AND = {
						mother_even_if_dead = { trait = creature_drow }
						true_father_even_if_dead = { trait = creature_half_elf }
					}
				}
			}
			random_list = {
				1  = {
					add_trait = creature_drow
					if = {
						limit = {
							mother_even_if_dead = { trait = creature_drow }
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
				4 = {
					halfelf_race_inheritance = yes
				}
			}
		}
		#feyri + half-elf = 20/5/1 tiefling or feyri or elf
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_feyri }
						mother_even_if_dead = { trait = creature_half_elf }
					}
					AND = {
						mother_even_if_dead = { trait = creature_feyri }
						true_father_even_if_dead = { trait = creature_half_elf }
					}
				}
			}
			random_list = {
				1  = {
					add_trait = creature_elf
					set_graphical_culture = sun_elf
				}
				5 = {
					add_trait = creature_feyri
					if = {
						limit = {
							mother_even_if_dead = { trait = creature_feyri }
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
				20 = {
					add_trait = creature_tiefling
					set_graphical_culture = tiefling
				}
			}
		}
		#draegloth + half-elf = 20/5/1 tiefling or draegloth or drow
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_draegloth }
						mother_even_if_dead = { trait = creature_half_elf }
					}
					AND = {
						mother_even_if_dead = { trait = creature_draegloth }
						true_father_even_if_dead = { trait = creature_half_elf }
					}
				}
			}
			random_list = {
				1  = {
					add_trait = creature_drow
					set_graphical_culture = drow
				}
				5 = {
					add_trait = creature_draegloth
					set_graphical_culture = draegloth
				}
				20 = {
					add_trait = creature_tiefling
					set_graphical_culture = tiefling
				}
			}
		}
		#elf + human or half-human (not half-elf!) = half-elf
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_elf }
						mother_even_if_dead = {
							race_is_part_human = yes
						}
					}
					AND = {
						mother_even_if_dead = { trait = creature_elf }
						true_father_even_if_dead = {
							race_is_part_human = yes
						}
					}
				}
			}
			halfelf_race_inheritance = yes
		}
		#drow + human or half-human (not half-elf!) = half-drow
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_drow }
						mother_even_if_dead = {
							race_is_part_human = yes
						}
					}
					AND = {
						mother_even_if_dead = { trait = creature_drow }
						true_father_even_if_dead = {
							race_is_part_human = yes
						}
					}
				}
			}
			halfelf_race_inheritance = yes
		}
		#feyri + human or half-human (not half-elf!) = 50/50 half-elf or tiefling
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_feyri }
						mother_even_if_dead = {
							race_is_part_human = yes
						}
					}
					AND = {
						mother_even_if_dead = { trait = creature_feyri }
						true_father_even_if_dead = {
							race_is_part_human = yes
						}
					}
				}
			}
			random_list = {
				1 = {
					halfelf_race_inheritance = yes
				}
				1 = {
					add_trait = creature_tiefling
					set_graphical_culture = tiefling
				}
			}
		}
		#draegloth + human or half-human (not half-elf!) = 50/50 half-drow or tiefling
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_draegloth }
						mother_even_if_dead = {
							race_is_part_human = yes
						}
					}
					AND = {
						mother_even_if_dead = { trait = creature_draegloth }
						true_father_even_if_dead = {
							race_is_part_human = yes
						}
					}
				}
			}
			random_list = {
				1 = {
					halfelf_race_inheritance = yes
				}
				1 = {
					add_trait = creature_tiefling
					set_graphical_culture = tiefling
				}
			}
		}
		#elves/drow + orcs/ogrillons = half-orc
		else_if = {
			limit = {
				OR = {
					AND = {
						mother_even_if_dead = {
							OR = {
								trait = creature_elf
								trait = creature_drow
							}
						}
						true_father_even_if_dead = {
							OR = {
								trait = creature_orc
								trait = creature_ogrillon
							}
						}
					}
					AND = {
						true_father_even_if_dead = {
							OR = {
								trait = creature_elf
								trait = creature_drow
							}
						}
						mother_even_if_dead = {
							OR = {
								trait = creature_orc
								trait = creature_ogrillon
							}
						}
					}
				}
			}
			add_trait = creature_half_orc
			set_graphical_culture = half_orc
		}
		#elf/drow/feyri/draegloth + tanarukk = tiefling
		else_if = {
			limit = {
				OR = {
					AND = {
						mother_even_if_dead = {
							race_is_elven = yes
						}
						true_father_even_if_dead = { trait = creature_tanarukk }
					}
					AND = {
						true_father_even_if_dead = {
							race_is_elven = yes
						}
						mother_even_if_dead = { trait = creature_tanarukk }
					}
				}
			}
			add_trait = creature_tiefling
			set_graphical_culture = tiefling
		}
		#feyri/draegloth + orc/ogrillon = tiefling
		else_if = {
			limit = {
				OR = {
					AND = {
						mother_even_if_dead = {
							OR = {
								trait = creature_feyri
								trait = creature_draegloth
							}
						}
						true_father_even_if_dead = {
							OR = {
								trait = creature_orc
								trait = creature_ogrillon
							}
						}
					}
					AND = {
						true_father_even_if_dead = {
							OR = {
								trait = creature_feyri
								trait = creature_draegloth
							}
						}
						mother_even_if_dead = {
							OR = {
								trait = creature_orc
								trait = creature_ogrillon
							}
						}
					}
				}
			}
			add_trait = creature_tiefling
			set_graphical_culture = tiefling
		}
		#small folk
		#Dwarf + half-dwarf = 4/1 half-dwarf or dwarf
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_dwarf }
						mother_even_if_dead = { trait = creature_half_dwarf }
					}
					AND = {
						mother_even_if_dead = { trait = creature_dwarf }
						true_father_even_if_dead = { trait = creature_half_dwarf }
					}
				}
			}
			random_list = {
				1  = {
					add_trait = creature_dwarf
					if = {
						limit = {
							mother_even_if_dead = { trait = creature_dwarf }
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
				4 = {
					add_trait = creature_half_dwarf
				}
			}
		}
		#Dwarf + Humans/Half-Humans/Elves = half-dwarf
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_dwarf }
						mother_even_if_dead = {
							OR = {
								race_is_part_human = yes
								race_is_elven = yes
							}
						}
					}
					AND = {
						true_father_even_if_dead = { 
							OR = {
								race_is_part_human = yes
								race_is_elven = yes
							}
						}
						mother_even_if_dead = { trait = creature_dwarf }
					}
				}
			}
			add_trait = creature_half_dwarf
			if = {
				limit = {
					mother_even_if_dead = { trait = creature_dwarf }
				}
				mother_even_if_dead = { tb_graph_culture_racial = yes }
			}
			else = {
				true_father_even_if_dead = { tb_graph_culture_racial = yes }
			}
		}
		#orc + half-orc = 4/1 half-orc or orc
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_orc }
						mother_even_if_dead = { trait = creature_half_orc }
					}
					AND = {
						mother_even_if_dead = { trait = creature_orc }
						true_father_even_if_dead = { trait = creature_half_orc }
					}
				}
			}
			random_list = {
				3 = {
					add_trait = creature_half_orc
					set_graphical_culture = half_orc
				}
				1 = {
					add_trait = creature_orc
					if = {
						limit = {
							mother_even_if_dead = { trait = creature_orc }
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
			}
		}
		#orc + half-ogre = 50/50 half-orc or ogrillon
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_orc }
						mother_even_if_dead = { trait = creature_half_ogre }
					}
					AND = {
						mother_even_if_dead = { trait = creature_orc }
						true_father_even_if_dead = { trait = creature_half_ogre }
					}
				}
			}
			random_list = {
				1 = {
					add_trait = creature_half_orc
					set_graphical_culture = half_orc
				}
				1 = {
					add_trait = creature_ogrillon
					set_graphical_culture = ogrillon
				}
			}
		}
		#orc + humans & half-humans (except half-orcs and half-ogres) = half-orc
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_orc }
						mother_even_if_dead = {
							race_is_part_human = yes
						}
					}
					AND = {
						mother_even_if_dead = { trait = creature_orc }
						true_father_even_if_dead = {
							race_is_part_human = yes
						}
					}
				}
			}
			add_trait = creature_half_orc
			set_graphical_culture = half_orc
		}
		#ogrillon + half-orc = 4/1 half-orc or orc
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_ogrillon }
						mother_even_if_dead = { trait = creature_half_orc }
					}
					AND = {
						mother_even_if_dead = { trait = creature_ogrillon }
						true_father_even_if_dead = { trait = creature_half_orc }
					}
				}
			}
			random_list = {
				3 = {
					add_trait = creature_half_orc
					set_graphical_culture = half_orc
				}
				1 = {
					add_trait = creature_orc
					set_graphical_culture = orc
				}
			}
		}
		#ogrillon + half-ogre = 4/4/1 half-ogre or half-orc or ogre
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_ogrillon }
						mother_even_if_dead = { trait = creature_half_ogre }
					}
					AND = {
						mother_even_if_dead = { trait = creature_ogrillon }
						true_father_even_if_dead = { trait = creature_half_ogre }
					}
				}
			}
			random_list = {
				3 = {
					add_trait = creature_half_orc
					set_graphical_culture = half_orc
				}
				4 = {
					add_trait = creature_half_ogre
					set_graphical_culture = half_ogre
				}
				1 = {
					add_trait = creature_ogre
					set_graphical_culture = ogre
				}
			}
		}
		#ogrillon + humans & half-humans (except half-orcs and half-ogres) = 50/50 half-orc or half-ogre
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_ogrillon }
						mother_even_if_dead = {
							race_is_part_human = yes
						}
					}
					AND = {
						mother_even_if_dead = { trait = creature_ogrillon }
						true_father_even_if_dead = {
							race_is_part_human = yes
						}
					}
				}
			}
			random_list = {
				1 = {
					add_trait = creature_half_orc
					set_graphical_culture = half_orc
				}
				1 = {
					add_trait = creature_half_ogre
					set_graphical_culture = half_ogre
				}
			}
		}
		#tanarukk + half-orc = 4/1 tiefling or orc
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_tanarukk }
						mother_even_if_dead = { trait = creature_half_orc }
					}
					AND = {
						mother_even_if_dead = { trait = creature_tanarukk }
						true_father_even_if_dead = { trait = creature_half_orc }
					}
				}
			}
			random_list = {
				3 = {
					add_trait = creature_tiefling
					set_graphical_culture = tiefling
				}
				1 = {
					add_trait = creature_orc
					set_graphical_culture = orc
				}
			}
		}
		#tanarukk + humans & half-humans (except half-orcs) = tiefling
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_tanarukk }
						mother_even_if_dead = {
							race_is_part_human = yes
						}
					}
					AND = {
						mother_even_if_dead = { trait = creature_tanarukk }
						true_father_even_if_dead = {
							race_is_part_human = yes
						}
					}
				}
			}
			add_trait = creature_tiefling
			set_graphical_culture = tiefling
		}
		#orcs + goblin = 3/3/1 orc or goblin or hobgoblin
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_goblin }
						mother_even_if_dead = {
							OR = {
								trait = creature_orc
								trait = creature_tanarukk
								trait = creature_ogrillon
							}
						}
					}
					AND = {
						mother_even_if_dead = { trait = creature_goblin }
						true_father_even_if_dead = {
							OR = {
								trait = creature_orc
								trait = creature_tanarukk
								trait = creature_ogrillon
							}
						}
					}
				}
			}
			random_list = {
				3 = {
					add_trait = creature_orc
					if = {
						limit = {
							mother_even_if_dead = { trait = creature_orc }
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
				3 = {
					add_trait = creature_goblin
					if = {
						limit = {
							mother_even_if_dead = { trait = creature_goblin }
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
				1 = {
					add_trait = creature_hobgoblin
					set_graphical_culture = hobgoblin
				}
			}
		}
		#ogre + half-ogre = 4/1 half-ogre or ogre
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_ogre }
						mother_even_if_dead = { trait = creature_half_ogre }
					}
					AND = {
						true_father_even_if_dead = { trait = creature_half_ogre }
						mother_even_if_dead = { trait = creature_ogre }
					}
				}
			}
			random_list = {
				4 = {
					add_trait = creature_half_ogre
					set_graphical_culture = half_ogre
				}
				1 = {
					add_trait = creature_ogre
					if = {
						limit = {
							mother_even_if_dead = { trait = creature_ogre }
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
			}
		}
		#ogre + half-orc = 50/50 half-ogre or ogrillon
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_ogre }
						mother_even_if_dead = { trait = creature_half_orc }
					}
					AND = {
						true_father_even_if_dead = { trait = creature_ogre }
						mother_even_if_dead = { trait = creature_half_orc }
					}
				}
			}
			random_list = {
				1 = { 
					add_trait = creature_half_ogre
					set_graphical_culture = half_ogre
				}
				1 = {
					add_trait = creature_ogrillon
					set_graphical_culture = ogrillon
				}
			}
		}
		#ogre + humans and half-humans (except half-ogre and half-orc) = half-ogre
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_ogre }
						mother_even_if_dead = {
							race_is_part_human = yes
						}
					}
					AND = {
						true_father_even_if_dead = {
							race_is_part_human = yes
						}
						mother_even_if_dead = { trait = creature_ogre }
					}
				}
			}
			add_trait = creature_half_ogre
			set_graphical_culture = half_ogre
		}

		#ogre + orc or tanarukk = ogrillon
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = {
							OR = {
								trait = creature_ogre
								race_is_giantkin = yes
							}
						}
						mother_even_if_dead = {
							OR = {
								trait = creature_orc
								trait = creature_tanarukk
							}
						}
					}
					AND = {
						mother_even_if_dead = {
							OR = {
								trait = creature_ogre
								race_is_giantkin = yes
							}
						}
						true_father_even_if_dead = {
							OR = {
								trait = creature_orc
								trait = creature_tanarukk
							}
						}
					}
				}
			}
			add_trait = creature_ogrillon
			set_graphical_culture = ogrillon
		}
		#ogre + ogrillon = 4/1 ogrillon or ogre
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_ogre }
						mother_even_if_dead = { trait = creature_ogrillon }
					}
					AND = {
						true_father_even_if_dead = { trait = creature_ogrillon }
						mother_even_if_dead = { trait = creature_ogre }
					}
				}
			}
			random_list = {
				1 = { 
					add_trait = creature_ogre
					if = {
						limit = {
							mother_even_if_dead = { trait = creature_ogre }
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
				4 = {
					add_trait = creature_ogrillon
					set_graphical_culture = ogrillon
				}
			}
		}
		#ogre/half-ogre + goblin = 50/50 hobgoblin or bugbear
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = {
							race_is_ogrekin = yes
						}
						mother_even_if_dead = { trait = creature_goblin }
					}
					AND = {
						mother_even_if_dead = {
							race_is_ogrekin = yes
						}
						true_father_even_if_dead = { trait = creature_goblin }
					}
				}
			}
			random_list = {
				1 = {
					add_trait = creature_hobgoblin
					set_graphical_culture = hobgoblin
				}
				1 = {
					add_trait = creature_bugbear
					set_graphical_culture = bugbear
				}
			}
		}
		#ogre/half-ogre + hobgoblin = hobgoblin
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = {
							race_is_ogrekin = yes
						}
						mother_even_if_dead = { trait = creature_hobgoblin }
					}
					AND = {
						mother_even_if_dead = {
							race_is_ogrekin = yes
						}
						true_father_even_if_dead = { trait = creature_hobgoblin }
					}
				}
			}
			add_trait = creature_hobgoblin
			set_graphical_culture = hobgoblin
		}
		#ogre/half-ogre + bugbear = bugbear
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = {
							race_is_ogrekin = yes
						}
						mother_even_if_dead = { trait = creature_bugbear }
					}
					AND = {
						mother_even_if_dead = {
							race_is_ogrekin = yes
						}
						true_father_even_if_dead = { trait = creature_bugbear }
					}
				}
			}
			add_trait = creature_bugbear
			set_graphical_culture = bugbear
		}
		#ogre + giant = 5/1 ogre or giant
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_ogre }
						mother_even_if_dead = { trait = creature_giant }
					}
					AND = {
						mother_even_if_dead = { trait = creature_ogre }
						true_father_even_if_dead = { trait = creature_giant }
					}
				}
			}
			random_list = {
				1 = {
					add_trait = creature_giant
					if = {
						limit = {
							mother_even_if_dead = { trait = creature_giant }
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
				5 = {
					add_trait = creature_ogre
					if = {
						limit = {
							mother_even_if_dead = { trait = creature_ogre }
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
			}
		}
		#half-ogre/ogrillon + giant = ogre
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = {
							OR = {
								trait = creature_half_ogre
								trait = creature_ogrillon
							}
						}
						mother_even_if_dead = { trait = creature_giant }
					}
					AND = {
						mother_even_if_dead = {
							OR = {
								trait = creature_half_ogre
								trait = creature_ogrillon
							}
						}
						true_father_even_if_dead = { trait = creature_giant }
					}
				}
			}
			add_trait = creature_ogre
			set_graphical_culture = ogre
		}
		#ogres + minotaur/yikarian = 50/50 ogre or minotaur
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = {
							race_is_ogrekin = yes
						}
						mother_even_if_dead = {
							OR = {
								trait = creature_minotaur
								trait = creature_yikarian
							}
						}
					}
					AND = {
						mother_even_if_dead = {
							race_is_ogrekin = yes
						}
						true_father_even_if_dead = {
							OR = {
								trait = creature_minotaur
								trait = creature_yikarian
							}
						}
					}
				}
			}
			random_list = {
				1 = {
					add_trait = creature_ogre
					if = {
						limit = {
							mother_even_if_dead = {
								race_is_ogrekin = yes
							}
						}
						mother_even_if_dead = {
							tb_graph_culture_racial = yes
						}
					}
					else = {
						true_father_even_if_dead = {
							tb_graph_culture_racial = yes
						}
					}
				}
				1 = {
					trigger = {
						OR = {
							mother_even_if_dead = { trait = creature_minotaur }
							true_father_even_if_dead = { trait = creature_minotaur }
						}
					}
					add_trait = creature_minotaur
					set_graphical_culture = minotaur
				}
				1 = {
					trigger = {
						OR = {
							mother_even_if_dead = { trait = creature_yikarian }
							true_father_even_if_dead = { trait = creature_yikarian }
						}
					}
					add_trait = creature_yikarian
					set_graphical_culture = yikarian
				}
			}
		}
		#minotaurs + humans
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_minotaur }
						mother_even_if_dead = {
							OR = {
								race_is_part_human = yes
								race_is_orcish = yes
							}
						}
					}
					AND = {
						mother_even_if_dead = { trait = creature_minotaur }
						true_father_even_if_dead = {
							OR = {
								race_is_part_human = yes
								race_is_orcish = yes
							}
						}
					}
				}
			}
			random_list = {
				3 = {
					trigger = {
						OR = {
							mother_even_if_dead = { race_is_part_human = yes }
							true_father_even_if_dead = { race_is_part_human = yes }
						}
					}
					add_trait = creature_half_ogre
					set_graphical_culture = half_ogre
				}
				3 = {
					trigger = {
						OR = {
							mother_even_if_dead = { race_is_orcish = yes }
							true_father_even_if_dead = { race_is_orcish = yes }
						}
					}
					add_trait = creature_ogrillon
					set_graphical_culture = ogrillon
				}
				1 = {
					add_trait = creature_minotaur
					set_graphical_culture = minotaur
				}
			}
		}
		#goliath + ogre/half-ogre/ogrillon = 50/50 goliath or ogre
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_goliath }
						mother_even_if_dead = {
							race_is_ogrekin = yes
						}
					}
					AND = {
						mother_even_if_dead = { trait = creature_goliath }
						true_father_even_if_dead = {
							race_is_ogrekin = yes
						}
					}
				}
			}
			random_list = {
				1 = {
					add_trait = creature_ogre
					if = {
						limit = {
							mother_even_if_dead = {
								race_is_ogrekin = yes
							}
						}
						mother_even_if_dead = {
							tb_graph_culture_racial = yes
						}
					}
					else = {
						true_father_even_if_dead = {
							tb_graph_culture_racial = yes
						}
					}
				}
				1 = {
					add_trait = creature_goliath
					goliath_race_inheritance = yes
				}
			}
		}
		#goliaths + humans = half-giant
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_goliath }
						mother_even_if_dead = {
							race_is_part_human = yes
							NOT = { trait = creature_half_giant }
						}
					}
					AND = {
						mother_even_if_dead = { trait = creature_goliath }
						true_father_even_if_dead = {
							race_is_part_human = yes
							NOT = { trait = creature_half_giant }
						}
					}
				}
			}
			add_trait = creature_half_giant
			goliath_race_inheritance = yes
		}
		#goliath + giant = 5/1 goliath or giant
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_goliath }
						mother_even_if_dead = { trait = creature_giant }
					}
					AND = {
						mother_even_if_dead = { trait = creature_goliath }
						true_father_even_if_dead = { trait = creature_giant }
					}
				}
			}
			random_list = {
				1 = {
					add_trait = creature_giant
					if = {
						limit = {
							mother_even_if_dead = { trait = creature_giant }
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
				5 = {
					add_trait = creature_goliath
					goliath_race_inheritance = yes
				}
			}
		}
		#goblinoids + small folk
		##dwarf block
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_goblin }
						mother_even_if_dead = { trait = creature_dwarf }
					}
					AND = {
						mother_even_if_dead = { trait = creature_goblin }
						true_father_even_if_dead = { trait = creature_dwarf }
					}
				}
			}
			random_list = {
				5 = {
					add_trait = creature_goblin
					if = {
						limit = {
							mother_even_if_dead = { trait = creature_goblin }
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
				1 = {
					add_trait = creature_dwarf
					if = {
						limit = {
							mother_even_if_dead = { trait = creature_dwarf }
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_hobgoblin }
						mother_even_if_dead = { trait = creature_dwarf }
					}
					AND = {
						mother_even_if_dead = { trait = creature_hobgoblin }
						true_father_even_if_dead = { trait = creature_dwarf }
					}
				}
			}
			random_list = {
				5 = {
					add_trait = creature_hobgoblin
					set_graphical_culture = hobgoblin
				}
				1 = {
					add_trait = creature_dwarf
					if = {
						limit = {
							mother_even_if_dead = { trait = creature_dwarf }
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_bugbear }
						mother_even_if_dead = { trait = creature_dwarf }
					}
					AND = {
						mother_even_if_dead = { trait = creature_bugbear }
						true_father_even_if_dead = { trait = creature_dwarf }
					}
				}
			}
			random_list = {
				5 = {
					add_trait = creature_bugbear
					set_graphical_culture = bugbear
				}
				1 = {
					add_trait = creature_dwarf
					if = {
						limit = {
							mother_even_if_dead = { trait = creature_dwarf }
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
			}
		}
		##gnome block
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_goblin }
						mother_even_if_dead = { trait = creature_gnome }
					}
					AND = {
						mother_even_if_dead = { trait = creature_goblin }
						true_father_even_if_dead = { trait = creature_gnome }
					}
				}
			}
			random_list = {
				5 = {
					add_trait = creature_goblin
					if = {
						limit = {
							mother_even_if_dead = { trait = creature_goblin }
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
				1 = {
					add_trait = creature_gnome
					if = {
						limit = {
							mother_even_if_dead = { trait = creature_gnome }
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_hobgoblin }
						mother_even_if_dead = { trait = creature_gnome }
					}
					AND = {
						mother_even_if_dead = { trait = creature_hobgoblin }
						true_father_even_if_dead = { trait = creature_gnome }
					}
				}
			}
			random_list = {
				5 = {
					add_trait = creature_hobgoblin
					set_graphical_culture = hobgoblin
				}
				1 = {
					add_trait = creature_gnome
					if = {
						limit = {
							mother_even_if_dead = { trait = creature_gnome }
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_bugbear }
						mother_even_if_dead = { trait = creature_gnome }
					}
					AND = {
						mother_even_if_dead = { trait = creature_bugbear }
						true_father_even_if_dead = { trait = creature_gnome }
					}
				}
			}
			random_list = {
				5 = {
					add_trait = creature_bugbear
					set_graphical_culture = bugbear
				}
				1 = {
					add_trait = creature_gnome
					if = {
						limit = {
							mother_even_if_dead = { trait = creature_gnome }
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
			}
		}
		##Halfling block
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_goblin }
						mother_even_if_dead = { trait = creature_halfling }
					}
					AND = {
						mother_even_if_dead = { trait = creature_goblin }
						true_father_even_if_dead = { trait = creature_halfling }
					}
				}
			}
			random_list = {
				5 = {
					add_trait = creature_goblin
					if = {
						limit = {
							mother_even_if_dead = { trait = creature_goblin }
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
				1 = {
					add_trait = creature_halfling
					set_graphical_culture = lightfoot
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_hobgoblin }
						mother_even_if_dead = { trait = creature_halfling }
					}
					AND = {
						mother_even_if_dead = { trait = creature_hobgoblin }
						true_father_even_if_dead = { trait = creature_halfling }
					}
				}
			}
			random_list = {
				5 = {
					add_trait = creature_hobgoblin
					set_graphical_culture = hobgoblin
				}
				1 = {
					add_trait = creature_halfling
					set_graphical_culture = lightfoot
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_bugbear }
						mother_even_if_dead = { trait = creature_halfling }
					}
					AND = {
						mother_even_if_dead = { trait = creature_bugbear }
						true_father_even_if_dead = { trait = creature_halfling }
					}
				}
			}
			random_list = {
				5 = {
					add_trait = creature_bugbear
					set_graphical_culture = bugbear
				}
				1 = {
					add_trait = creature_halfling
					set_graphical_culture = lightfoot
				}
			}
		}
		#goblinoids + humans
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = {
							race_is_goblinoid = yes
						}
						mother_even_if_dead = {
							race_is_part_human = yes
						}
					}
					AND = {
						mother_even_if_dead = {
							race_is_goblinoid = yes
						}
						true_father_even_if_dead = {
							race_is_part_human = yes
						}
					}
				}
			}
			random_list = {
				5 = {
					modifier = {
						factor = 0
						NOR = {
							true_father_even_if_dead = { trait = creature_goblin }
							mother_even_if_dead = { trait = creature_goblin }
						}
					}
					add_trait = creature_goblin
					if = {
						limit = {
							mother_even_if_dead = { trait = creature_goblin }
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
				5 = {
					modifier = {
						factor = 0
						NOR = {
							true_father_even_if_dead = { trait = creature_hobgoblin }
							mother_even_if_dead = { trait = creature_hobgoblin }
						}
					}
					add_trait = creature_hobgoblin
					set_graphical_culture = hobgoblin
				}
				5 = {
					modifier = {
						factor = 0
						NOR = {
							true_father_even_if_dead = { trait = creature_bugbear }
							mother_even_if_dead = { trait = creature_bugbear }
						}
					}
					add_trait = creature_bugbear
					set_graphical_culture = bugbear
				}
				1 = {
					modifier = {
						factor = 0
						OR = {
							true_father_even_if_dead = { trait = creature_gith }
							mother_even_if_dead = { trait = creature_gith }
							true_father_even_if_dead = { trait = creature_deep_imaskari }
							mother_even_if_dead = { trait = creature_deep_imaskari }
						}
					}
					add_trait = creature_human
					human_racial = yes
				}
				2 = {
					default_race_inheritance = yes
				}
			}
		}
		#gnolls + humans
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_gnoll }
						mother_even_if_dead = {
							race_is_part_human = yes
						}
					}
					AND = {
						true_father_even_if_dead = {
							race_is_part_human = yes
						}
						mother_even_if_dead = { trait = creature_gnoll }
					}
				}
			}
			random_list = {
				1 = {
					trigger = {
						OR = {
							true_father_even_if_dead = { trait = creature_half_gnoll }
							mother_even_if_dead = { trait = creature_half_gnoll }
						}
					}
					add_trait = creature_gnoll
					set_graphical_culture = gnoll
				}
				3 = {
					add_trait = creature_half_gnoll
					set_graphical_culture = half_gnoll
				}
			}
		}
		#tabaxi
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_tabaxi }
						mother_even_if_dead = {
							OR = {
								trait = creature_gnoll
								trait = creature_half_gnoll
							}
						}
					}
					AND = {
						mother_even_if_dead = { trait = creature_tabaxi }
						true_father_even_if_dead = {
							OR = {
								trait = creature_gnoll
								trait = creature_half_gnoll
							}
						}
					}
				}
			}
			random_list = {
				1 = {
					add_trait = creature_tabaxi
					set_graphical_culture = tabaxi
				}
				1 = {
					add_trait = creature_gnoll
					set_graphical_culture = gnoll
				}
			}
		}
		#sarrukh
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_sarrukh }
						mother_even_if_dead = {
							race_is_yuanti = yes
						}
					}
					AND = {
						mother_even_if_dead = { trait = creature_sarrukh }
						true_father_even_if_dead = {
							race_is_yuanti = yes
						}
					}
				}
			}
			random_list = {
				1 = {
					add_trait = creature_sarrukh
					set_graphical_culture = sarrukh
				}
				10 = {
					trigger = {
						OR = {
							mother_even_if_dead = {
								OR = {
									trait = creature_pureblood
									trait = creature_malison
								}
							}
							true_father_even_if_dead = {
								OR = {
									trait = creature_pureblood
									trait = creature_malison
								}
							}
						}
					}
					modifier = {
						factor = 0.5
						OR = {
							true_father_even_if_dead = { trait = creature_malison }
							mother_even_if_dead = { trait = creature_malison }
						}
					}
					add_trait = creature_pureblood
					set_graphical_culture = yuanti
				}
				10 = {
					trigger = {
						OR = {
							mother_even_if_dead = {
								race_is_yuanti = yes
							}
							true_father_even_if_dead = {
								race_is_yuanti = yes
							}
						}
					}
					modifier = {
						factor = 0.5
						OR = {
							mother_even_if_dead = {
								OR = {
									trait = creature_pureblood
									trait = creature_abomination
								}
							}
							true_father_even_if_dead = {
								OR = {
									trait = creature_pureblood
									trait = creature_abomination
								}
							}
						}
					}
					add_trait = creature_malison
					set_graphical_culture = malison
				}
				10 = {
					trigger = {
						OR = {
							mother_even_if_dead = {
								OR = {
									trait = creature_malison
									trait = creature_abomination
								}
							}
							true_father_even_if_dead = {
								OR = {
									trait = creature_malison
									trait = creature_abomination
								}
							}
						}
					}
					modifier = {
						factor = 0.5
						OR = {
							mother_even_if_dead = { trait = creature_malison }
							true_father_even_if_dead = { trait = creature_malison }
						}
					}
					add_trait = creature_abomination
					set_graphical_culture = abomination
				}
			}
		}
		#yuan-ti
		#Pureblood + Humans
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_pureblood }
						mother_even_if_dead = {
							race_is_part_human = yes
						}
					}
					AND = {
						true_father_even_if_dead = {
							race_is_part_human = yes
						}
						mother_even_if_dead = { trait = creature_pureblood }
					}
				}
			}
			random_list = {
				4 = {
					add_trait = creature_pureblood
					#set_graphical_culture = yuanti
				}
				1 = {
					modifier = {
						factor = 0
						OR = {
							true_father_even_if_dead = {
								OR = {
									trait = creature_gith
									trait = creature_deep_imaskari
								}
							}
							mother_even_if_dead = {
								OR = {
									trait = creature_gith
									trait = creature_deep_imaskari
								}
							}
						}
					}
					add_trait = creature_human
					human_racial = yes
				}
				1 = {
					default_race_inheritance = yes
				}
			}
		}
		#Pureblood + other yuan-ti or naga
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_pureblood }
						mother_even_if_dead = {
							OR = {
								trait = creature_abomination
								trait = creature_malison
								trait = creature_naga
							}
						}
					}
					AND = {
						true_father_even_if_dead = {
							OR = {
								trait = creature_abomination
								trait = creature_malison
								trait = creature_naga
							}
						}
						mother_even_if_dead = { trait = creature_pureblood }
					}
				}
			}
			random_list = {
				1 = {
					add_trait = creature_pureblood
					set_graphical_culture = yuanti
				}
				1 = {
					add_trait = creature_malison
					set_graphical_culture = halfblood
				}
				1 = {
					add_trait = creature_malison
					set_graphical_culture = malison
				}
				1 = {
					add_trait = creature_abomination
					set_graphical_culture = abomination
				}
			}
		}
		#naga + malison/abomination
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_naga }
						mother_even_if_dead = {
							OR = {
								trait = creature_abomination
								trait = creature_malison
							}
						}
					}
					AND = {
						true_father_even_if_dead = {
							OR = {
								trait = creature_abomination
								trait = creature_malison
							}
						}
						mother_even_if_dead = { trait = creature_naga }
					}
				}
			}
			random_list = {
				1 = {
					add_trait = creature_malison
					set_graphical_culture = malison
				}
				2 = {
					add_trait = creature_naga
					set_graphical_culture = naga
				}
				1 = {
					add_trait = creature_abomination
					set_graphical_culture = abomination
				}
			}
		}
		#lizardfolk + pureblood/malison
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_lizardfolk }
						mother_even_if_dead = {
							OR = {
								trait = creature_pureblood
								trait = creature_malison
							}
						}
					}
					AND = {
						true_father_even_if_dead = {
							OR = {
								trait = creature_pureblood
								trait = creature_malison
							}
						}
						mother_even_if_dead = { trait = creature_lizardfolk }
					}
				}
			}
			random_list = {
				1 = {
					add_trait = creature_pureblood
					set_graphical_culture = yuanti
				}
				1 = {
					add_trait = creature_malison
					set_graphical_culture = halfblood
				}
				1 = {
					add_trait = creature_malison
					set_graphical_culture = malison
				}
				2 = {
					add_trait = creature_lizardfolk
					if = {
						limit = {
							mother_even_if_dead = { trait = creature_lizardfolk }
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
			}
		}
		#dragonborn + pureblood/malison
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_dragonborn }
						mother_even_if_dead = {
							OR = {
								trait = creature_pureblood
								trait = creature_malison
							}
						}
					}
					AND = {
						true_father_even_if_dead = {
							OR = {
								trait = creature_pureblood
								trait = creature_malison
							}
						}
						mother_even_if_dead = { trait = creature_dragonborn }
					}
				}
			}
			random_list = {
				1 = {
					add_trait = creature_pureblood
					set_graphical_culture = yuanti
				}
				1 = {
					add_trait = creature_malison
					set_graphical_culture = malison
				}
				2 = {
					add_trait = creature_dragonborn
					if = {
						limit = {
							mother_even_if_dead = { trait = creature_dragonborn }
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
			}
		}
		# lamia
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_lamia }
						mother_even_if_dead = {
							race_is_yuanti = yes
						}
					}
					AND = {
						mother_even_if_dead = { trait = creature_lamia }
						true_father_even_if_dead = {
							race_is_yuanti = yes
						}
					}
				}
			}
			random_list = {
				1 = {
					modifier = {
						factor = 0
						OR = {
							true_father_even_if_dead = { trait = creature_pureblood }
							mother_even_if_dead = { trait = creature_pureblood }
						}
					}
					add_trait = creature_lamia
					set_graphical_culture = lamia
				}
				1 = {
					add_trait = creature_malison
					set_graphical_culture = malison
				}
				1 = {
					modifier = {
						factor = 0
						NOR = {
							true_father_even_if_dead = {
								OR = {
									trait = creature_malison
									trait = creature_abomination
								}
							}
							mother_even_if_dead = {
								OR = {
									trait = creature_malison
									trait = creature_abomination
								}
							}
						}
					}
					add_trait = creature_abomination
					set_graphical_culture = abomination
				}
			}
		}
		# sahuagin + malenti
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_sahuagin }
						mother_even_if_dead = { trait = creature_malenti }
					}
					AND = {
						mother_even_if_dead = { trait = creature_sahuagin }
						true_father_even_if_dead = { trait = creature_malenti }
					}
				}
			}
			add_trait = creature_malenti
			set_graphical_culture = malenti
		}
		# tieflings from fiends + humans
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_fiend }
						mother_even_if_dead = {
							race_is_part_human = yes
						}
					}
					AND = {
						mother_even_if_dead = { trait = creature_fiend }
						true_father_even_if_dead = {
							race_is_part_human = yes
						}
					}
				}
			}
			random_list = {
				5 = {
					tiefling_race_inheritance = yes
				}
				1 = {
					modifier = {
						factor = 0
						NOR = {
							true_father_even_if_dead = { trait = creature_half_orc }
							mother_even_if_dead = { trait = creature_half_orc }
						}
					}
					add_trait = creature_tanarukk
					set_graphical_culture = tanarukk
				}
				1 = {
					modifier = {
						factor = 0
						NOR = {
							true_father_even_if_dead = { trait = creature_half_elf }
							mother_even_if_dead = { trait = creature_half_elf }
						}
					}
					if = {
						limit = {
							OR = {
								true_father_even_if_dead = { graphical_culture = druchiigfx }
								mother_even_if_dead = { graphical_culture = druchiigfx }
							}
						}
						add_trait = creature_draegloth
						set_graphical_culture = draegloth
					}
					else = {
						add_trait = creature_feyri
						set_graphical_culture = feyri
					}
				}
			}
		}
		#Tanarukk from fiend + orc
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_fiend }
						mother_even_if_dead = {
							race_is_orcish = yes
						}
					}
					AND = {
						mother_even_if_dead = { trait = creature_fiend }
						true_father_even_if_dead = {
							race_is_orcish = yes
						}
					}
				}
			}
			add_trait = creature_tanarukk
			set_graphical_culture = tanarukk
		}
		#Fey'ri from fiend + elf
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_fiend }
						mother_even_if_dead = {
							OR = {
								trait = creature_elf
								trait = creature_feyri
							}
						}
					}
					AND = {
						mother_even_if_dead = { trait = creature_fiend }
						true_father_even_if_dead = {
							OR = {
								trait = creature_elf
								trait = creature_feyri
							}
						}
					}
				}
			}
			add_trait = creature_feyri
			if = {
				limit = {
					OR = {
						true_father_even_if_dead = {
							graphical_culture = daemonettegfx
						}
						mother_even_if_dead = {
							graphical_culture = daemonettegfx
						}
					}
				}
				if = {
					limit = {
						mother_even_if_dead = { NOT = { trait = creature_fiend } }
					}
					mother_even_if_dead = {
						tb_graph_culture_racial = yes
					}
				}
				else = {
					true_father_even_if_dead = {
						tb_graph_culture_racial = yes
					}
				}
			}
			else = {
				set_graphical_culture = feyri
			}
		}
		#Draegloth from fiend + drow
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_fiend }
						mother_even_if_dead = {
							OR = {
								trait = creature_drow
								trait = creature_draegloth
							}
						}
					}
					AND = {
						mother_even_if_dead = { trait = creature_fiend }
						true_father_even_if_dead = {
							OR = {
								trait = creature_drow
								trait = creature_draegloth
							}
						}
					}
				}
			}
			add_trait = creature_draegloth
			set_graphical_culture = draegloth
		}
		# aasimar from angels
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_angel }
						mother_even_if_dead = {
							race_is_part_human = yes
						}
					}
					AND = {
						mother_even_if_dead = { trait = creature_angel }
						true_father_even_if_dead = {
							race_is_part_human = yes
						}
					}
				}
			}
			aasimar_race_inheritance = yes
		}
		# hags
		else_if = {
			limit = {
				true_father_even_if_dead = {
					OR = {
						race_is_fey = yes
						is_humanoid = yes
						race_is_goblinoid = yes
						race_is_giantkin = yes
						race_is_ogrekin = yes
					}
				}
				mother_even_if_dead = { trait = creature_hag }
			}
			if = {
				limit = {
					is_female = yes
				}
				add_trait = creature_hag
				set_graphical_culture = hag
			}
			else_if = {
				limit = {
					true_father_even_if_dead = { trait = creature_satyr }
				}
				add_trait = creature_satyr
				set_graphical_culture = satyr
			}
			else_if = {
				limit = {
					true_father_even_if_dead = { trait = creature_hengeyokai }
				}
				spawn_random_hengeyokai = yes
			}
			else_if = {
				limit = {
					true_father_even_if_dead = { trait = creature_treant }
				}
				add_trait = creature_treant
				set_graphical_culture = treant
			}
			else = {
				add_trait = creature_hagspawn
				set_graphical_culture = hag
			}
		}
		# satyrs
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_satyr }
						mother_even_if_dead = {
							OR = {
								is_humanoid = yes
								race_is_goblinoid = yes
								trait = creature_gnoll
							}
						}
					}
					AND = {
						mother_even_if_dead = { trait = creature_satyr }
						true_father_even_if_dead = {
							OR = {
								is_humanoid = yes
								race_is_goblinoid = yes
								trait = creature_gnoll
							}
						}
					}
				}
			}
			random_list = {
				5 = {
					add_trait = creature_satyr
					set_graphical_culture = satyr
				}
				3 = {
					modifier = {
						factor = 0
						NOR = {
							true_father_even_if_dead = { trait = creature_spirit_folk }
							mother_even_if_dead = { trait = creature_spirit_folk }
						}
					}
					add_trait = creature_spirit_folk
					set_graphical_culture = spiritfolk
				}
				1 = {
					modifier = {
						factor = 0
						NOR = {
							true_father_even_if_dead = {
								OR = {
									trait = creature_elf
									trait = creature_half_elf
									trait = creature_feyri
								}
							}
							mother_even_if_dead = {
								OR = {
									trait = creature_elf
									trait = creature_half_elf
									trait = creature_feyri
								}
							}
						}
					}
					add_trait = creature_elf
					set_graphical_culture = eladrin
					add_trait = feytouched
				}
				1 = {
					modifier = {
						factor = 0
						NOR = {
							true_father_even_if_dead = {
								OR = {
									trait = creature_drow
									trait = creature_draegloth
								}
							}
							mother_even_if_dead = {
								OR = {
									trait = creature_drow
									trait = creature_draegloth
								}
							}
						}
					}
					add_trait = creature_drow
					set_graphical_culture = drow
					add_trait = feytouched
				}
				1 = {
					trigger = {
						OR = {
							true_father_even_if_dead = {
								OR = {
									is_humanoid = yes
									race_is_goblinoid = yes
									trait = creature_gnoll
								}
							}
							mother_even_if_dead = {
								OR = {
									is_humanoid = yes
									race_is_goblinoid = yes
									trait = creature_gnoll
								}
							}
						}
					}
					default_race_inheritance = yes
				}
			}
		}
		# genies
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_genie }
						mother_even_if_dead = { 
							is_humanoid = yes
						}
					}
					AND = {
						mother_even_if_dead = { trait = creature_genie }
						true_father_even_if_dead = { 
							is_humanoid = yes
						}
					}
				}
			}
			add_trait = creature_genasi
			random_list = {
				25 = {
					modifier = {
						factor = 0
						OR = {
							true_father_even_if_dead = {
								OR = {
									graphical_culture = earthgeniegfx
									graphical_culture = airgeniegfx
									graphical_culture = watergeniegfx
								}
							}
							mother_even_if_dead = {
								OR = {
									graphical_culture = earthgeniegfx
									graphical_culture = airgeniegfx
									graphical_culture = watergeniegfx
								}
							}
						}
					}
					set_graphical_culture = firegenasi
				}
				25 = {
					modifier = {
						factor = 0
						OR = {
							true_father_even_if_dead = {
								OR = {
									graphical_culture = firegeniegfx
									graphical_culture = airgeniegfx
									graphical_culture = watergeniegfx
								}
							}
							mother_even_if_dead = {
								OR = {
									graphical_culture = firegeniegfx
									graphical_culture = airgeniegfx
									graphical_culture = watergeniegfx
								}
							}
						}
					}
					set_graphical_culture = earthgenasi
				}
				25 = {
					modifier = {
						factor = 0
						OR = {
							true_father_even_if_dead = {
								OR = {
									graphical_culture = earthgeniegfx
									graphical_culture = firegeniegfx
									graphical_culture = watergeniegfx
								}
							}
							mother_even_if_dead = {
								OR = {
									graphical_culture = earthgeniegfx
									graphical_culture = firegeniegfx
									graphical_culture = watergeniegfx
								}
							}
						}
					}
					set_graphical_culture = airgenasi
				}
				25 = {
					modifier = {
						factor = 0
						OR = {
							true_father_even_if_dead = {
								OR = {
									graphical_culture = earthgeniegfx
									graphical_culture = airgeniegfx
									graphical_culture = firegeniegfx
								}
							}
							mother_even_if_dead = {
								OR = {
									graphical_culture = earthgeniegfx
									graphical_culture = airgeniegfx
									graphical_culture = firegeniegfx
								}
							}
						}
					}
					set_graphical_culture = watergenasi
				}
			}
		}
		# outsider crossbreeds
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_fiend }
						mother_even_if_dead = {
							OR = {
								trait = creature_angel
								trait = creature_genie
								has_character_flag = secret_fiend
							}
						}
					}
					AND = {
						mother_even_if_dead = { trait = creature_fiend }
						true_father_even_if_dead = {
							OR = {
								trait = creature_angel
								trait = creature_genie
								has_character_flag = secret_fiend
							}
						}
					}
				}
			}
			random_list = {
				10 = {
					add_trait = creature_fiend
					if = {
						limit = {
							mother_even_if_dead = {
								trait = creature_fiend
							}
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
				3 = {
					trigger = {
						OR = {
							mother_even_if_dead = { trait = creature_genie }
							true_father_even_if_dead = { trait = creature_genie }
						}
					}
					add_trait = creature_genie
					if = {
						limit = {
							mother_even_if_dead = {
								trait = creature_genie
							}
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
				1 = {
					trigger = {
						OR = {
							mother_even_if_dead = { trait = creature_angel }
							true_father_even_if_dead = { trait = creature_angel }
						}
					}
					add_trait = creature_angel
					if = {
						limit = {
							mother_even_if_dead = {
								trait = creature_angel
							}
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_angel }
						mother_even_if_dead = { trait = creature_genie }
					}
					AND = {
						mother_even_if_dead = { trait = creature_angel }
						true_father_even_if_dead = { trait = creature_genie }
					}
				}
			}
			random_list = {
				1 = {
					add_trait = creature_genie
					if = {
						limit = {
							mother_even_if_dead = {
								trait = creature_genie
							}
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
				3 = {
					add_trait = creature_angel
					if = {
						limit = {
							mother_even_if_dead = {
								trait = creature_angel
							}
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
			}
		}
		#Hengeyokai
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_hengeyokai }
						mother_even_if_dead = {
							is_humanoid = yes
						}
					}
					AND = {
						mother_even_if_dead = { trait = creature_hengeyokai }
						true_father_even_if_dead = {
							is_humanoid = yes
						}
					}
				}
			}
			random_list = {
				5 = {
					spawn_random_hengeyokai = yes
				}
				3 = {
					modifier = {
						factor = 0
						NOR = {
							true_father_even_if_dead = { trait = creature_spirit_folk }
							mother_even_if_dead = { trait = creature_spirit_folk }
						}
					}
					add_trait = creature_spirit_folk
					set_graphical_culture = spiritfolk
				}
				2 = {
					default_race_inheritance = yes
				}
			}
		}
		#saurials, pterafolk & dragonborn
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_saurial }
						mother_even_if_dead = { trait = creature_dragonborn }
					}
					AND = {
						mother_even_if_dead = { trait = creature_saurial }
						true_father_even_if_dead = { trait = creature_dragonborn }
					}
				}
			}
			random_list = {
				3 = {
					add_trait = creature_saurial
					set_graphical_culture = saurial
				}
				1 = {
					add_trait = creature_dragonborn
					if = {
						limit = {
							mother_even_if_dead = { trait = creature_dragonborn }
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_pterafolk }
						mother_even_if_dead = { trait = creature_dragonborn }
					}
					AND = {
						mother_even_if_dead = { trait = creature_pterafolk }
						true_father_even_if_dead = { trait = creature_dragonborn }
					}
				}
			}
			random_list = {
				3 = {
					add_trait = creature_pterafolk
					set_graphical_culture = pterafolk
				}
				1 = {
					add_trait = creature_dragonborn
					if = {
						limit = {
							mother_even_if_dead = { trait = creature_dragonborn }
						}
						mother_even_if_dead = { tb_graph_culture_racial = yes }
					}
					else = {
						true_father_even_if_dead = { tb_graph_culture_racial = yes }
					}
				}
			}
		}
		#Dragonborn + Dragon
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_dragon }
						mother_even_if_dead = { trait = creature_dragonborn }
					}
					AND = {
						mother_even_if_dead = { trait = creature_dragon }
						true_father_even_if_dead = { trait = creature_dragonborn }
					}
				}
			}
			add_trait = creature_dragonborn
			if = {
				limit = {
					OR = {
						mother_even_if_dead = {
							trait = creature_dragon
							religion = tiamat
						}
						true_father_even_if_dead = {
							trait = creature_dragon
							religion = tiamat
						}
					}
				}
				set_graphical_culture = dragonspawn
			}
			else_if = {
				limit = {
					OR = {
						mother_even_if_dead = {
							trait = creature_dragon
							religion = bahamut
						}
						true_father_even_if_dead = {
							trait = creature_dragon
							religion = bahamut
						}
					}
				}
				set_graphical_culture = dragonborn
			}
			else_if = {
				limit = {
					mother_even_if_dead = { trait = creature_dragonborn }
				}
				mother_even_if_dead = { tb_graph_culture_racial = yes }
			}
			else = {
				true_father_even_if_dead = { tb_graph_culture_racial = yes }
			}
		}
		#Half-giants
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_giant }
						mother_even_if_dead = {
							race_is_part_human = yes
						}
					}
					AND = {
						mother_even_if_dead = { trait = creature_giant }
						true_father_even_if_dead = {
							race_is_part_human = yes
						}
					}
				}
			}
			add_trait = creature_half_giant
			goliath_race_inheritance = yes
		}
		#Kobold crossbreeding = 3/4 kobold, 1/4 other
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = creature_kobold }
						mother_even_if_dead = {
							OR = {
								trait = creature_dragonborn
								trait = creature_lizardfolk
								race_is_saurid = yes
							}
						}
					}
					AND = {
						mother_even_if_dead = { trait = creature_kobold }
						true_father_even_if_dead = {
							OR = {
								trait = creature_dragonborn
								trait = creature_lizardfolk
								race_is_saurid = yes
							}
						}
					}
				}
			}
			random_list = {
				1 = {
					default_race_inheritance = yes
				}
				1 = {
					add_trait = creature_kobold
					set_graphical_culture = kobold
				}
			}
		}
		#Fiends + everything else
		else_if = {
			limit = {
				OR = {
					true_father_even_if_dead = { trait = creature_fiend }
					mother_even_if_dead = { trait = creature_fiend }
				}
			}
			if = {
				limit = {
					OR = {
						true_father_even_if_dead = { trait = creature_dwarf }
						mother_even_if_dead = { trait = creature_dwarf }
					}
				}
				add_trait = creature_dwarf
				if = {
					limit = {
						mother_even_if_dead = { trait = creature_dwarf }
					}
					mother_even_if_dead = { tb_graph_culture_racial = yes }
				}
				else = {
					true_father_even_if_dead = { tb_graph_culture_racial = yes }
				}
				if = {
					limit = {
						OR = {
							graphical_culture = duergargfx
							culture = duergar
						}
					}
					add_character_modifier = {
						name = durzagon
						duration = -1
					}
					set_graphical_culture = gold_dwarf
				}
				else = {
					add_character_modifier = {
						name = maeluth
						duration = -1
					}
				}
			}
			else_if = {
				limit = {
					OR = {
						true_father_even_if_dead = { trait = creature_troll }
						mother_even_if_dead = { trait = creature_troll }
					}
				}
				add_trait = creature_troll
				set_graphical_culture = troll
			}
			else_if = {
				limit = {
					mother_even_if_dead = { trait = creature_hag }
				}
				if = {
					limit = {
						is_female = yes
					}
					add_trait = creature_hag
					set_graphical_culture = hag
				}
				else = {
					tiefling_race_inheritance = yes
				}
			}
			else_if = {
				limit = {
					OR = {
						true_father_even_if_dead = { trait = creature_halfling }
						mother_even_if_dead = { trait = creature_halfling }
					}
				}
				add_trait = creature_halfling
				set_graphical_culture = lightfoot
				add_character_modifier = {
					name = wispling
					duration = -1
				}
			}
			else_if = {
				limit = {
					OR = {
						true_father_even_if_dead = { trait = creature_dragon }
						mother_even_if_dead = { trait = creature_dragon }
					}
				}
				add_trait = creature_dragon
				if = {
					limit = {
						mother_even_if_dead = { trait = creature_dragon }
					}
					mother_even_if_dead = {
						tb_graph_culture_racial = yes
					}
				}
				else = {
					true_father_even_if_dead = {
						tb_graph_culture_racial = yes
					}
				}
			}
			else = {
				default_race_inheritance = yes
			}
			add_trait = half_fiend
		}
		#Dragons + Everything Else (except dragonborn, fiends and angels)
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = {
							OR = {
								trait = creature_dragon
								has_character_flag = secret_dragon
							}
						}
						mother_even_if_dead = {
							NOR = {
								trait = creature_dragonborn
								trait = creature_fiend
								trait = creature_angel
							}
						}
					}
					AND = {
						mother_even_if_dead = {
							OR = {
								trait = creature_dragon
								has_character_flag = secret_dragon
							}
						}
						true_father_even_if_dead = {
							NOR = {
								trait = creature_dragonborn
								trait = creature_fiend
								trait = creature_angel
							}
						}
					}
				}
			}
			if = {
				limit = {
					OR = {
						true_father_even_if_dead = {
							OR = {
								trait = creature_drow
								trait = creature_draegloth
							}
						}
						mother_even_if_dead = {
							OR = {
								trait = creature_drow
								trait = creature_draegloth
							}
						}
					}
				}
				add_trait = creature_drow
				set_graphical_culture = drow
			}
			else_if = {
				limit = {
					OR = {
						true_father_even_if_dead = { trait = creature_feyri }
						mother_even_if_dead = { trait = creature_feyri }
					}
				}
				add_trait = creature_elf
				set_graphical_culture = sun_elf
				add_trait = planetouched
			}
			else_if = {
				limit = {
					OR = {
						true_father_even_if_dead = { trait = creature_troll }
						mother_even_if_dead = { trait = creature_troll }
					}
				}
				add_trait = creature_troll
				set_graphical_culture = troll
			}
			else_if = {
				limit = {
					mother_even_if_dead = { trait = creature_hag }
				}
				if = {
					limit = {
						is_female = yes
					}
					add_trait = creature_hag
					set_graphical_culture = hag
				}
				else = {
					add_trait = creature_human # to keep consistency
					human_racial = yes
				}
			}
			else_if = {
				limit = {
					true_father_even_if_dead = { trait = creature_hagspawn }
				}
				add_trait = creature_human
				human_racial = yes
			}
			else_if = {
				limit = {
					OR = {
						true_father_even_if_dead = { trait = creature_tanarukk }
						mother_even_if_dead = { trait = creature_tanarukk }
					}
				}
				add_trait = creature_orc
				set_graphical_culture = orc
				add_trait = planetouched
			}
			else = {
				default_race_inheritance = yes
			}
			add_trait = half_dragon
		}
		#half-trolls
		else_if = {
			limit = {
				OR = {
					true_father_even_if_dead = { trait = creature_troll }
					mother_even_if_dead = { trait = creature_troll }
				}
			}
			if = {
				limit = {
					mother_even_if_dead = { trait = creature_hag }
				}
				if = {
					limit = {
						is_female = yes
					}
					add_trait = creature_hag
					set_graphical_culture = hag
				}
				else = {
					add_trait = creature_human # to keep consistency
					human_racial = yes 
				}
			}
			else = {
				default_race_inheritance = yes
			}
			add_trait = half_troll
		}
		#Angels + Everything Else
		else_if = {
			limit = {
				OR = {
					true_father_even_if_dead = { trait = creature_angel }
					mother_even_if_dead = { trait = creature_angel }
				}
			}
			if = {
				limit = {
					OR = {
						true_father_even_if_dead = {
							OR = {
								trait = creature_drow
								trait = creature_draegloth
							}
						}
						mother_even_if_dead = {
							OR = {
								trait = creature_drow
								trait = creature_draegloth
							}
						}
					}
				}
				add_trait = creature_drow
				set_graphical_culture = drow
			}
			else_if = {
				limit = {
					OR = {
						true_father_even_if_dead = { trait = creature_feyri }
						mother_even_if_dead = { trait = creature_feyri }
					}
				}
				add_trait = creature_elf
				set_graphical_culture = sun_elf
			}
			else_if = {
				limit = {
					OR = {
						true_father_even_if_dead = { trait = creature_troll }
						mother_even_if_dead = { trait = creature_troll }
					}
				}
				add_trait = creature_troll
				set_graphical_culture = troll
			}
			else_if = {
				limit = {
					mother_even_if_dead = { trait = creature_hag }
				}
				if = {
					limit = {
						is_female = yes
					}
					add_trait = creature_hag
					set_graphical_culture = hag
				}
				else = {
					aasimar_race_inheritance = yes
				}
			}
			else_if = {
				limit = {
					OR = {
						true_father_even_if_dead = { trait = creature_tanarukk }
						mother_even_if_dead = { trait = creature_tanarukk }
					}
				}
				add_trait = creature_orc
				set_graphical_culture = orc
			}
			else_if = {
				limit = {
					OR = {
						true_father_even_if_dead = { trait = creature_dragon }
						mother_even_if_dead = { trait = creature_dragon }
					}
				}
				add_trait = creature_dragon
				if = {
					limit = {
						mother_even_if_dead = { trait = creature_dragon }
					}
					mother_even_if_dead = {
						tb_graph_culture_racial = yes
					}
				}
				else = {
					true_father_even_if_dead = {
						tb_graph_culture_racial = yes
					}
				}
			}
			else = {
				default_race_inheritance = yes
			}
			add_trait = half_celestial
		}
		# Default handler = 50% either parent
		else = {
			default_race_inheritance = yes
		}

		if = {
			limit = {
				true_father_even_if_dead = { has_character_flag = secret_dragon }
				mother_even_if_dead = { has_character_flag = secret_dragon }
			}
			set_character_flag = secret_dragon
			random_list = {
				1 = {
					trigger = {
						OR = {
							mother_even_if_dead = { has_character_flag = is_red_dragon }
							true_father_even_if_dead = { has_character_flag = is_red_dragon }
						}
					}
					set_character_flag = is_red_dragon
				}
				1 = {
					trigger = {
						OR = {
							mother_even_if_dead = { has_character_flag = is_green_dragon }
							true_father_even_if_dead = { has_character_flag = is_green_dragon }
						}
					}
					set_character_flag = is_green_dragon
				}
				1 = {
					trigger = {
						OR = {
							mother_even_if_dead = { has_character_flag = is_blue_dragon }
							true_father_even_if_dead = { has_character_flag = is_blue_dragon }
						}
					}
					set_character_flag = is_blue_dragon
				}
				1 = {
					trigger = {
						OR = {
							mother_even_if_dead = { has_character_flag = is_black_dragon }
							true_father_even_if_dead = { has_character_flag = is_black_dragon }
						}
					}
					set_character_flag = is_black_dragon
				}
				1 = {
					trigger = {
						OR = {
							mother_even_if_dead = { has_character_flag = is_amethyst_dragon }
							true_father_even_if_dead = { has_character_flag = is_amethyst_dragon }
						}
					}
					set_character_flag = is_amethyst_dragon
				}
				1 = {
					trigger = {
						OR = {
							mother_even_if_dead = { has_character_flag = is_ruby_dragon }
							true_father_even_if_dead = { has_character_flag = is_ruby_dragon }
						}
					}
					set_character_flag = is_ruby_dragon
				}
				1 = {
					trigger = {
						OR = {
							mother_even_if_dead = { has_character_flag = is_gold_dragon }
							true_father_even_if_dead = { has_character_flag = is_gold_dragon }
						}
					}
					set_character_flag = is_gold_dragon
				}
				1 = {
					trigger = {
						OR = {
							mother_even_if_dead = { has_character_flag = is_silver_dragon }
							true_father_even_if_dead = { has_character_flag = is_silver_dragon }
						}
					}
					set_character_flag = is_silver_dragon
				}
				1 = {
					trigger = {
						OR = {
							mother_even_if_dead = { has_character_flag = is_bronze_dragon }
							true_father_even_if_dead = { has_character_flag = is_bronze_dragon }
						}
					}
					set_character_flag = is_bronze_dragon
				}
				1 = {
					trigger = {
						OR = {
							mother_even_if_dead = { has_character_flag = is_brass_dragon }
							true_father_even_if_dead = { has_character_flag = is_brass_dragon }
						}
					}
					set_character_flag = is_brass_dragon
				}
				1 = {
					trigger = {
						OR = {
							mother_even_if_dead = { has_character_flag = is_copper_dragon }
							true_father_even_if_dead = { has_character_flag = is_copper_dragon }
						}
					}
					set_character_flag = is_copper_dragon
				}
				1 = {
					trigger = {
						OR = {
							mother_even_if_dead = { has_character_flag = is_shadow_dragon }
							true_father_even_if_dead = { has_character_flag = is_shadow_dragon }
						}
					}
					set_character_flag = is_shadow_dragon
				}
				1 = {
					trigger = {
						OR = {
							mother_even_if_dead = { has_character_flag = is_song_dragon }
							true_father_even_if_dead = { has_character_flag = is_song_dragon }
						}
					}
					set_character_flag = is_song_dragon
				}
			}
		}
	}

	option = {
		trigger = { # One parent available
			OR = {
				AND = {
					true_father_even_if_dead = { always = yes }
					NOT = { mother_even_if_dead = { always = yes } }
				}
				AND = {
					NOT = { true_father_even_if_dead = { always = yes } }
					mother_even_if_dead = { always = yes }
				}
			}
		}
		if = {
			limit = {
				OR = {
					true_father_even_if_dead = { trait = creature_angel }
					mother_even_if_dead = { trait = creature_angel }
				}
			}
			aasimar_race_inheritance = yes
		}
		else_if = {
			limit = {
				OR = {
					true_father_even_if_dead = { trait = creature_fiend }
					mother_even_if_dead = { trait = creature_fiend }
				}
			}
			tiefling_race_inheritance = yes
		}
		else_if = {
			limit = {
				OR = {
					true_father_even_if_dead = { trait = creature_genie }
					mother_even_if_dead = { trait = creature_genie }
				}
			}
			add_trait = creature_genasi
		}
		else = {
			default_race_inheritance = yes
			if = {
				limit = {
					faerun_any_race = no
				}
				if = {
					limit = {
						true_father_even_if_dead = { always = yes }
					}
					true_father_even_if_dead = {
						ROOT = { copy_race_of_prev = yes }
					}
				}
				else = {
					mother_even_if_dead = {
						ROOT = { copy_race_of_prev = yes }
					}
				}
			}
		}
	}

	after = {
		#Certain bloodlines have a chance of turning members of it into aasimar or tiefling/feyri/whatever is appropriate
		if = {
			limit = {
				trait = creature_human
				any_owned_bloodline = { has_bloodline_flag = infernal_bloodline }
			}
			random = {
				chance = 10
				remove_all_race_traits = yes
				add_trait = creature_tiefling
				set_graphical_culture = tiefling
				add_character_modifier = {
					name = divine_tiefling
					duration = -1
				}
			}
		}
		else_if = {
			limit = {
				trait = creature_elf
				any_owned_bloodline = { has_bloodline_flag = infernal_bloodline }
			}
			random = {
				chance = 10
				remove_trait = creature_elf
				add_trait = creature_feyri
				set_graphical_culture = feyri
				add_character_modifier = {
					name = divine_tiefling
					duration = -1
				}
			}
		}
		else_if = {
			limit = {
				trait = creature_drow
				any_owned_bloodline = { has_bloodline_flag = infernal_bloodline }
			}
			random = {
				chance = 10
				remove_trait = creature_drow
				add_trait = creature_draegloth
				set_graphical_culture = draegloth
				add_character_modifier = {
					name = divine_tiefling
					duration = -1
				}
			}
		}
		else_if = {
			limit = {
				race_is_orcish = yes
				any_owned_bloodline = { has_bloodline_flag = infernal_bloodline }
			}
			random = {
				chance = 10
				remove_all_race_traits = yes
				add_trait = creature_tanarukk
				set_graphical_culture = tanarukk
				add_character_modifier = {
					name = divine_tiefling
					duration = -1
				}
			}
		}
		else_if = {
			limit = {
				trait = creature_human
				any_owned_bloodline = { has_bloodline_flag = divine_bloodline }
			}
			random = {
				chance = 10
				remove_all_race_traits = yes
				add_trait = creature_aasimar
				random_list = {
					5 = {
						set_graphical_culture = aasimar
					}
					1 = {
						modifier = {
							factor = 20
							any_owned_bloodline = {
								founder = { race_part_animal = yes }
							}
						}
						spawn_random_ardling = yes
					}
				}
				add_character_modifier = {
					name = divine_aasimar
					duration = -1
				}
			}
		}

		# Half-Celestial inheritance
		if = {
			limit = {
				true_father_even_if_dead = { trait = half_celestial }
				mother_even_if_dead = { trait = half_celestial }
			}
			add_trait = half_celestial
		}
		else_if = {
			limit = {
				OR = {
					true_father_even_if_dead = { trait = half_celestial }
					mother_even_if_dead = { trait = half_celestial }
				}
			}
			random_list = {
				1 = { add_trait = half_celestial }
				1 = { add_trait = planetouched }
			}
		}

		# Half_Fiend inheritance
		if = {
			limit = {
				OR = {
					true_father_even_if_dead = {
						OR = {
							trait = archfiend
							trait = greater_fiend
						}
					}
					mother_even_if_dead = {
						OR = {
							trait = archfiend
							trait = greater_fiend
						}
					}
					AND = {
						true_father_even_if_dead = { trait = half_fiend }
						mother_even_if_dead = { trait = half_fiend }
					}
				}
				NOT = { trait = creature_fiend }
			}
			add_trait = half_fiend
		}
		else_if = {
			limit = {
				OR = {
					true_father_even_if_dead = { trait = half_fiend }
					mother_even_if_dead = { trait = half_fiend }
				}
				NOT = { trait = creature_fiend }
			}
			random_list = {
				1 = { add_trait = half_fiend }
				1 = { add_trait = planetouched }
			}
		}

		# Planetouched inheritance
		if = {
			limit = {
				OR = {
					true_father_even_if_dead = {
						race_is_planar = yes
					}
					mother_even_if_dead = {
						race_is_planar = yes
					}
					true_father = {
						has_character_flag = secret_fiend
					}
					mother = {
						has_character_flag = secret_fiend
					}
				}
				is_planetouched = no
			}
			add_trait = planetouched
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { is_planetouched = yes }
				mother_even_if_dead = { is_planetouched = yes }
				is_planetouched = no
			}
			add_trait = planetouched
		}
		else_if = {
			limit = {
				OR = {
					true_father_even_if_dead = { is_planetouched = yes }
					mother_even_if_dead = { is_planetouched = yes }
				}
				is_planetouched = no
			}
			random = {
				chance = 50
				add_trait = planetouched
			}
		}

		# Feytouched inheritance
		if = {
			limit = {
				OR = {
					true_father_even_if_dead = {
						race_is_fey = yes
					}
					mother_even_if_dead = {
						race_is_fey = yes
					}
				}
				race_is_fey = no
			}
			add_trait = feytouched
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { trait = feytouched }
				mother_even_if_dead = { trait = feytouched }
			}
			add_trait = feytouched
		}
		else_if = {
			limit = {
				OR = {
					true_father_even_if_dead = { trait = feytouched }
					mother_even_if_dead = { trait = feytouched }
				}
			}
			random = {
				chance = 50
				add_trait = feytouched
			}
		}

		# Half-Troll inheritance
		if = {
			limit = {
				NOT = { trait = creature_troll }
				true_father_even_if_dead = { trait = half_troll }
				mother_even_if_dead = { trait = half_troll }
			}
			random_list = {
				3 = {
					add_trait = half_troll
				}
				1 = {
					remove_all_race_traits = yes
					add_trait = creature_troll
					set_graphical_culture = troll
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					true_father_even_if_dead = { trait = half_troll }
					mother_even_if_dead = { trait = half_troll }
				}
			}
			random = {
				chance = 50
				add_trait = half_troll
			}
		}

		# Half-Dragon inheritance
		if = {
			limit = {
				true_father_even_if_dead = { trait = half_dragon }
				mother_even_if_dead = { trait = half_dragon }
			}
			add_trait = half_dragon
		}
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = half_dragon }
						mother_even_if_dead = {
							NOR = {
								trait = creature_dragon
								trait = half_dragon
								has_character_flag = secret_dragon
							}
						}
					}
					AND = {
						true_father_even_if_dead = {
							NOR = {
								trait = creature_dragon
								trait = half_dragon
								has_character_flag = secret_dragon
							}
						}
						mother_even_if_dead = { trait = half_dragon }
					}
				}
			}
			random = {
				chance = 50
				add_trait = half_dragon
			}
		}
		else_if = {
			limit = {
				OR = {
					AND = {
						true_father_even_if_dead = { trait = half_dragon }
						mother_even_if_dead = {
							OR = {
								trait = creature_dragon
								has_character_flag = secret_dragon
							}
						}
					}
					AND = {
						mother_even_if_dead = { trait = half_dragon }
						true_father_even_if_dead = {
							OR = {
								trait = creature_dragon
								has_character_flag = secret_dragon
							}
						}
					}
				}
			}
			random = {
				chance = 5
				remove_all_race_traits = yes
				remove_trait = half_dragon
				dragon_race_inheritance = yes
			}
		}

		#Dhampyr
		if = {
			limit = {
				OR = {
					true_father_even_if_dead = {
						OR = {
							trait = vampire
							trait = vampire_spawn
						}
					}
					mother_even_if_dead = {
						OR = {
							trait = vampire
							trait = vampire_spawn
						}
					}
				}
			}
			add_trait = dhampyr
		}

		#Inherit planetouched modifiers.
		character_event = { id = character_trait.2 }

		#Turning fully planetouched.
		if = {
			limit = {
				trait = creature_human
				trait = planetouched
				true_father_even_if_dead = { trait = planetouched }
				mother_even_if_dead = { trait = planetouched }
			}
			if = {
				limit = {
					OR = {
						has_character_modifier = devil_tiefling
						has_character_modifier = demon_tiefling
						has_character_modifier = divine_tiefling
						has_character_modifier = baphitaur
						has_character_modifier = durzagon
						has_character_modifier = maeluth
						has_character_modifier = mur_zhagul
						has_character_modifier = wispling
					}
				}
				remove_trait = creature_human
				add_trait = creature_tiefling
				set_graphical_culture = tiefling
			}
			else_if = {
				limit = {
					OR = {
						has_character_modifier = demodand_tiefling
						has_character_modifier = yugoloth_tiefling
					}
				}
				remove_trait = creature_human
				add_trait = creature_tiefling
				set_graphical_culture = cambion
			}
			else_if = {
				limit = {
					has_character_modifier = rakshasa_tiefling
				}
				remove_trait = creature_human
				add_trait = creature_tiefling
				set_graphical_culture = wemic
			}
			else_if = {
				limit = {
					has_character_modifier = marrashi_tiefling
				}
				remove_trait = creature_human
				add_trait = creature_tiefling
				set_graphical_culture = half_gnoll
			}
			else_if = {
				limit = {
					OR = {
						has_character_modifier = angel_aasimar
						has_character_modifier = divine_aasimar
					}
				}
				remove_trait = creature_human
				add_trait = creature_aasimar
				if = {
					limit = {
						OR = {
							true_father_even_if_dead = { race_part_animal = yes }
							mother_even_if_dead = { race_part_animal = yes }
						}
					}
					spawn_random_ardling = yes
				}
				else = {
					set_graphical_culture = aasimar
					random = {
						chance = 10
						set_graphical_culture = deva_aasimar
					}
				}
			}
			else_if = {
				limit = {
					has_character_modifier = asura_aasimar
				}
				remove_trait = creature_human
				add_trait = creature_aasimar
				set_graphical_culture = deva_aasimar
			}
			else_if = {
				limit = {
					OR = {
						has_character_modifier = archon_aasimar
						has_character_modifier = guardinal_aasimar
					}
				}
				remove_trait = creature_human
				add_trait = creature_aasimar
				spawn_random_ardling = yes
			}
			else_if = {
				limit = {
					has_character_modifier = eladrin_aasimar
				}
				remove_trait = creature_human
				add_trait = creature_aasimar
				set_graphical_culture = eladrin_aasimar
			}
			else_if = {
				limit = {
					has_character_modifier = einheriar_aasimar
				}
				remove_trait = creature_human
				add_trait = creature_aasimar
				set_graphical_culture = einheriar
			}
			else_if = {
				limit = {
					has_character_modifier = moonmaiden_aasimar
				}
				remove_trait = creature_human
				add_trait = creature_aasimar
				set_graphical_culture = moonmaiden
			}
			else_if = {
				limit = {
					has_genasi_subtype = yes
				}
				remove_trait = creature_human
				add_trait = creature_genasi
				set_genasi_subtype = yes
			}
		}
		else_if = {
			limit = {
				race_is_orcish = yes
				trait = planetouched
				true_father_even_if_dead = { trait = planetouched }
				mother_even_if_dead = { trait = planetouched }
				has_tiefling_subtype = yes
			}
			remove_all_race_traits = yes
			add_trait = creature_tanarukk
			remove_trait = planetouched
			set_graphical_culture = tanarukk
		}
		else_if = {
			limit = {
				trait = creature_elf
				trait = planetouched
				true_father_even_if_dead = { trait = planetouched }
				mother_even_if_dead = { trait = planetouched }
				has_tiefling_subtype = yes
			}
			remove_trait = creature_elf
			add_trait = creature_feyri
			remove_trait = planetouched
			set_graphical_culture = feyri
		}
		else_if = {
			limit = {
				trait = creature_drow
				trait = planetouched
				true_father_even_if_dead = { trait = planetouched }
				mother_even_if_dead = { trait = planetouched }
				has_tiefling_subtype = yes
			}
			remove_trait = creature_drow
			add_trait = creature_draegloth
			remove_trait = planetouched
			set_graphical_culture = draegloth
		}
		else_if = {
			limit = {
				trait = creature_human
				trait = feytouched
				true_father_even_if_dead = { trait = feytouched }
				mother_even_if_dead = { trait = feytouched }
			}
			remove_trait = creature_human
			remove_trait = feytouched
			add_trait = creature_spirit_folk
			set_graphical_culture = spiritfolk
		}
		else_if = {
			limit = {
				trait = creature_elf
				trait = feytouched
				true_father_even_if_dead = { trait = feytouched }
				mother_even_if_dead = { trait = feytouched }
				NOR = {
					graphical_culture = eladringfx
					graphical_culture = maraloigfx
					graphical_culture = shadarkaigfx
				}
			}
			set_graphical_culture = eladrin
		}
		else_if = {
			limit = {
				trait = creature_half_elf
				trait = feytouched
				true_father_even_if_dead = { trait = feytouched }
				mother_even_if_dead = { trait = feytouched }
				NOR = {
					graphical_culture = halfeladringfx
					graphical_culture = halfshadarkaigfx
					graphical_culture = maviddigfx
				}
			}
			set_graphical_culture = half_eladrin
		}

		#Werebeasts
		if = {
			limit = { # Only some creature types can be lycans
				is_lycanthrope_compatible = yes
			}
			if = {
				limit = {
					true_father_even_if_dead = { trait = werewolf }
					mother_even_if_dead = { trait = werewolf }
				}
				add_trait = werewolf
				add_trait = natural_lycanthrope
			}
			else_if = {
				limit = {
					OR = {
						AND = {
							true_father_even_if_dead = { trait = werewolf }
							mother_even_if_dead = { is_werebeast = no }
						}
						AND = {
							true_father_even_if_dead = { is_werebeast = no }
							mother_even_if_dead = { trait = werewolf }
						}
					}
				}
				random = {
					chance = 50
					add_trait = werewolf
					add_trait = natural_lycanthrope
				}
			}
			else_if = {
				limit = {
					true_father_even_if_dead = { trait = wererat }
					mother_even_if_dead = { trait = wererat }
				}
				add_trait = wererat
				add_trait = natural_lycanthrope
			}
			else_if = {
				limit = {
					OR = {
						AND = {
							true_father_even_if_dead = { trait = wererat }
							mother_even_if_dead = { is_werebeast = no }
						}
						AND = {
							true_father_even_if_dead = { is_werebeast = no }
							mother_even_if_dead = { trait = wererat }
						}
					}
				}
				random = {
					chance = 50
					add_trait = wererat
					add_trait = natural_lycanthrope
				}
			}
			else_if = {
				limit = {
					true_father_even_if_dead = { trait = weretiger }
					mother_even_if_dead = { trait = weretiger }
				}
				add_trait = weretiger
				add_trait = natural_lycanthrope
			}
			else_if = {
				limit = {
					OR = {
						AND = {
							true_father_even_if_dead = { trait = weretiger }
							mother_even_if_dead = { is_werebeast = no }
						}
						AND = {
							true_father_even_if_dead = { is_werebeast = no }
							mother_even_if_dead = { trait = weretiger }
						}
					}
				}
				random = {
					chance = 50
					add_trait = weretiger
					add_trait = natural_lycanthrope
				}
			}
			else_if = {
				limit = {
					true_father_even_if_dead = { trait = werecrocodile }
					mother_even_if_dead = { trait = werecrocodile }
				}
				add_trait = werecrocodile
				add_trait = natural_lycanthrope
			}
			else_if = {
				limit = {
					OR = {
						AND = {
							true_father_even_if_dead = { trait = werecrocodile }
							mother_even_if_dead = { is_werebeast = no }
						}
						AND = {
							true_father_even_if_dead = { is_werebeast = no }
							mother_even_if_dead = { trait = werecrocodile }
						}
					}
				}
				random = {
					chance = 50
					add_trait = werecrocodile
					add_trait = natural_lycanthrope
				}
			}
			else_if = {
				limit = {
					OR = {
						AND = {
							true_father_even_if_dead = { trait = werewolf }
							mother_even_if_dead = { trait = wererat }
						}
						AND = {
							true_father_even_if_dead = { trait = wererat }
							mother_even_if_dead = { trait = werewolf }
						}
					}
				}
				random_list = {
					1 = {
						add_trait = werewolf
					}
					1 = {
						add_trait = wererat
					}
				}
				add_trait = natural_lycanthrope
			}
			else_if = {
				limit = {
					OR = {
						AND = {
							true_father_even_if_dead = { trait = werewolf }
							mother_even_if_dead = { trait = weretiger }
						}
						AND = {
							true_father_even_if_dead = { trait = weretiger }
							mother_even_if_dead = { trait = werewolf }
						}
					}
				}
				random_list = {
					1 = {
						add_trait = werewolf
					}
					1 = {
						add_trait = weretiger
					}
				}
				add_trait = natural_lycanthrope
			}
			else_if = {
				limit = {
					OR = {
						AND = {
							true_father_even_if_dead = { trait = werewolf }
							mother_even_if_dead = { trait = werecrocodile }
						}
						AND = {
							true_father_even_if_dead = { trait = werecrocodile }
							mother_even_if_dead = { trait = werewolf }
						}
					}
				}
				random_list = {
					1 = {
						add_trait = werewolf
					}
					1 = {
						add_trait = werecrocodile
					}
				}
				add_trait = natural_lycanthrope
			}
			else_if = {
				limit = {
					OR = {
						AND = {
							true_father_even_if_dead = { trait = weretiger }
							mother_even_if_dead = { trait = wererat }
						}
						AND = {
							true_father_even_if_dead = { trait = wererat }
							mother_even_if_dead = { trait = weretiger }
						}
					}
				}
				random_list = {
					1 = {
						add_trait = weretiger
					}
					1 = {
						add_trait = wererat
					}
				}
				add_trait = natural_lycanthrope
			}
			else_if = {
				limit = {
					OR = {
						AND = {
							true_father_even_if_dead = { trait = werecrocodile }
							mother_even_if_dead = { trait = wererat }
						}
						AND = {
							true_father_even_if_dead = { trait = wererat }
							mother_even_if_dead = { trait = werecrocodile }
						}
					}
				}
				random_list = {
					1 = {
						add_trait = werecrocodile
					}
					1 = {
						add_trait = wererat
					}
				}
				add_trait = natural_lycanthrope
			}
			else_if = {
				limit = {
					OR = {
						AND = {
							true_father_even_if_dead = { trait = werecrocodile }
							mother_even_if_dead = { trait = weretiger }
						}
						AND = {
							true_father_even_if_dead = { trait = weretiger }
							mother_even_if_dead = { trait = werecrocodile }
						}
					}
				}
				random_list = {
					1 = {
						add_trait = werecrocodile
					}
					1 = {
						add_trait = weretiger
					}
				}
				add_trait = natural_lycanthrope
			}

			if = {
				limit = {
					trait = natural_lycanthrope
				}
				update_hidden_modifiers = yes
			}
		}

		# Horn inheritance
		if = {
			limit = {
				true_father_even_if_dead = { has_horns = yes }
				mother_even_if_dead = { has_horns = yes }
			}
			if = {
				limit = {
					has_horns = no
				}
				add_trait = horned
			}
		}
		else_if = {
			limit = {
				true_father_even_if_dead = { has_horns = no }
				mother_even_if_dead = { has_horns = no }
			}
			if = {
				limit = {
					has_horns = yes
				}
				add_trait = hornless
			}
		}
		else_if = {
			limit = {
				OR = {
					true_father_even_if_dead = { has_horns = yes }
					mother_even_if_dead = { has_horns = yes }
				}
			}
			if = {
				limit = {
					has_horns = no
				}
				if = {
					limit = {
						OR = {
							true_father_even_if_dead = {
								OR = {
									trait = creature_fiend
									trait = creature_dragonborn
									trait = creature_minotaur
									trait = creature_yikarian
									trait = creature_satyr
								}
							}
							mother_even_if_dead  = {
								OR = {
									trait = creature_fiend
									trait = creature_dragonborn
									trait = creature_minotaur
									trait = creature_yikarian
									trait = creature_satyr
								}
							}
						}
					}
					add_trait = horned
				}
				else = {
					random = {
						chance = 50
						add_trait = horned
					}
				}
			}
		}

		# Redundant trait cleanup
		if = {
			limit = {
				trait = feytouched
				race_is_fey = yes
			}
			remove_trait = feytouched
		}
		if = {
			limit = {
				OR = {
					race_is_planar = yes
					trait = half_celestial
					trait = half_fiend
				}
				trait = planetouched
			}
			remove_trait = planetouched
		}
		if = {
			limit = {
				trait = creature_troll
				trait = half_troll
			}
			remove_trait = half_troll
		}
		if = {
			limit = {
				OR = {
					trait = creature_angel
					trait = creature_aasimar
				}
				trait = half_celestial
			}
			remove_trait = half_celestial
		}
		if = {
			limit = {
				OR = {
					trait = creature_dragonborn
					trait = creature_dragon
				}
				trait = half_dragon
			}
			remove_trait = half_dragon
		}
		if = {
			limit = {
				trait = half_fiend
				trait = creature_fiend
			}
			remove_trait = half_fiend
		}

		# Set Genasi appearance from subtype.
		if = {
			limit = { trait = creature_genasi }
			set_genasi_subtype = yes
		}

		# Set dragon type.
		if = {
			limit = {
				graphical_culture = dragongfx
				culture_group = draconic_culture_group
			}
			gfx_culture_scope = {
				ROOT = { culture = PREV }
			}
		}
		else_if = {
			limit = {
				trait = creature_dragon
				NOT = { graphical_culture = dragongfx }
			}
			if = {
				limit = {
					culture_group = draconic_culture_group
				}
				set_graphical_culture = ROOT
			}
			else = {
				set_graphical_culture = red_dragon
			}
		}

		# Fix any undead graphics getting through.
		if = {
			limit = { has_undead_portrait = yes }
			if = {
				limit = { trait = creature_human }
				human_racial = yes
			}
			else = {
				set_graphical_culture = ROOT
			}
		}

		# Track anyone falling through.
		if = {
			limit = { faerun_any_race = no }
			log = "WARNING: Child [Root.GetFullName] did not get a race assigned!"
		}
	}
}

#Attempting to stop disallowed racial unions before birth
character_event = {
	id = racialbirth.2
	hide_window = yes
	is_triggered_only = yes #on_pregnancy

	trigger = {
		father_of_unborn = { always = yes } # not pregnant by a null character
		father_of_unborn = {
			ROOT = {
				is_genetically_compatible_with_PREV = no
			}
		}
	}

	immediate = {
		if = {
			limit = {
				father_of_unborn = {
					ai = yes
					is_alive = yes
				}
				ROOT = {
					ai = yes
					is_alive = yes
				}
			}
			if = {
				limit = {
					father_of_unborn = {
						any_spouse = {
							character = ROOT
						}
					}
				}
				ROOT = {
					save_event_target_as = target_wife
					if = {
						limit = {
							NOT = { is_ruler = yes }
							NOT = { is_married_matrilineally = yes }
						}
						banish = yes
					}
				}
				father_of_unborn = {
					remove_spouse = event_target:target_wife
					if = {
						limit = {
							NOT = { is_ruler = yes }
							is_married_matrilineally = yes
						}
						banish = yes
					}
				}
			}
			if = {
				limit = {
					father_of_unborn = {
						any_consort = {
							character = ROOT
						}
					}
				}
				ROOT = {
					save_event_target_as = target_female_consort
					if = {
						limit = {
							NOT = { is_ruler = yes }
							NOT = { is_senior_consort_party = yes }
						}
						banish = yes
					}
				}
				father_of_unborn = {
					remove_consort = event_target:target_female_consort
					if = {
						limit = {
							NOT = { is_ruler = yes }
							NOT = { is_senior_consort_party = yes }
						}
						banish = yes
					}
				}

			}
			if = {
				limit = {
					father_of_unborn = {
						is_consort = ROOT
					}
				}
				father_of_unborn = {
					save_event_target_as = target_male_consort
					if = {
						limit = {
							NOT = { is_ruler = yes }
							NOT = { is_senior_consort_party = yes }
						}
						banish = yes
					}
				}
				ROOT = {
					remove_consort = event_target:target_male_consort
					if = {
						limit = {
							NOT = { is_ruler = yes }
							NOT = { is_senior_consort_party = yes }
						}
						banish = yes
					}
				}

			}
			if = {
				limit = {
					father_of_unborn = {
						any_lover = {
							character = ROOT
						}
					}
				}
				ROOT = {
					save_event_target_as = target_lover
				}
				father_of_unborn = {
					remove_lover = event_target:target_lover
				}
			}
		}
	}
	after = {
		cancel_pregnancy = yes
	}
}
