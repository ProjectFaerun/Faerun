###################################
#
# THE OLD GODS
# - Defensive pagan events
#
###################################

# Written by Mathilda Bjarnehed & Milla Isaksson

namespace = TOG

###ANCESTOR WORSHIP DECISION EVENTS###

# Make a request
character_event = {
	id = TOG.7000
	desc = EVTDESC_TOG_7000
	border = GFX_event_normal_frame_religion
	picture = GFX_evt_tribal_shrine

	is_triggered_only = yes # ancestor_worship in minor_decisions.txt

	# Health
	option = {
		name = EVTOPTA_TOG_7000

		trigger = {
			OR = {
				is_ill = yes
				health < 4
				has_character_flag = developing_illness
			}
		}

		set_character_flag = ancestors_health

		ai_chance = {
			factor = 100

			mult_modifier = {
				factor = 2
				health < 3
			}

			mult_modifier = {
				factor = 2
				trait = paranoid
			}
		}
	}

	# Relationships - family, friends & love
	option = {
		name = EVTOPTB_TOG_7000

		trigger = {
			NOT = { trait = cruel }
		}

		set_character_flag = ancestors_relationships

		ai_chance = {
			factor = 33

			mult_modifier = {
				factor = 2
				trait = kind
			}

			mult_modifier = {
				factor = 2
				trait = gregarious
			}

			mult_modifier = {
				factor = 2
				trait = lustful
			}

			mult_modifier = {
				factor = 2
				trait = socializer
			}
		}
	}

	# War
	option = {
		name = EVTOPTC_TOG_7000

		trigger = {
			NOT = { trait = craven }
		}

		set_character_flag = ancestors_war

		ai_chance = {
			factor = 33

			mult_modifier = {
				factor = 2
				trait = brave
			}

			mult_modifier = {
				factor = 2
				is_strong_trigger = yes
			}

			mult_modifier = {
				factor = 2
				trait = ambitious
			}

			mult_modifier = {
				factor = 2
				trait = strategist
			}
		}
	}

	# Prosperity
	option = {
		name = EVTOPTD_TOG_7000

		trigger = {	is_nomadic = no }

		set_character_flag = ancestors_prosperity

		ai_chance = {
			factor = 33

			mult_modifier = {
				factor = 2
				trait = diligent
			}

			mult_modifier = {
				factor = 2
				trait = patient
			}

			mult_modifier = {
				factor = 2
				trait = content
			}

			mult_modifier = {
				factor = 2
				trait = gardener
			}
		}
	}

	# Wisdom
	option = {
		name = EVTOPTE_TOG_7000

		trigger = { is_dumb_trigger = no }

		set_character_flag = ancestors_wisdom

		ai_chance = {
			factor = 33

			mult_modifier = {
				factor = 2
				trait = erudite
			}

			mult_modifier = {
				factor = 2
				is_smart_trigger = yes
			}

			mult_modifier = {
				factor = 2
				trait = humble
			}

			mult_modifier = {
				factor = 2
				trait = scholar
			}
		}
	}

	after = {
		character_event = {
			id = TOG.7001
			days = 3
		}
	}
}

# Make a Sacrifice
character_event = {
	id = TOG.7001
	border = GFX_event_normal_frame_religion
	picture = GFX_evt_tribal_shrine

	desc = {
		text = EVTDESC_TOG_7001_health
		trigger = { has_character_flag = ancestors_health }
	}
	desc = {
		text = EVTDESC_TOG_7001_relationships
		trigger = { has_character_flag = ancestors_relationships }
	}
	desc = {
		text = EVTDESC_TOG_7001_war
		trigger = { has_character_flag = ancestors_war }
	}
	desc = {
		text = EVTDESC_TOG_7001_prosperity
		trigger = { has_character_flag = ancestors_prosperity }
	}
	desc = {
		text = EVTDESC_TOG_7001_wisdom
		trigger = { has_character_flag = ancestors_wisdom }
	}

	is_triggered_only = yes
	hide_from = yes

	immediate = {
		random_courtier = {
			limit = {
				prisoner = yes
				practical_age >= 12
				host = { character = ROOT }
			}

			save_event_target_as = human_sacrifice_prisoner
		}

		random_courtier = {
			limit = {
				practical_age >= 12
				is_unimportant_trigger = yes
				prisoner = no
				host = { character = ROOT }
			}

			save_event_target_as = human_sacrifice_courtier
		}
	}

	# Sacrifice limb
	option = {
		name = EVTOPTA_TOG_7001

		trigger = {
			# Can still sacrifice a body part
			trigger_if = {
				limit = { has_dlc = "Reapers" }

				NAND = {
					trait = one_handed
					trait = one_legged

					OR = {
						trait = one_eyed
						trait = blinded
					}
				}
			}
			trigger_else = {
				NOT = { trait = maimed }
			}
		}

		custom_tooltip = { text = EVTOPTA_TOG_7001_TOOLTIP }

		piety = 100

		set_character_flag = ancestors_limb

		# Shows the right body part in tooltip
		if = {
			limit = { has_dlc = "Reapers" }

			if = {
				limit = {
					NOR = {
						trait = one_legged
						race_is_legless = yes
					}
				}

				tooltip = {
					add_trait = one_legged
					add_severely_injured_effect = yes
				}

				set_character_flag = ancestors_leg
			}
			else_if = {
				limit = {
					NOR = {
						trait = one_handed
						race_is_handless = yes
					}
				}

				tooltip = {
					add_trait = one_handed
					add_severely_injured_effect = yes
				}

				set_character_flag = ancestors_hand
			}
			else = {
				limit = {
					NOR = {
						trait = one_eyed
						trait = blinded
						race_is_one_eyed = yes
					}
				}

				tooltip = {
					add_trait = one_eyed
					add_severely_injured_effect = yes
				}

				set_character_flag = ancestors_eye
			}
		}
		else = {
			tooltip = {
				add_trait = maimed
			}

			set_character_flag = ancestors_maimed
		}

		ai_chance = {
			factor = 300

			trigger = {
				OR = {
					trait = zealous
					trait = lunatic
					trait = possessed
				}
			}

			mult_modifier = {
				factor = 0.5

				OR = {
					trait = one_eyed
					trait = blinded
				}
			}

			mult_modifier = {
				factor = 0.5
				trait = one_handed
			}

			mult_modifier = {
				factor = 0.5
				trait = one_legged
			}

			mult_modifier = {
				factor = 0.01
				trait = severely_injured
			}

			mult_modifier = {
				factor = 0.01
				trait = maimed
			}
		}
	}

	# Sacrifice prisoner
	option = {
		name = EVTOPTB_TOG_7001

		trigger = {
			event_target:human_sacrifice_prisoner = { always = yes }
		}

		custom_tooltip = { text = EVTOPTB_TOG_7001_TOOLTIP }

		piety = 60

		set_character_flag = ancestors_human

		event_target:human_sacrifice_prisoner = {
			show_scope_change = no

			death = {
				death_reason = death_sacrificed_ancestors
				killer = ROOT
			}

			save_event_target_as = kinslayer_target
			save_event_target_as = portrait_target
		}

		add_kinslayer_trait_effect = yes

		ai_chance = {
			factor = 80

			mult_modifier = {
				factor = 2
				trait = cruel
			}

			mult_modifier = {
				factor = 2
				trait = arbitrary
			}
		}
	}

	# Sacrifice courtier
	option = {
		name = EVTOPTE_TOG_7001

		custom_tooltip = { text = EVTOPTE_TOG_7001_TOOLTIP }

		piety = 60

		trigger = {
			NOT = { event_target:human_sacrifice_prisoner = { always = yes } }
			event_target:human_sacrifice_courtier = { always = yes }
		}

		set_character_flag = ancestors_human

		event_target:human_sacrifice_courtier = {
			show_scope_change = no

			death = {
				death_reason = death_sacrificed_ancestors
				killer = ROOT
			}

			save_event_target_as = kinslayer_target
			save_event_target_as = portrait_target
		}

		add_kinslayer_trait_effect = yes

		ai_chance = {
			factor = 80

			mult_modifier = {
				factor = 2
				trait = cruel
			}

			mult_modifier = {
				factor = 2
				trait = arbitrary
			}
		}
	}

	# Great feast Sacrifice
	option = {
		name = EVTOPTC_TOG_7001

		custom_tooltip = { text = EVTOPTC_TOG_7001_TOOLTIP }

		piety = 40

		scaled_wealth = {
			value = -1
			min = -25
		}

		set_character_flag = ancestors_feast

		ai_chance = {
			factor = 10

			mult_modifier = {
				factor = 0.5
				NOT = { trait = greedy }
			}
		}
	}

	# Minor Sacrifice
	option = {
		name = EVTOPTD_TOG_7001

		custom_tooltip = { text = EVTOPTD_TOG_7001_TOOLTIP }

		piety = 10

		wealth = -5
		set_character_flag = ancestors_carving

		ai_chance = {
			factor = 10

			mult_modifier = {
				factor = 2
				trait = greedy
			}
		}
	}

	after = {
		character_event = {
			id = TOG.7002
			days = 3
		}
	}
}

# End of Sacrifice
character_event = {
	id = TOG.7002
	border = GFX_event_normal_frame_religion
	picture = GFX_evt_tribal_shrine
	portrait = event_target:portrait_target

	desc = {
		text = EVTDESC_TOG_7002_limb
		picture = GFX_evt_torture
		trigger = { has_character_flag = ancestors_limb }
	}
	desc = {
		text = EVTDESC_TOG_7002_human
		picture = GFX_evt_torture
		trigger = { has_character_flag = ancestors_human }
	}
	desc = {
		text = EVTDESC_TOG_7002_feast
		trigger = { has_character_flag = ancestors_feast }
	}
	desc = {
		text = EVTDESC_TOG_7002_carving
		trigger = { has_character_flag = ancestors_carving }
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTA_TOG_7002

		clr_character_flag = do_not_disturb

		# REMOVES LIMBS
		trigger_switch = {
			on_trigger = has_character_flag

			ancestors_eye    = { add_trait = one_eyed }
			ancestors_leg    = { add_trait = one_legged }
			ancestors_hand   = { add_trait = one_handed }
			ancestors_maimed = { add_trait = maimed }
		}

		if = {
			limit = {
				OR = {
					has_character_flag = ancestors_leg
					has_character_flag = ancestors_hand
					has_character_flag = ancestors_eye
				}
			}

			add_trait = severely_injured
			resolve_severely_injured_effect = yes
		}

		clr_character_flag = ancestors_leg
		clr_character_flag = ancestors_hand
		clr_character_flag = ancestors_eye
		clr_character_flag = ancestors_maimed

		# OUTCOMES
		hidden_effect = {
			# Health
			if = {
				limit = { has_character_flag = ancestors_health }

				# Limb
				if = {
					limit = { has_character_flag = ancestors_limb }

					hidden_effect = {
						random_list = {
							10 = {
								character_event = {
									id = TOG.7010 # Remove disease/blessing of health
									days = 30
								}
							}

							15 = {
								trigger = { is_strong_trigger = no }

								character_event = {
									id = TOG.7011 # Robust
									days = 300
								}
							}

							30 = {
								character_event = {
									id = TOG.7012 # Health bonus
									days = 200
								}
							}

							5 = {
								character_event = {
									id = TOG.7013 # Illness
									days = 150
								}
							}

							35 = { } # Nothing
						}
					}
				}

				# Human Sacrifice
				else_if = {
					limit = { has_character_flag = ancestors_human }

					hidden_effect = {
						random_list = {
							5 = {
								character_event = {
									id = TOG.7010 # Remove disease/blessing of health
									days = 30
								}
							}

							10 = {
								trigger = { is_strong_trigger = no }

								character_event = {
									id = TOG.7011 # Robust
									days = 300
								}
							}

							30 = {
								character_event = {
									id = TOG.7012 # Health bonus
									days = 200
								}
							}

							5 = {
								character_event = {
									id = TOG.7013 # Illness
									days = 150
								}
							}

							30 = { } # Nothing
						}
					}
				}

				# Big gift
				else_if = {
					limit = { has_character_flag = ancestors_feast }

					hidden_effect = {
						random_list = {
							1 = {
								character_event = {
									id = TOG.7010 # Remove disease/blessing of health
									days = 30
								}
							}

							1 = {
								trigger = { is_strong_trigger = no }

								character_event = {
									id = TOG.7011 # Robust
									days = 300
								}
							}

							50 = {
								character_event = {
									id = TOG.7012 # Health bonus
									days = 200
								}
							}

							10 = {
								character_event = {
									id = TOG.7013 # Illness
									days = 150
								}
							}

							50 = { } # Nothing
						}
					}
				}

				# Small gift
				else = {
					hidden_effect = {
						random_list = {
							1 = {
								character_event = {
									id = TOG.7010 # Remove disease/blessing of health
									days = 30
								}
							}

							1 = {
								trigger = { is_strong_trigger = no }

								character_event = {
									id = TOG.7011 # Robust
									days = 300
								}
							}

							15 = {
								character_event = {
									id = TOG.7012 # Health bonus
									days = 200
								}
							}

							15 = {
								character_event = {
									id = TOG.7013 # Illness
									days = 150
								}
							}

							20 = { } # Nothing
						}
					}
				}
			}

			# Relationships
			else_if = {
				limit = { has_character_flag = ancestors_relationships }

				clr_character_flag = ancestors_relationships

				# Limb
				if = {
					limit = { has_character_flag = ancestors_limb }

					random_list = {
						10 = { character_event = { id = TOG.7024 days = 350 } } # Good with people
						15 = { character_event = { id = TOG.7020 days = 100 } } # Lover
						15 = { character_event = { id = TOG.7021 days = 150 } } # Friend
						10 = { character_event = { id = TOG.7022 days = 300 } } # Diplomacy bonus
						10 = { character_event = { id = TOG.7025 days = 100 } } # Cat
						 5 = { character_event = { id = TOG.7023 days = 150 } } # Rival
						35 = { } #Nothing
					}
				}

				# Human Sacrifice
				else_if = {
					limit = { has_character_flag = ancestors_human }

					random_list = {
						 5 = { character_event = { id = TOG.7024 days = 350 } } # Good with people
						15 = { character_event = { id = TOG.7020 days = 100 } } # Lover
						15 = { character_event = { id = TOG.7021 days = 150 } } # Friend
						10 = { character_event = { id = TOG.7022 days = 300 } } # Diplomacy bonus
						10 = { character_event = { id = TOG.7025 days = 100 } } # Cat
						 5 = { character_event = { id = TOG.7023 days = 150 } } # Rival
						35 = { } # Nothing
					}
				}

				# Big gift
				else_if = {
					limit = { has_character_flag = ancestors_feast }

					random_list = {
						 1 = { character_event = { id = TOG.7024 days = 350 } } # Good with people
						15 = { character_event = { id = TOG.7020 days = 100 } } # Lover
						15 = { character_event = { id = TOG.7021 days = 150 } } # Friend
						20 = { character_event = { id = TOG.7022 days = 300 } } # Diplomacy bonus
						15 = { character_event = { id = TOG.7025 days = 100 } } # Cat
						10 = { character_event = { id = TOG.7023 days = 150 } } # Rival
						35 = { } # Nothing
					}
				}

				# Small gift
				else = {
					random_list = {
						 1 = { character_event = { id = TOG.7024 days = 300 } } # Good with people
						 5 = { character_event = { id = TOG.7020 days = 100 } } # Lover
						 5 = { character_event = { id = TOG.7021 days = 150 } } # Friend
						10 = { character_event = { id = TOG.7022 days = 300 } } # Diplomacy bonus
						20 = { character_event = { id = TOG.7025 days = 100 } } # Cat
						20 = { character_event = { id = TOG.7023 days = 150 } } # Rival
						35 = { } # Nothing
					}
				}
			}

			# War
			else_if = {
				limit = { has_character_flag = ancestors_war }

				clr_character_flag = ancestors_war

				# Limb
				if = {
					limit = { has_character_flag = ancestors_limb }

					random_list = {
						15 = { character_event = { id = TOG.7035 days = 150 } } # Increased levy
						25 = { character_event = { id = TOG.7034 days = 100 } } # War tech
						25 = { character_event = { id = TOG.7030 days = 100 } } # Commander
						15 = {
							trigger = { is_strong_trigger = no } # Robust
							character_event = { id = TOG.7011 days = 360 }
						}
						10 = {
							trigger = { can_have_more_leadership_traits = yes } # Leadership trait
							character_event = { id = TOG.7032 days = 360 }
						}
						 5 = { character_event = { id = TOG.7033 days = 100 } } # Maimed
						35 = { } # Nothing
					}
				}

				# Human Sacrifice
				else_if = {
					limit = { has_character_flag = ancestors_human }

					random_list = {
						10 = { character_event = { id = TOG.7035 days = 150 } } # Increased levy
						20 = { character_event = { id = TOG.7034 days = 100 } } # War tech
						20 = { character_event = { id = TOG.7030 days = 100 } } # Commander
						10 = {
							trigger = { is_strong_trigger = no } # Robust
							character_event = { id = TOG.7011 days = 360 }
						}
						10 = {
							trigger = { can_have_more_leadership_traits = yes } # Leadership trait
							character_event = { id = TOG.7032 days = 360 }
						}
						5 = { character_event = { id = TOG.7033 days = 100 } } # Maimed
						35 = { } # Nothing
					}
				}

				# Big gift
				else_if = {
					limit = { has_character_flag = ancestors_feast }

					random_list = {
						 5 = { character_event = { id = TOG.7035 days = 150 } } # Increased levy
						10 = { character_event = { id = TOG.7034 days = 100 } } # War tech
						10 = { character_event = { id = TOG.7030 days = 100 } } # Commander
						 5 = {
							trigger = { is_strong_trigger = no } # Robust
							character_event = { id = TOG.7011 days = 360 }
						}
						20 = {
							trigger = { can_have_more_leadership_traits = yes } # Leadership trait
							character_event = { id = TOG.7032 days = 360 }
						}
						10 = { character_event = { id = TOG.7033 days = 100 } } # Maimed
						35 = { } #Nothing
					}
				}

				# Small gift
				else = {
					random_list = {
						 1 = { character_event = { id = TOG.7035 days = 150 } } # Increased levy
						 5 = { character_event = { id = TOG.7034 days = 100 } } # War tech
						 5 = { character_event = { id = TOG.7030 days = 100 } } # Commander
						 5 = {
							trigger = { is_strong_trigger = no } # Robust
							character_event = { id = TOG.7011 days = 360 }
						}
						15 = {
							trigger = { can_have_more_leadership_traits = yes } # Leadership trait
							character_event = { id = TOG.7032 days = 360 }
						}
						15 = { character_event = { id = TOG.7033 days = 100 } } # Maimed
						35 = { } # Nothing
					}
				}
			}

			# Prosperity
			if = {
				limit = { has_character_flag = ancestors_prosperity }

				# Limb
				if = {
					limit = { has_character_flag = ancestors_limb }

					random_list = {
						10 = {
							if = {
								limit = {
									capital_scope = {
										OR = {
											has_province_modifier = depopulated_1
											has_province_modifier = depopulated_2
											has_province_modifier = depopulated_3
										}
									}
								}
								character_event = { id = TOG.7044 days = 500 } # Decrease depopulation level
							}
							else = {
								character_event = { id = TOG.7040 days = 500 } # Increase prosperity level
							}
						}
						15 = { character_event = { id = TOG.7041 days = 100 } } # Economy tech points
						10 = { character_event = { id = TOG.7042 days = 200 } } # Stewardship bonus
						 5 = { character_event = { id = TOG.7043 days = 300 } } # Less tax
						20 = { } # Nothing
					}
				}

				# Human Sacrifice
				else_if = {
					limit = { has_character_flag = ancestors_human }

					random_list = {
						 5 = {
							if = {
								limit = {
									capital_scope = {
										OR = {
											has_province_modifier = depopulated_1
											has_province_modifier = depopulated_2
											has_province_modifier = depopulated_3
										}
									}
								}
								character_event = { id = TOG.7044 days = 500 } # Decrease depopulation level
							}
							else = {
								character_event = { id = TOG.7040 days = 500 } # Increase prosperity level
							}
						}
						15 = { character_event = { id = TOG.7041 days = 100 } } # Economy tech points
						15 = { character_event = { id = TOG.7042 days = 200 } } # Stewardship bonus
						 5 = { character_event = { id = TOG.7043 days = 300 } } # Less tax
						35 = { } # Nothing
					}
				}

				# Big gift
				else_if = {
					limit = { has_character_flag = ancestors_feast }

					random_list = {
						 5 = {
							if = {
								limit = {
									capital_scope = {
										OR = {
											has_province_modifier = depopulated_1
											has_province_modifier = depopulated_2
											has_province_modifier = depopulated_3
										}
									}
								}
								character_event = { id = TOG.7044 days = 500 } # Decrease depopulation level
							}
							else = {
								character_event = { id = TOG.7040 days = 500 } # Increase prosperity level
							}
						}
						15 = { character_event = { id = TOG.7041 days = 100 } } # Economy tech points
						15 = { character_event = { id = TOG.7042 days = 200 } } # Stewardship bonus
						10 = { character_event = { id = TOG.7043 days = 300 } } # Less tax
						35 = { } # Nothing
					}
				}

				# Small gift
				else = {
					random_list = {
						 1 = {
							if = {
								limit = {
									capital_scope = {
										OR = {
											has_province_modifier = depopulated_1
											has_province_modifier = depopulated_2
											has_province_modifier = depopulated_3
										}
									}
								}
								character_event = { id = TOG.7044 days = 500 } # Decrease depopulation level
							}
							else = {
								character_event = { id = TOG.7040 days = 500 } # Increase prosperity level
							}
						}
						 5 = { character_event = { id = TOG.7041 days = 100 } } # Economy tech points
						10 = { character_event = { id = TOG.7042 days = 200 } } # Stewardship bonus
						10 = { character_event = { id = TOG.7043 days = 300 } } # Less tax
						20 = { } # Nothing
					}
				}
			}

			# Wisdom
			else = {
				# Limb
				if = {
					limit = { has_character_flag = ancestors_limb }

					random_list = {
						10 = {
							trigger = { is_smart_trigger = no } # Shrewd
							character_event = { id = TOG.7050 days = 400 }
						}
						15 = { character_event = { id = TOG.7051 days = 200 } } # Wise woman
						15 = { character_event = { id = TOG.7054 days = 300 } } # Owl
						 5 = { character_event = { id = TOG.7052 days = 300 } } # Learning bonus
						 3 = {
							trigger = { is_dumb_trigger = no } # Dull
							character_event = { id = TOG.7053 days = 200 }
						}
						20 = { } # Nothing
					}
				}

				# Human Sacrifice
				else_if = {
					limit = { has_character_flag = ancestors_human }

					random_list = {
						 5 = {
							trigger = { is_smart_trigger = no } # Shrewd
							character_event = { id = TOG.7050 days = 400 }
						}
						15 = { character_event = { id = TOG.7051 days = 200 } } # Wise woman
						15 = { character_event = { id = TOG.7054 days = 300 } } # Owl
						10 = { character_event = { id = TOG.7052 days = 300 } } # Learning bonus
						 5 = {
							trigger = { is_dumb_trigger = no } # Dull
							character_event = { id = TOG.7053 days = 200 }
						}
						35 = { } # Nothing
					}
				}

				# Big gift
				else_if = {
					limit = { has_character_flag = ancestors_feast }

					random_list = {
						 1 = {
							trigger = { is_smart_trigger = no } # Shrewd
							character_event = { id = TOG.7050 days = 400 }
						}
						15 = { character_event = { id = TOG.7051 days = 200 } } # Wise woman
						15 = { character_event = { id = TOG.7054 days = 300 } } # Owl
						20 = { character_event = { id = TOG.7052 days = 300 } } # Learning bonus
						10 = {
							trigger = { is_dumb_trigger = no } # Dull
							character_event = { id = TOG.7053 days = 200 }
						}
						35 = { } #Nothing
					}
				}

				# Small gift
				else = {
					random_list = {
						 1 = {
							trigger = { is_smart_trigger = no } # Shrewd
							character_event = { id = TOG.7050 days = 400 }
						}
						 5 = { character_event = { id = TOG.7051 days = 200 } } # Wise woman
						 5 = { character_event = { id = TOG.7054 days = 300 } } # Owl
						10 = { character_event = { id = TOG.7052 days = 300 } } # Learning bonus
						10 = {
							trigger = { is_dumb_trigger = no } # Dull
							character_event = { id = TOG.7053 days = 200 }
						}
						20 = { } # Nothing
					}
				}
			}
		}

		clr_character_flag = ancestors_health
		clr_character_flag = ancestors_relationships
		clr_character_flag = ancestors_war
		clr_character_flag = ancestors_prosperity
		clr_character_flag = ancestors_wisdom
		clr_character_flag = ancestors_limb
		clr_character_flag = ancestors_human
		clr_character_flag = ancestors_feast
		clr_character_flag = ancestors_carving
	}
}

# HEALTH OUTCOMES

# Get healed or blessing of health?
character_event = {
	id = TOG.7010

	is_triggered_only = yes
	hide_window = yes

	option = {
		if = {
			limit = { is_ill = yes }
			character_event = { id = TOG.7016 }
		}
		else = {
			character_event = { id = TOG.7014 }
		}
	}
}

# Blessing of health
character_event = {
	id = TOG.7014
	desc = EVTDESC_TOG_7014
	border = GFX_event_normal_frame_religion
	picture = GFX_evt_tribal_shrine

	is_triggered_only = yes

	option = {
		name = EVTOPTA_TOG_7014

		set_character_flag = old_gods_blessing

		add_character_modifier = {
			name = blessing_of_health
			duration = -1
		}
	}
}

# Blessing of health healing illness
character_event = {
	id = TOG.7015
	desc = EVTDESC_TOG_7015
	border = GFX_event_normal_frame_religion
	picture = GFX_evt_tribal_shrine

	is_triggered_only = yes

	trigger = { is_ill = yes }

	option = {
		name = EVTOPTA_TOG_7015

		remove_disease_trait_effect = yes
		remove_character_modifier = blessing_of_health
		add_trait_partially_silently_zealous_effect = yes
		clr_character_flag = old_gods_blessing
	}
}

# Healing illness
character_event = {
	id = TOG.7016
	desc = EVTDESC_TOG_7016
	border = GFX_event_normal_frame_religion
	picture = GFX_evt_tribal_shrine

	is_triggered_only = yes

	option = {
		name = EVTOPTA_TOG_7016

		remove_disease_trait_effect = yes
	}
}


# Robust
character_event = {
	id = TOG.7011
	desc = EVTDESC_TOG_7011
	border = GFX_event_normal_frame_religion
	picture = GFX_evt_tribal_shrine

	is_triggered_only = yes

	option = {
		name = EVTOPTA_TOG_7011

		if = {
			limit = { is_weak_congenital_trigger = yes }

			upgrade_strong_congenital_trait_effect = yes
		}

		if = {
			limit = { is_strong_non_congenital_trait_upgradeable_trigger = yes }

			upgrade_strong_non_congenital_trait_effect = yes
		}
	}
}

# Small health bonus
character_event = {
	id = TOG.7012
	desc = EVTDESC_TOG_7012
	border = GFX_event_normal_frame_religion
	picture = GFX_evt_tribal_shrine

	is_triggered_only = yes

	option = {
		name = EVTOPTA_TOG_7012

		add_character_modifier = {
			name = invigorated
			years = 10
		}
	}
}

# Illness
character_event = {
	id = TOG.7013
	desc = EVTDESC_TOG_7013
	picture = GFX_evt_doctor_tending_to_sick
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTA_TOG_7013

		character_event = {
			id = 6063 # base_health_events.txt
			days = 20
		}
	}
}

# RELATIONSHIPS

# Lover
character_event = {
	id = TOG.7020
	desc = EVTDESC_TOG_7020
	picture = GFX_evt_lovers
	border = GFX_event_normal_frame_diplomacy

	is_triggered_only = yes

	immediate = {
		# Targets male lover
		if = {
			limit = { prefers_men_trigger = yes }

			# Grabs random courtier
			if = {
				limit = {
					any_courtier = {
						is_female = no
						ai = yes
						block_general_event_trigger = no

						NOR = {
							is_lover = ROOT
							is_close_relative = ROOT
						}
					}
				}

				random_courtier = {
					limit = {
						is_female = no
						ai = yes
						block_general_event_trigger = no

						NOR = {
							is_lover = ROOT
							is_close_relative = ROOT
						}
					}

					save_event_target_as = ancestors_lover
					save_event_target_as = sex_partner
				}
			}

			# Or creates a new one
			else = {
				create_character = {
					female = no
					random_traits = yes
					dynasty = none
				}

				new_character = {
					save_event_target_as = ancestors_lover
					save_event_target_as = sex_partner
				}
			}
		}

		# Targets female lover
		else = {
			# Grabs random courtier
			if = {
				limit = {
					any_courtier = {
						is_female = yes
						ai = yes
						block_general_event_trigger = no

						NOR = {
							is_lover = ROOT
							is_close_relative = ROOT
						}
					}
				}

				random_courtier = {
					limit = {
						is_female = yes
						ai = yes
						block_general_event_trigger = no

						NOR = {
							is_lover = ROOT
							is_close_relative = ROOT
						}
					}

					save_event_target_as = ancestors_lover
					save_event_target_as = sex_partner
				}
			}

			# Or creates a new one
			else = {
				create_character = {
					female = yes
					random_traits = yes
					dynasty = none
				}

				new_character = {
					save_event_target_as = ancestors_lover
					save_event_target_as = sex_partner
				}
			}
		}
	}

	# Confess
	option = {
		name = EVTOPTA_TOG_7020

		event_target:ancestors_lover = {
			save_event_target_as = new_lover 
		}
		new_lover_effect = yes

		hidden_effect = {
			# Makes lover homosexual if both are same sex
			if = {
				limit = { same_sex = event_target:ancestors_lover }
				event_target:ancestors_lover = { add_trait = bisexual }
			}

			# Impregnate if of different sex
			else = {
				unprotected_sex_effect_event_target = yes
			}
		}
	}

	# Or don't
	option = {
		name = EVTOPTB_TOG_7020

		ai_chance = { factor = 0 }
	}
}

# Friend
character_event = {
	id = TOG.7021
	desc = EVTDESC_TOG_7021
	border = GFX_event_normal_frame_diplomacy
	picture = GFX_evt_feast

	is_triggered_only = yes

	immediate = {
		# Target a friend
		if = {
			limit = {
				any_courtier = {
					is_inaccessible_or_incapable_trigger = no

					NOR = {
						is_friend = ROOT
						is_rival = ROOT
						is_lover = ROOT
					}
				}
			}

			random_courtier = {
				limit = {
					is_inaccessible_or_incapable_trigger = no

					NOR = {
						is_friend = ROOT
						is_rival = ROOT
						is_lover = ROOT
					}
				}

				save_event_target_as = ancestors_friend
			}
		}

		# Or create new one
		else = {
			create_character = {
				random_traits = yes
				dynasty = random
			}

			new_character = {
				save_event_target_as = ancestors_friend
			}
		}
	}

	# Make friend
	option = {
		name = EVTOPTA_TOG_7021

		add_friend = event_target:ancestors_friend
	}

	option = {
		name = EVTOPTB_TOG_7021

		ai_chance = { factor = 0 }
	}
}

# Small diplomacy bonus
character_event = {
	id = TOG.7022
	desc = EVTDESC_TOG_7022
	border = GFX_event_normal_frame_diplomacy
	picture = GFX_evt_courtiers_talking

	is_triggered_only = yes

	option = {
		name = EVTOPTA_TOG_7022

		add_character_modifier = {
			name = good_listener
			years = 10
		}
	}
}

# Rival
character_event = {
	id = TOG.7023
	desc = EVTDESC_TOG_7023
	border = GFX_event_normal_frame_diplomacy
	picture = GFX_evt_tribal_shrine

	is_triggered_only = yes

	immediate = {
		# Target a rival
		if = {
			limit = {
				any_courtier = {
					is_inaccessible_or_incapable_trigger = no

					NOR = {
						is_friend = ROOT
						is_rival = ROOT
						is_lover = ROOT
					}
				}
			}

			random_courtier = {
				limit = {
					is_inaccessible_or_incapable_trigger = no

					NOR = {
						is_friend = ROOT
						is_rival = ROOT
						is_lover = ROOT
					}
				}

				save_event_target_as = ancestors_rival
			}
		}

		# Or create new one
		else = {
			create_character = {
				random_traits = yes
				dynasty = random
			}

			new_character = {
				save_event_target_as = ancestors_rival
			}
		}
	}

	option = {
		name = EVTOPTA_TOG_7023

		add_rival = event_target:ancestors_rival
	}
}

# Good with people
character_event = {
	id = TOG.7024
	desc = EVTDESC_TOG_7024
	border = GFX_event_normal_frame_diplomacy
	picture = GFX_evt_courtiers_talking

	is_triggered_only = yes

	option = {
		name = EVTOPTA_TOG_7024

		add_character_modifier = {
			name = respected_by_the_people
			duration = -1
		}
	}
}

# Get a cat
character_event = {
	id = TOG.7025
	desc = EVTDESC_TOG_7025
	picture = GFX_evt_cat
	border = GFX_event_normal_frame_diplomacy

	is_triggered_only = yes

	option = {
		name = EVTOPTA_TOG_7025

		add_cat_effect = yes
	}

	option = {
		name = EVTOPTB_TOG_7025

		add_character_modifier = {
			name = bad_person
			years = 1
		}

		ai_chance = { factor = 0 }
	}
}

# WAR

# Brilliant commander appears
character_event = {
	id = TOG.7030
	desc = EVTDESC_TOG_7030
	picture = GFX_evt_melee
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				OR = {
					has_law = status_of_women_3
					has_religion_feature = religion_matriarchal
					gender_equality_trigger = yes
				}
			}

			create_character = {
				female = yes
				age = 35
				random_traits = yes
				add_trait = strong
				add_trait = brave
				add_trait = brilliant_strategist
				add_trait = holy_warrior
			}

			new_character = {
				remove_trait = feeble
				remove_trait = weak
				remove_trait = craven
				remove_trait = imbecile
				remove_trait = slow
				remove_trait = dull
				save_event_target_as = ancestors_commander
			}
		}

		else = {
			create_character = {
				female = no
				age = 35
				random_traits = yes
				add_trait = strong
				add_trait = brave
				add_trait = brilliant_strategist
				add_trait = holy_warrior
			}

			new_character = {
				remove_trait = feeble
				remove_trait = weak
				remove_trait = craven
				remove_trait = imbecile
				remove_trait = slow
				remove_trait = dull
				save_event_target_as = ancestors_commander
			}
		}
	}

	option = {
		name = EVTOPTA_TOG_7030

		reverse_opinion = {
			name = opinion_loyal_servant
			who = event_target:ancestors_commander
			years = 100
		}
	}
}

# Robust is TOG.7011

# Random leadership trait
character_event = {
	id = TOG.7032
	desc = EVTDESC_TOG_7032
	border = GFX_event_normal_frame_war
	picture = GFX_evt_battle

	is_triggered_only = yes

	option = {
		name = EVTOPTA_TOG_7032

		random_list = {
			10 = {
				trigger = {
					NOT = { trait = light_foot_leader }
				}
				add_trait = light_foot_leader
			}

			10 = {
				trigger = {
					NOT = { trait = heavy_infantry_leader }
				}
				add_trait = heavy_infantry_leader
			}

			10 = {
				trigger = {
					NOT = { trait = cavalry_leader }
				}
				add_trait = cavalry_leader
			}

			10 = {
				trigger = {
					NOT = { trait = inspiring_leader }
				}
				add_trait = inspiring_leader
			}

			10 = {
				trigger = {
					NOT = { trait = defensive_leader }
				}
				add_trait = defensive_leader
			}

			10 = {
				trigger = {
					NOT = { trait = flanker }
				}
				add_trait = flanker
			}

			10 = {
				trigger = {
					NOT = { trait = siege_leader }
				}
				add_trait = siege_leader
			}
		}
	}
}

# Maimed while practising swordfighting
character_event = {
	id = TOG.7033
	desc = EVTDESC_TOG_7033
	border = GFX_event_normal_frame_war
	picture = GFX_evt_bloody_man

	is_triggered_only = yes

	option = {
		name = EVTOPTA_TOG_7033

		add_maimed_trait_effect = yes
	}
}

# War tech
character_event = {
	id = TOG.7034
	border = GFX_event_normal_frame_war
	picture = GFX_evt_large_army
	portrait = job_marshal

	desc = {
		text = EVTDESC_TOG_7034_A
		trigger = { job_marshal = { always = yes } }
	}
	desc = {
		text = EVTDESC_TOG_7034_B
		trigger = { NOT = { job_marshal = { always = yes } } }
	}

	is_triggered_only = yes
	hide_from = yes

	option = {
		name = EVTOPTA_TOG_7034

		military_techpoints = 100
		show_portrait = job_marshal
	}
}

# Levy reinforcement
character_event = {
	id = TOG.7035
	desc = EVTDESC_TOG_7035
	border = GFX_event_normal_frame_war
	picture = GFX_evt_large_army

	is_triggered_only = yes

	option = {
		name = EVTOPTA_TOG_7035

		capital_scope = {
			show_scope_change = no

			add_province_modifier = {
				name = inspired_warriors
				years = 10
			}
		}
	}
}

# PROSPERITY

# Increase prosperity level of capital
character_event = {
	id = TOG.7040
	desc = EVTDESC_TOG_7040
	picture = GFX_evt_tribal_lands
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes

	trigger = {
		capital_scope = {
			NOR = {
				has_province_modifier = depopulated_1
				has_province_modifier = depopulated_2
				has_province_modifier = depopulated_3
			}
		}
	}

	option = {
		name = EVTOPTA_TOG_7040

		if = {
			limit = {
				has_dlc = "Reapers"

				capital_scope = {
					NOT = { has_province_modifier = prosperity_modifier_3 }
				}
			}

			capital_scope = {
				show_scope_change = no

				increase_prosperity_effect = yes
			}
		}
		else = {
			scaled_wealth = {
				value = 1
				min = 50
			}
		}
	}
}

# Give economy tech
character_event = {
	id = TOG.7041
	picture = GFX_evt_council
	border = GFX_event_normal_frame_economy
	portrait = job_treasurer

	desc = {
		text = EVTDESC_TOG_7041_A
		trigger = { job_treasurer = { always = yes } }
	}
	desc = {
		text = EVTDESC_TOG_7041_B
		trigger = { NOT = { job_treasurer = { always = yes } } }
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTA_TOG_7041

		economy_techpoints = 100
	}
}

# Small stewardship bonus
character_event = {
	id = TOG.7042
	desc = EVTDESC_TOG_7042
	border = GFX_event_normal_frame_economy
	picture = GFX_evt_market

	is_triggered_only = yes

	option = {
		name = EVTOPTA_TOG_7042

		add_character_modifier = {
			name = bargainer
			years = 10
		}
	}
}

# Bad tax modifier
character_event = {
	id = TOG.7043
	desc = EVTDESC_TOG_7043
	border = GFX_event_normal_frame_economy
	picture = GFX_evt_tribal_shrine

	is_triggered_only = yes

	option = {
		name = EVTOPTA_TOG_7043

		add_character_modifier = {
			name = overtaxed_subjects
			years = 5
		}
	}
}

# Decrease depopulation
character_event = {
	id = TOG.7044
	desc = EVTDESC_TOG_7044
	border = GFX_event_normal_frame_economy
	picture = GFX_evt_tribal_lands

	is_triggered_only = yes

	trigger = {
		capital_scope = {
			OR = {
				has_province_modifier = depopulated_1
				has_province_modifier = depopulated_2
				has_province_modifier = depopulated_3
			}
		}
	}

	option = {
		name = EVTOPTA_TOG_7044

		capital_scope = {
			show_scope_change = no

			decrease_depopulation_effect = yes
		}
	}
}

# WISDOM

# Shrewd
character_event = {
	id = TOG.7050
	desc = EVTDESC_TOG_7050
	picture = GFX_evt_library
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTA_TOG_7050

		if = {
			limit = { is_smart_non_congenital_trait_upgradeable_trigger = yes }
			upgrade_smart_non_congenital_trait_effect = yes
		}
		else_if = {
			limit = { is_dumb_congenital_trigger = yes }
			upgrade_smart_congenital_trait_effect = yes
		}
	}
}

# Wise woman joins court
character_event = {
	id = TOG.7051
	desc = EVTDESC_TOG_7051
	picture = GFX_evt_tribal_shrine
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	immediate = {
		create_character = {
			religion = ROOT
			age = 32
			female = yes
			random_traits = yes
			dynasty = none
			add_trait = mystic
			add_trait = genius
			add_trait = mastermind_theologian
		}

		new_character = {
			remove_trait = dull
			remove_trait = imbecile
			save_event_target_as = ancestors_wise_woman
		}
	}

	option = {
		name = EVTOPTA_TOG_7051

		reverse_opinion = {
			name = opinion_loyal_servant
			who = event_target:ancestors_wise_woman
			years = 100
		}
	}
}

# Small learning bonus
character_event = {
	id = TOG.7052
	desc = EVTDESC_TOG_7052
	picture = GFX_evt_library
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTA_TOG_7052

		add_character_modifier = {
			name = new_insights
			years = 10
		}
	}
}

# Dull
character_event = {
	id = TOG.7053
	desc = EVTDESC_TOG_7053
	picture = GFX_evt_library
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTA_TOG_7053

		downgrade_smart_non_congenital_trait_effect = yes
	}
}

# Get an owl
character_event = {
	id = TOG.7054
	desc = EVTDESC_TOG_7054
	picture = GFX_evt_falconing
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTA_TOG_7054

		add_character_modifier = {
			name = pet_owl
			duration = -1
		}

		character_event = {
			id = 77800 # Owl dies
			days = 3500
			random = 2000
		}
	}

	option = {
		name = EVTOPTB_TOG_7054

		ai_chance = {
			factor = 0
		}
	}
}


###MAIN DEITY EVENTS### - removed for Faerun

