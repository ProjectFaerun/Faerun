############################################################
############# LEGENDARY BLOODLINES SHOWDOWN ################
############################################################

# clean_up_after_legendary_showdown_effect

# add_1_point_to_legendary_progress_effect
# add_2_points_to_legendary_progress_effect
# evaluate_legendary_progress_effect

# send_legendary_tombola_effect

# save_fellow_member_effect

# warrior_lodge_legendary_duel_someone_effect

# died_before_achieveing_greatness_effect
# died_founding_a_bloodline_effect

# found_a_legendary_bloodline_effect

# randomize_ABCDEF_desc_flag_effect
# clr_ABCDEF_desc_flag_effect
# randomize_XYZ_desc_flag_effect
# clr_XYZ_desc_flag_effect

# add_legend_progress_trivial_effect
# add_legend_progress_tiny_effect
# add_legend_progress_minor_effect
# add_legend_progress_medium_effect
# add_legend_progress_major_effect
# add_legend_progress_massive_effect

# send_new_eagle_event_effect
# send_new_dog_event_effect

# spawn_old_duelist_effect
# spawn_giant_duelist_effect
# spawn_creature_champion_effect

# set_bloodline_founder_religion_flag_effect

# murder_bloodline_check_effect

# Currently not in use, kept for future reference
# abort_legendary_bloodlines_events_effect = {
#	clear_delayed_event = { id = HF.12003 }
#	clear_delayed_event = { id = HF.12003 }
#	clear_delayed_event = { id = HF.12003 }
#	clear_delayed_event = { id = HF.12003 }
#	clear_delayed_event = { id = HF.12003 }
#	clear_delayed_event = { id = HF.12003 }
#	clean_up_after_legendary_showdown_effect = yes
# }
#
# restart_society_progress_effect = {
#	if = {
#		limit = {
#			any_society_member = {
#				has_character_flag = call_to_legend_active
#			}
#		}
#
#		set_society_progress = 0
#		clr_flag = block_society_progress	# So progress can resume for members...
#		clr_flag = used_legendary_gathering	# So progress can resume for members...
#	}
# }

# tsf4 note: leaving some of these, cleanslate doesn't have them... address later when updating events

clean_up_after_legendary_showdown_effect = {
	hidden_effect = {
		set_variable = {
			which = legendary_event_progress
			value = 0
		}

		remove_character_modifier = out_traveling
		clr_character_flag = call_to_legend_active
		clr_character_flag = do_not_disturb
		clr_character_flag = start_bracket
		clr_character_flag = mid_bracket
		clr_character_flag = top_bracket
		clr_character_flag = call_it_a_day
		clr_character_flag = i_will_survive
		clr_character_flag = bloodline_quality_1
		clr_character_flag = bloodline_quality_2
		clr_character_flag = bloodline_quality_3
		clr_character_flag = player_was_involved

		# Tombola events...
		clr_character_flag = HF_legend_artifact
		clr_character_flag = HF_legend_feast
		clr_character_flag = HF_legend_skull
		clr_character_flag = HF_legend_eagle
		clr_character_flag = HF_legend_upgrade_weapon

		# Duel outcomes...
		clr_character_flag = WL_desc_A
		clr_character_flag = WL_desc_B
		clr_character_flag = WL_desc_C
		clr_character_flag = WL_desc_D
		clr_character_flag = WL_desc_E
		clr_character_flag = WL_desc_F
		clr_character_flag = had_WL_desc_A
		clr_character_flag = had_WL_desc_B
		clr_character_flag = had_WL_desc_C
		clr_character_flag = had_WL_desc_D
		clr_character_flag = had_WL_desc_E
		clr_character_flag = had_WL_desc_F
		clr_character_flag = WL_desc_X
		clr_character_flag = WL_desc_Y
		clr_character_flag = WL_desc_Z
	}
}

add_1_point_to_legendary_progress_effect = {
	custom_tooltip = {
		text = good_progress_tt

		change_variable = {
			which = legendary_event_progress
			value = 1
		}
	}
}

add_2_points_to_legendary_progress_effect = {
	custom_tooltip = {
		text = great_progress_tt

		change_variable = {
			which = legendary_event_progress
			value = 2
		}
	}
}

evaluate_legendary_progress_effect = {
	if = { # You're just starting out...
		limit = {
			check_variable = {
				which = legendary_event_progress
				value < 5
			}
		}

		set_character_flag = start_bracket
	}
	else_if = { # You're making some progress
		limit = {
			check_variable = {
				which = legendary_event_progress
				value < 8
			}
		}

		clr_character_flag = start_bracket
		set_character_flag = mid_bracket
	}
	else_if = { # Get to dueling!
		limit = {
			check_variable = {
				which = legendary_event_progress
				value < 18
			}
		}

		clr_character_flag = start_bracket
		clr_character_flag = mid_bracket
		set_character_flag = top_bracket

		if = {
			limit = { # Stream linin' for player runs...
				has_character_flag = player_was_involved

				# Nepotism values
				check_variable = {
					which = legendary_event_progress
					value >= 10
				}
			}

			clr_character_flag = start_bracket
			clr_character_flag = mid_bracket
			clr_character_flag = top_bracket
			set_character_flag = call_it_a_day
		}
	}
	else_if = { # Consider yourself victorious, you champ
		limit = {
			check_variable = {
				which = legendary_event_progress
				value >= 18
			}
		}

		clr_character_flag = start_bracket
		clr_character_flag = mid_bracket
		clr_character_flag = top_bracket
		set_character_flag = call_it_a_day
	}

	# Fallback...
	else_if = { # If you have been lagging behind the rest of your team, bumps you into the top bracket...
		limit = {
			has_character_modifier = out_traveling

			OR = {
				has_character_flag = start_bracket
				has_character_flag = mid_bracket
			}
		}

		hidden_effect = {
			set_variable = {
				which = legendary_event_progress
				value = 8
			}

			clr_character_flag = start_bracket
			clr_character_flag = mid_bracket
			set_character_flag = top_bracket
		}
	}
}

send_legendary_tombola_effect = {
	character_event = {
		id = HF.12003 # Tombola...
		days = 10
		random = 15
	}
}

save_fellow_member_effect = {
	# Find someone to talk to...
	if = {
		limit = { event_target:original_hero = { is_available_hero_trigger = yes } }
		event_target:original_hero = { save_event_target_as = fellow_member }
	}
	else_if = {
		limit = { event_target:fellow_hero_1 = { is_available_hero_trigger = yes } }
		event_target:fellow_hero_1 = { save_event_target_as = fellow_member }
	}
	else_if = {
		limit = { event_target:fellow_hero_2 = { is_available_hero_trigger = yes } }
		event_target:fellow_hero_2 = { save_event_target_as = fellow_member }
	}
	else_if = {
		limit = { event_target:fellow_hero_3 = { is_available_hero_trigger = yes } }
		event_target:fellow_hero_3 = { save_event_target_as = fellow_member }
	}
	else = {
		society = {
			random_society_member = {
				limit = {
					NOT = { character = ROOT }
					is_inaccessible_or_incapable_trigger = no
				}

				save_event_target_as = fellow_member
			}
		}
	}
}

duel_someone_effect = {
	hidden_effect = {
		set_character_flag = add_duel_xp
		set_character_flag = is_legendary_duel
		reset_duel_timers_effect = yes

		# Chooses a weapon for mainly loc purposes (but has a tiny effect on outcomes, too)...
		set_dueling_weapon_effect = yes #You get a weapon!
		event_target:combatant_2 = { set_dueling_weapon_effect = yes } #and YOU get a weapon!

		# Chooses a body part for injury (if it occurs), also for loc purposes (effect handles both characters)
		set_potential_injury_flag_effect = yes

		# Scripted effect requiring event-targets combatant_1 & combatant_2! RAW NUMBERS...
		evaluate_duel_result_score_effect = yes

		# Room for extra special calculations... (based on traits, and other special circumstances?)
		evaluate_extra_duel_result_score_effect = yes

		# Send the correct result event (from random_list)...
		send_duel_result_event_effect = yes
	}
}

resolve_legendary_duel_effect = {
	if = {
		limit = { has_character_flag = is_legendary_duel }
		
		if = { #You died!
			limit = { is_dying = yes }
			if = {
				limit = { check_variable = { which = legendary_event_progress value = 15 } }
				set_character_flag = call_it_a_day
			}
			character_event = { id = HF.12003 } #Send tombola instantly, in case of death...
		}

		else = { #You are still standing...!
			evaluate_legendary_progress_effect = yes #evalutate status of progress flags, as usual...
			send_legendary_tombola_effect = yes
		}
	}
}

died_before_achieveing_greatness_effect = {
	# Send news of death to other heroes/society members
	current_heir = {
		character_event = {
			id = HF.12103 # Send event of what happened...
			days = 1
		}
	}

	society = {
		any_society_member = {
			limit = {
				NOR = {
					character = PREVPREV
					is_heir = PREVPREV
				}
			}

			character_event = {
				id = HF.12103 # Our fellow adventurer died (and achieved nothing)...
				days = 1
			}
		}
	}
}

died_founding_a_bloodline_effect = { # For the main heir
	# Send news of death to other heroes/society members?
	save_event_target_as = bloodline_founder
	found_a_legendary_bloodline_effect = yes

	if = {
		limit = { ai = no }

		# Adding flag to player and new player char, for safety...
		set_character_flag = achievement_zero_to_hero
		current_heir = { set_character_flag = achievement_zero_to_hero }

		if = {
			limit = { # In case of game over...
				current_heir = {
					NOT = { dynasty = PREV }
				}
			}

			set_global_flag = achievement_zero_to_hero
		}
	}

	current_heir = {
	#	save_event_target_as = new_story_owner

		narrative_event = {
			id = HF.12301 # Send event of what happened...
			days = 1
		}
	}

	society = {
		any_society_member = {
			limit = {
				NOR = {
					character = ROOT
					is_heir = PREVPREV
				}
			}

			narrative_event = {
				id = HF.12302 # News event to fellow society members...
				days = 3
			}
		}
	}
}

stop_slow_AIs_effect = {
	hidden_effect = {
		if = {
			limit = {
				is_in_society = yes
			}
			if = {
				limit = {
					any_society_member = {
						same_society_as = PREV
						ai = yes
						NOT = { character = PREV }
						OR = {
							has_character_flag = call_to_legend_active
							has_character_flag = completed_call_to_legend
						}
						NOT = { check_variable = { which = legendary_event_progress value = 8 } }
					}		
				}
				random_society_member = {
					limit = {	
						same_society_as = PREV
						ai = yes
						NOT = { character = PREV }
						OR = {
							has_character_flag = call_to_legend_active
							has_character_flag = completed_call_to_legend
						}
						NOT = { check_variable = { which = legendary_event_progress value = 8 } }
					}
					clean_up_after_legendary_showdown_effect = yes
				}
				random_society_member = {
					limit = {	
						same_society_as = PREV
						ai = yes
						NOT = { character = PREV }
						OR = {
							has_character_flag = call_to_legend_active
							has_character_flag = completed_call_to_legend
						}
						NOT = { check_variable = { which = legendary_event_progress value = 8 } }
					}
					clean_up_after_legendary_showdown_effect = yes
				}

				#if = {
				#	limit = { ai = no }
				#	character_event = { id = HF.12104 }
				#}
			}
			if = { # To make sure the progress bar properly resets.
				limit = {
					NOT = {
						any_society_member = {
							same_society_as = PREV
							ai = yes
							NOT = { character = PREV }
							has_character_flag = call_to_legend_active
						}		
					}
				}
				stop_society_progress = yes
			}
		}
	}
}

found_a_bloodline_effect = { #for alive hero
	if = {
		limit = {
			has_killed_at_least_1_trigger = yes
			has_killed_at_least_3_trigger = no
		}
		set_character_flag = bloodline_quality_1
	}
	else_if = {
		limit = {
			has_killed_at_least_3_trigger = yes
			has_killed_at_least_5_trigger = no
		}
		set_character_flag = bloodline_quality_2
	}
	else_if = {
		limit = {
			has_killed_at_least_5_trigger = yes
		}
		set_character_flag = bloodline_quality_3
	}
	save_event_target_as = bloodline_founder
	narrative_event = { id = HF.12300 days = 3 }
	clr_XYZ_desc_flag_effect = yes
}

found_a_legendary_bloodline_effect = { # For any hero
	custom_tooltip = {
		text = found_bloodline_tt

		ROOT = {
			society = {
				save_event_target_as = society_affiliation
			}
		}

		random_list = {
			10 = {
				trigger = {
					OR = {
						religion = tuigan_shamanism
						government = nomadic_tribal_government
					}

					has_character_modifier = pet_hunting_eagle
					has_character_modifier = friend_of_eagles
					trait = falconer
				}

				if = {
					limit = { is_female = yes }

					if = {
						limit = { 
							is_matriarchal_religion_or_culture = yes 
							is_patriarchal_religion_or_culture = no
						}

						create_bloodline = {
							type = legendary_eagle_hunter_female
							society = event_target:society_affiliation
						}
					}
					else = {
						create_bloodline = {
							type = legendary_eagle_hunter_female
							society = event_target:society_affiliation
							inheritance = all_descendants
						}
					}
				}
				else = {
					if = {
						limit = { 
							is_matriarchal_religion_or_culture = no 
							is_patriarchal_religion_or_culture = yes
						}

						create_bloodline = {
							type = legendary_eagle_hunter_male
							society = event_target:society_affiliation
						}
					}
					else = {
						create_bloodline = {
							type = legendary_eagle_hunter_male
							society = event_target:society_affiliation
							inheritance = all_descendants
						}
					}
				}

				new_bloodline = {
					set_description = bloodline_desc_legendary_eagle_hunter

					random_list = {
						# Randomize names
						20 = { set_name = bloodline_legendary_eagle_hunter_A }
						20 = { set_name = bloodline_legendary_eagle_hunter_B }
						20 = { set_name = bloodline_legendary_eagle_hunter_C }
						20 = { set_name = bloodline_legendary_eagle_hunter_D }
					}
					remove_adopted_bloodline_members_effect = yes
				}
			}

			10 = { # Way of Life exclusive
				trigger = { has_dlc = "Way of Life" }

				if = {
					limit = { is_female = yes }

					if = {
						limit = { 
							is_matriarchal_religion_or_culture = yes 
							is_patriarchal_religion_or_culture = no
						}

						create_bloodline = {
							type = legendary_dog_hunter_female
							society = event_target:society_affiliation
						}
					}
					else = {
						create_bloodline = {
							type = legendary_dog_hunter_female
							society = event_target:society_affiliation
							inheritance = all_descendants
						}
					}
				}
				else = {
					if = {
						limit = { 
							is_matriarchal_religion_or_culture = no 
							is_patriarchal_religion_or_culture = yes
						}

						create_bloodline = {
							type = legendary_dog_hunter_male
							society = event_target:society_affiliation
						}
					}
					else = {
						create_bloodline = {
							type = legendary_dog_hunter_male
							society = event_target:society_affiliation
							inheritance = all_descendants
						}
					}
				}

				new_bloodline = {
					set_description = bloodline_desc_legendary_dog_hunter

					random_list = {
						# Randomize names
						20 = { set_name = bloodline_legendary_dog_hunter_A }
						20 = { set_name = bloodline_legendary_dog_hunter_B }
						20 = { set_name = bloodline_legendary_dog_hunter_C }
						20 = { set_name = bloodline_legendary_dog_hunter_D }
					}
					remove_adopted_bloodline_members_effect = yes
				}
			}

			5 = { # Available to all
				if = {
					limit = { is_female = yes }

					if = {
						limit = { 
							is_matriarchal_religion_or_culture = yes 
							is_patriarchal_religion_or_culture = no
						}

						create_bloodline = {
							type = legendary_battle_survivor_female
							society = event_target:society_affiliation
						}
					}
					else = {
						create_bloodline = {
							type = legendary_battle_survivor_female
							society = event_target:society_affiliation
							inheritance = all_descendants
						}
					}
				}
				else = {
					if = {
						limit = { 
							is_matriarchal_religion_or_culture = no 
							is_patriarchal_religion_or_culture = yes
						}

						create_bloodline = {
							type = legendary_battle_survivor_male
							society = event_target:society_affiliation
						}
					}
					else = {
						create_bloodline = {
							type = legendary_battle_survivor_male
							society = event_target:society_affiliation
							inheritance = all_descendants
						}
					}
				}

				new_bloodline = {
					set_description = bloodline_desc_legendary_battle_survivor

					random_list = {
						# Randomize names
						20 = { set_name = bloodline_legendary_battle_survivor_A }
						20 = { set_name = bloodline_legendary_battle_survivor_B }
						20 = { set_name = bloodline_legendary_battle_survivor_C }
						20 = { set_name = bloodline_legendary_battle_survivor_D }
					}
					remove_adopted_bloodline_members_effect = yes
				}
			}

			5 = { # Conclave exclusive
				trigger = { has_dlc = "Conclave" }

				if = {
					limit = { is_female = yes }

					if = {
						limit = { 
							is_matriarchal_religion_or_culture = yes 
							is_patriarchal_religion_or_culture = no
						}

						create_bloodline = {
							type = legendary_leader_female
							society = event_target:society_affiliation
						}
					}
					else = {
						create_bloodline = {
							type = legendary_leader_female
							society = event_target:society_affiliation
							inheritance = all_descendants
						}
					}
				}
				else = {
					if = {
						limit = { 
							is_matriarchal_religion_or_culture = no 
							is_patriarchal_religion_or_culture = yes
						}

						create_bloodline = {
							type = legendary_leader_male
							society = event_target:society_affiliation
						}
					}
					else = {
						create_bloodline = {
							type = legendary_leader_male
							society = event_target:society_affiliation
							inheritance = all_descendants
						}
					}
				}

				new_bloodline = {
					set_description = bloodline_desc_legendary_leader

					random_list = {
						# Randomize names
						20 = { set_name = bloodline_legendary_leader_A }
						20 = { set_name = bloodline_legendary_leader_B }
						20 = { set_name = bloodline_legendary_leader_C }
						20 = { set_name = bloodline_legendary_leader_D }
					}
					remove_adopted_bloodline_members_effect = yes
				}
			}

			5 = { # Available to all
				if = {
					limit = { is_female = yes }

					if = {
						limit = { 
							is_matriarchal_religion_or_culture = yes 
							is_patriarchal_religion_or_culture = no
						}

						create_bloodline = {
							type = legendary_warrior_female
							society = event_target:society_affiliation
						}
					}
					else = {
						create_bloodline = {
							type = legendary_warrior_female
							society = event_target:society_affiliation
							inheritance = all_descendants
						}
					}
				}
				else = {
					if = {
						limit = { 
							is_matriarchal_religion_or_culture = no 
							is_patriarchal_religion_or_culture = yes
						}

						create_bloodline = {
							type = legendary_warrior_male
							society = event_target:society_affiliation
						}
					}
					else = {
						create_bloodline = {
							type = legendary_warrior_male
							society = event_target:society_affiliation
							inheritance = all_descendants
						}
					}
				}

				new_bloodline = {
					set_description = bloodline_desc_legendary_warrior

					random_list = {
						# Randomize names
						20 = { set_name = bloodline_legendary_warrior_A }
						20 = { set_name = bloodline_legendary_warrior_B }
						20 = { set_name = bloodline_legendary_warrior_C }
						20 = { set_name = bloodline_legendary_warrior_D }
					}
					remove_adopted_bloodline_members_effect = yes
				}
			}

			10 = { # Monks & Mystics/Jade Dragon exclusive
				trigger = {
					OR = {
						has_dlc = "Mystics"
						has_dlc = "Jade Dragon"
					}
				}

				if = {
					limit = { is_female = yes }

					if = {
						limit = { 
							is_matriarchal_religion_or_culture = yes 
							is_patriarchal_religion_or_culture = no
						}

						create_bloodline = {
							type = legendary_soldier_female
							society = event_target:society_affiliation
						}
					}
					else = {
						create_bloodline = {
							type = legendary_soldier_female
							society = event_target:society_affiliation
							inheritance = all_descendants
						}
					}
				}
				else = {
					if = {
						limit = { 
							is_matriarchal_religion_or_culture = no 
							is_patriarchal_religion_or_culture = yes
						}

						create_bloodline = {
							type = legendary_soldier_male
							society = event_target:society_affiliation
						}
					}
					else = {
						create_bloodline = {
							type = legendary_soldier_male
							society = event_target:society_affiliation
							inheritance = all_descendants
						}
					}
				}

				new_bloodline = {
					set_description = bloodline_desc_legendary_soldier

					random_list = {
						# Randomize names
						20 = { set_name = bloodline_legendary_soldier_A }
						20 = { set_name = bloodline_legendary_soldier_B }
						20 = { set_name = bloodline_legendary_soldier_C }
						20 = { set_name = bloodline_legendary_soldier_D }
					}
					remove_adopted_bloodline_members_effect = yes
				}
			}

			5 = { # Available to all
				if = {
					limit = { is_female = yes }

					if = {
						limit = { 
							is_matriarchal_religion_or_culture = yes 
							is_patriarchal_religion_or_culture = no
						}

						create_bloodline = {
							type = legendary_battle_bard_female
							society = event_target:society_affiliation
						}
					}
					else = {
						create_bloodline = {
							type = legendary_battle_bard_female
							society = event_target:society_affiliation
							inheritance = all_descendants
						}
					}
				}
				else = {
					if = {
						limit = { 
							is_matriarchal_religion_or_culture = no 
							is_patriarchal_religion_or_culture = yes
						}

						create_bloodline = {
							type = legendary_battle_bard_male
							society = event_target:society_affiliation
						}
					}
					else = {
						create_bloodline = {
							type = legendary_battle_bard_male
							society = event_target:society_affiliation
							inheritance = all_descendants
						}
					}
				}

				new_bloodline = {
					set_description = bloodline_desc_legendary_battle_bard

					random_list = {
						# Randomize names
						20 = { set_name = bloodline_legendary_battle_bard_A }
						20 = { set_name = bloodline_legendary_battle_bard_B }
						20 = { set_name = bloodline_legendary_battle_bard_C }
						20 = { set_name = bloodline_legendary_battle_bard_D }
					}
					remove_adopted_bloodline_members_effect = yes
				}
			}

			5 = { # Available to all
				if = {
					limit = { is_female = yes }

					if = {
						limit = { 
							is_matriarchal_religion_or_culture = yes 
							is_patriarchal_religion_or_culture = no
						}

						create_bloodline = {
							type = legendary_commander_female
							society = event_target:society_affiliation
						}
					}
					else = {
						create_bloodline = {
							type = legendary_commander_female
							society = event_target:society_affiliation
							inheritance = all_descendants
						}
					}
				}
				else = {
					if = {
						limit = { 
							is_matriarchal_religion_or_culture = no 
							is_patriarchal_religion_or_culture = yes
						}

						create_bloodline = {
							type = legendary_commander_male
							society = event_target:society_affiliation
						}
					}
					else = {
						create_bloodline = {
							type = legendary_commander_male
							society = event_target:society_affiliation
							inheritance = all_descendants
						}
					}
				}

				new_bloodline = {
					set_description = bloodline_desc_legendary_commander

					random_list = {
						# Randomize names
						20 = { set_name = bloodline_legendary_commander_A }
						20 = { set_name = bloodline_legendary_commander_B }
						20 = { set_name = bloodline_legendary_commander_C }
						20 = { set_name = bloodline_legendary_commander_D }
					}
					remove_adopted_bloodline_members_effect = yes
				}
			}

			5 = { # Available to all
				if = {
					limit = { is_female = yes }

					if = {
						limit = { 
							is_matriarchal_religion_or_culture = yes 
							is_patriarchal_religion_or_culture = no
						}

						create_bloodline = {
							type = legendary_captor_female
							society = event_target:society_affiliation
						}
					}
					else = {
						create_bloodline = {
							type = legendary_captor_female
							society = event_target:society_affiliation
							inheritance = all_descendants
						}
					}
				}
				else = {
					if = {
						limit = { 
							is_matriarchal_religion_or_culture = no 
							is_patriarchal_religion_or_culture = yes
						}

						create_bloodline = {
							type = legendary_captor_male
							society = event_target:society_affiliation
						}
					}
					else = {
						create_bloodline = {
							type = legendary_captor_male
							society = event_target:society_affiliation
							inheritance = all_descendants
						}
					}
				}

				new_bloodline = {
					set_description = bloodline_desc_legendary_captor

					random_list = {
						# Randomize names
						20 = { set_name = bloodline_legendary_captor_A }
						20 = { set_name = bloodline_legendary_captor_B }
						20 = { set_name = bloodline_legendary_captor_C }
						20 = { set_name = bloodline_legendary_captor_D }
					}
					remove_adopted_bloodline_members_effect = yes
				}
			}

			5 = { # Available to all
				if = {
					limit = { is_female = yes }

					if = {
						limit = { 
							is_matriarchal_religion_or_culture = yes 
							is_patriarchal_religion_or_culture = no
						}

						create_bloodline = {
							type = legendary_raider_female
							society = event_target:society_affiliation
						}
					}
					else = {
						create_bloodline = {
							type = legendary_raider_female
							society = event_target:society_affiliation
							inheritance = all_descendants
						}
					}
				}
				else = {
					if = {
						limit = { 
							is_matriarchal_religion_or_culture = no 
							is_patriarchal_religion_or_culture = yes
						}

						create_bloodline = {
							type = legendary_raider_male
							society = event_target:society_affiliation
						}
					}
					else = {
						create_bloodline = {
							type = legendary_raider_male
							society = event_target:society_affiliation
							inheritance = all_descendants
						}
					}
				}

				new_bloodline = {
					set_description = bloodline_desc_legendary_raider

					random_list = {
						# Randomize names
						20 = { set_name = bloodline_legendary_raider_A }
						20 = { set_name = bloodline_legendary_raider_B }
						20 = { set_name = bloodline_legendary_raider_C }
						20 = { set_name = bloodline_legendary_raider_D }
					}
					remove_adopted_bloodline_members_effect = yes
				}
			}
		}
	}
}

randomize_ABCDEF_desc_flag_effect = {
	clr_ABCDEF_desc_flag_effect = yes

	random_list = {
		20 = {
			trigger = { NOT = { has_character_flag = had_WL_desc_A } }
			set_character_flag = WL_desc_A
		}

		20 = {
			trigger = { NOT = { has_character_flag = had_WL_desc_B } }
			set_character_flag = WL_desc_B
		}

		20 = {
			trigger = { NOT = { has_character_flag = had_WL_desc_C } }
			set_character_flag = WL_desc_C
		}

		20 = {
			trigger = { NOT = { has_character_flag = had_WL_desc_D } }
			set_character_flag = WL_desc_D
		}

		20 = {
			trigger = { NOT = { has_character_flag = had_WL_desc_E } }
			set_character_flag = WL_desc_E
		}
	}
}

clr_ABCDEF_desc_flag_effect = {
	if = {
		limit = { has_character_flag = WL_desc_A }
		clr_character_flag = WL_desc_A
		set_character_flag = had_WL_desc_A
	}

	if = {
		limit = { has_character_flag = WL_desc_B }
		clr_character_flag = WL_desc_B
		set_character_flag = had_WL_desc_B
	}

	if = {
		limit = { has_character_flag = WL_desc_C }
		clr_character_flag = WL_desc_C
		set_character_flag = had_WL_desc_C
	}

	if = {
		limit = { has_character_flag = WL_desc_D }
		clr_character_flag = WL_desc_D
		set_character_flag = had_WL_desc_D
	}

	if = {
		limit = { has_character_flag = WL_desc_E }
		clr_character_flag = WL_desc_E
		set_character_flag = had_WL_desc_E
	}

	if = {
		limit = {
			has_character_flag = had_WL_desc_A
			has_character_flag = had_WL_desc_B
			has_character_flag = had_WL_desc_C
			has_character_flag = had_WL_desc_D
			has_character_flag = had_WL_desc_E
		}

		clr_character_flag = WL_desc_A
		clr_character_flag = WL_desc_B
		clr_character_flag = WL_desc_C
		clr_character_flag = WL_desc_D
		clr_character_flag = WL_desc_E
		clr_character_flag = had_WL_desc_A
		clr_character_flag = had_WL_desc_B
		clr_character_flag = had_WL_desc_C
		clr_character_flag = had_WL_desc_D
		clr_character_flag = had_WL_desc_E

	}
}

randomize_XYZ_desc_flag_effect = { # Can run twice. Then it messes up.
	clr_XYZ_desc_flag_effect = yes

	random_list = {
		10 = {
			trigger = { NOT = { has_character_flag = WL_desc_X } }

			set_character_flag = WL_desc_X

			if = {
				limit = { has_character_flag = WL_desc_Y }
				clr_character_flag = WL_desc_Y
			}

			if = {
				limit = { has_character_flag = WL_desc_Z }
				clr_character_flag = WL_desc_Z
			}
		}

		10 = {
			trigger = { NOT = { has_character_flag = WL_desc_Y } }

			set_character_flag = WL_desc_Y

			if = {
				limit = { has_character_flag = WL_desc_X }
				clr_character_flag = WL_desc_X
			}

			if = {
				limit = { has_character_flag = WL_desc_Z }
				clr_character_flag = WL_desc_Z
			}
		}

		10 = {
			trigger = { NOT = { has_character_flag = WL_desc_Z } }

			set_character_flag = WL_desc_Z

			if = {
				limit = { has_character_flag = WL_desc_X }
				clr_character_flag = WL_desc_X
			}

			if = {
				limit = { has_character_flag = WL_desc_Y }
				clr_character_flag = WL_desc_Y
			}
		}
	}
}

clr_XYZ_desc_flag_effect = {
	clr_character_flag = WL_desc_X
	clr_character_flag = WL_desc_Y
	clr_character_flag = WL_desc_Z
	clr_character_flag = WL_desc_A
	clr_character_flag = WL_desc_B
	clr_character_flag = WL_desc_C
	clr_character_flag = WL_desc_D
	clr_character_flag = WL_desc_E
	clr_character_flag = had_WL_desc_A
	clr_character_flag = had_WL_desc_B
	clr_character_flag = had_WL_desc_C
	clr_character_flag = had_WL_desc_D
	clr_character_flag = had_WL_desc_E
}

add_legend_progress_trivial_effect = {
	if = {
		limit = {
			society = {
				society_has_active_progress = yes			# A society-member has used the Legendary Gathering
				NOT = { has_flag = block_society_progress } # If legendary journey is not already on-going
			}
		}

		custom_tooltip = {
			text = society_legend_increases_tt
			add_society_progress = 1
		}
	}
}

add_legend_progress_tiny_effect = {
	if = {
		limit = {
			society = {
				society_has_active_progress = yes			# A society-member has used the Legendary Gathering
				NOT = { has_flag = block_society_progress } # If legendary journey is not already on-going
			}
		}

		custom_tooltip = {
			text = society_legend_increases_tt
			add_society_progress = 2
		}
	}
}

add_legend_progress_minor_effect = {
	if = {
		limit = {
			society = {
				society_has_active_progress = yes			# A society-member has used the Legendary Gathering
				NOT = { has_flag = block_society_progress } # If legendary journey is not already on-going
			}
		}

		custom_tooltip = {
			text = society_legend_increases_tt
			add_society_progress = 3
		}
	}
}

add_legend_progress_medium_effect = {
	if = {
		limit = { society_has_active_progress = no }
		start_society_progress = yes
	}

	add_society_progress = 4
}

add_legend_progress_major_effect = {
	if = {
		limit = { society_has_active_progress = no }
		start_society_progress = yes
	}

	add_society_progress = 5
}

add_legend_progress_massive_effect = {
	if = {
		limit = { society_has_active_progress = no }
		start_society_progress = yes
	}

	add_society_progress = 10
}

send_new_eagle_event_effect = {
	if = { # If you have a "Friend of Eagles" bloodline
		limit = {
			any_owned_bloodline = {
				has_bloodline_flag = bloodline_effect_pet_eagle
				bloodline_is_active_for = PREV
			}
		}

		character_event = {
			id = HF.12400 # Get a new bird!
			days = 65
			random = 55
		}
	}
}

send_new_dog_event_effect = {
	if = { # If you have a "Friend of Eagles" bloodline
		limit = {
			any_owned_bloodline = {
				has_bloodline_flag = bloodline_effect_pet_dog
				bloodline_is_active_for = PREV
			}
		}

		character_event = {
			id = HF.12401 # Get a new dog!
			days = 65
			random = 55
		}
	}
}

spawn_old_duelist_effect = {
	if = {
		limit = { has_religion_feature = religion_matriarchal }

		create_random_soldier = {
			random_traits = yes
			dynasty = none
			female = yes
			age = 60

			attributes = {
				diplomacy = 5
				learning = 1
				stewardship = 2
				intrigue = 9
				martial = 12
			}
		}
	}
	else = {
		create_random_soldier = {
			random_traits = yes
			dynasty = none
			female = 10
			age = 60

			attributes = {
				diplomacy = 5
				learning = 1
				stewardship = 2
				intrigue = 9
				martial = 12
			}
		}
	}

	new_character = {
		# No genetic defects
		remove_trait = weak
		remove_trait = slow
		remove_trait = imbecile
		remove_trait = dull
		remove_trait = dwarf
		remove_trait = giant
		remove_trait = hunchback
		remove_trait = clubfooted

		# Not a coward
		remove_trait = craven
		remove_trait = paranoid

		# Has a purely fighter lifestyle
		remove_trait = mystic
		remove_trait = socializer
		remove_trait = gamer
		remove_trait = hedonist
		remove_trait = duelist
		remove_trait = hunter
		remove_trait = strategist
		remove_trait = administrator
		remove_trait = architect
		remove_trait = gardener
		remove_trait = schemer
		remove_trait = impaler
		remove_trait = seducer
		remove_trait = seductress
		remove_trait = theologian
		remove_trait = scholar

		# Isn't incompetent
		remove_trait = misguided_warrior
		remove_trait = tough_soldier
		remove_trait = skilled_tactician

		add_trait = brilliant_strategist

		random_list = {
			20 = { add_trait = robust }
			10 = { add_trait = strong }
			 5 = { health = 2 }
		}
		
		random_list = {
			10 = { add_trait = narrow_flank_leader }
			10 = { add_trait = defensive_leader }
			10 = { add_trait = experimenter }
			10 = { add_trait = flanker }
			10 = { add_trait = heavy_infantry_leader }
			10 = { add_trait = inspiring_leader }
			10 = { add_trait = organizer }
			10 = { add_trait = siege_leader }
			10 = { add_trait = trickster }
			10 = { add_trait = aggressive_leader }
		}

		random_list = { # Flavor Randomization
			20 = {
				trigger = {
					has_dlc = "Reapers"
					race_is_one_eyed = no
				}
				add_trait = giant
				add_trait = robust
				add_trait = strategist
				add_trait = one_eyed
				change_martial = 1
				give_nickname = nick_the_cyclops
			}

			20 = {
				add_trait = holy_warrior
				add_trait = scarred
				change_martial = 3
				give_nickname = nick_the_hammer
			}

			20 = {
				add_trait = brave
				add_trait = poet
				change_martial = 2
				give_nickname = nick_the_fearless
			}

			20 = {
				add_trait = robust
				remove_trait = temperate
				add_trait = wroth
				add_trait = falconer
				change_martial = 1
				give_nickname = nick_the_ill_tempered
			}

			20 = {
				add_trait = unyielding_leader
				remove_trait = wroth
				add_trait = patient
				change_martial = 2
				give_nickname = nick_the_defender
			}

			20 = {
				add_trait = aggressive_leader
				remove_trait = patient
				add_trait = wroth
				change_martial = 3
				give_nickname = nick_the_destroyer
			}

			20 = {
				add_trait = shrewd
				add_trait = brave
				change_martial = 2
				give_nickname = nick_the_brave
			}

			20 = {
				add_trait = robust
				add_trait = strategist
				change_martial = 1
				give_nickname = nick_the_strong
			}

			20 = {
				add_trait = genius
				add_trait = socializer
				add_trait = poet
				change_martial = 4
				give_nickname = nick_the_noble
			}

			20 = {
				add_trait = blinded
				add_trait = strategist
				add_trait = genius
				change_martial = 4
				give_nickname = nick_the_blind
			}

			20 = {
				remove_trait = humble
				add_trait = proud
				add_trait = duelist
				change_martial = 2
				give_nickname = nick_the_proud
			}

			20 = {
				add_trait = hunter
				add_trait = shrewd
				change_martial = 3
				give_nickname = nick_the_hunter
			}

			20 = {
				trigger = { has_dlc = "Reapers" }

				add_trait = disfigured
				add_trait = scarred
				add_trait = genius
				change_martial = 2
				change_intrigue = 12
				give_nickname = nick_of_a_thousand_faces
			}

			20 = {
				add_trait = genius
				add_trait = clubfooted
				change_martial = 1
				give_nickname = nick_the_bear
			}

			20 = {
				add_trait = trusting
				add_trait = quick
				change_martial = 4
				give_nickname = nick_the_loyal
			}

			20 = {
				add_trait = ugly
				add_trait = strong
				add_trait = duelist
				change_martial = 1
				give_nickname = nick_the_boar
			}

			20 = {
				add_trait = fair
				add_trait = strategist
				change_martial = 4
				give_nickname = nick_the_lion
			}

			20 = {
				add_trait = brave
				add_trait = duelist
				change_martial = 3
				give_nickname = nick_the_bold
			}

			20 = {
				add_trait = shrewd
				add_trait = hedonist
				change_martial = 4
				give_nickname = nick_the_quarreller
			}

			20 = {
				add_trait = shrewd
				add_trait = cavalry_leader
				change_martial = 2
				give_nickname = nick_the_wolf
			}
		}

		if = {
			limit = {
				has_religion_feature = religion_no_leader
				religion_group = pagan_group
			}

			random_list = {
				 5 = { add_trait = pagan_branch_1 }
				25 = { add_trait = pagan_branch_2 }
				25 = { add_trait = pagan_branch_3 }
				25 = { add_trait = pagan_branch_4 }
			}
		}

		while = {
			count = 7
			add_one_duel_experience_modifier = yes
		}

		set_character_flag = invited_soldier
		save_event_target_as = invited_character
	}
}

spawn_giant_duelist_effect = {
	if = {
		limit = { has_religion_feature = religion_matriarchal }

		create_random_soldier = {
			random_traits = yes
			dynasty = none
			female = yes

			attributes = {
				diplomacy = 4
				learning = 1
				stewardship = 1
				intrigue = 1
				martial = 20
			}
		}
	}
	else = {
		create_random_soldier = {
			random_traits = yes
			dynasty = none
			female = 10

			attributes = {
				diplomacy = 4
				learning = 1
				stewardship = 1
				intrigue = 1
				martial = 20
			}
		}
	}

	new_character = {
		# No genetic defects
		remove_trait = weak
		remove_trait = slow
		remove_trait = imbecile
		remove_trait = dull
		remove_trait = dwarf
		remove_trait = giant
		remove_trait = hunchback
		remove_trait = clubfooted

		# Not a coward
		remove_trait = craven
		remove_trait = paranoid

		# Has a purely fighter lifestyle
		remove_trait = mystic
		remove_trait = socializer
		remove_trait = gamer
		remove_trait = hedonist
		remove_trait = duelist
		remove_trait = hunter
		remove_trait = strategist
		remove_trait = administrator
		remove_trait = architect
		remove_trait = gardener
		remove_trait = schemer
		remove_trait = impaler
		remove_trait = seducer
		remove_trait = seductress
		remove_trait = theologian
		remove_trait = scholar

		# Isn't incompetent
		remove_trait = misguided_warrior
		remove_trait = tough_soldier
		remove_trait = skilled_tactician

		add_trait = brilliant_strategist

		# Is a giant
		add_trait = giant
		health = 1

		random_list = {
			20 = { add_trait = robust }
			10 = { add_trait = strong }
		}

		random_list = {
			10 = { add_trait = narrow_flank_leader }
			10 = { add_trait = defensive_leader }
			10 = { add_trait = experimenter }
			10 = { add_trait = heavy_infantry_leader }
			10 = { add_trait = aggressive_leader }
		}

		random_list = { # Flavor Randomization
			20 = {
				add_trait = robust
				add_trait = hunter
				change_martial = 2
				give_nickname = nick_the_giant
			}

			20 = {
				trigger = {
					has_dlc = "Reapers"
					race_is_one_eyed = no
				}
				add_trait = robust
				add_trait = strategist
				add_trait = one_eyed
				change_martial = 1
				give_nickname = nick_the_giant
			}

			20 = {
				add_trait = giant
				add_trait = brave
				add_trait = poet
				change_martial = 2
				give_nickname = nick_the_giant
			}

			20 = {
				add_trait = robust
				remove_trait = temperate
				add_trait = wroth
				add_trait = falconer
				change_martial = 1
				give_nickname = nick_the_ill_tempered
			}

			20 = {
				remove_trait = wroth
				add_trait = patient
				change_martial = 2
				give_nickname = nick_the_monster
			}

			20 = {
				add_trait = aggressive_leader
				remove_trait = patient
				add_trait = wroth
				change_martial = 3
				give_nickname = nick_the_destroyer
			}

			20 = {
				add_trait = robust
				add_trait = shrewd
				change_martial = 1
				give_nickname = nick_the_tower
			}

			20 = {
				add_trait = genius
				add_trait = socializer
				add_trait = poet
				change_martial = 4
				give_nickname = nick_the_giant
			}

			20 = {
				add_trait = hunter
				add_trait = shrewd
				change_martial = 3
				give_nickname = nick_the_giant
			}

			20 = {
				trigger = { has_dlc = "Reapers" }

				add_trait = disfigured
				add_trait = scarred
				add_trait = genius
				add_trait = duelist
				change_martial = 2
				change_intrigue = 12
				give_nickname = nick_the_giant
			}

			20 = {
				add_trait = slow
				add_trait = duelist
				add_trait = clubfooted
				change_martial = 1
				give_nickname = nick_the_giant
			}

			20 = {
				add_trait = ugly
				add_trait = strong
				add_trait = duelist
				change_martial = 1
				give_nickname = nick_the_giant
			}

			20 = {
				add_trait = fair
				add_trait = strategist
				change_martial = 4
				give_nickname = nick_the_giant
			}

			20 = {
				add_trait = brave
				add_trait = duelist
				change_martial = 3
				give_nickname = nick_the_giant
			}

			20 = {
				add_trait = shrewd
				add_trait = hedonist
				change_martial = 4
				give_nickname = nick_the_giant
			}
		}

		if = {
			limit = {
				has_religion_feature = religion_no_leader
				religion_group = pagan_group
			}

			random_list = {
				 5 = { add_trait = pagan_branch_1 }
				25 = { add_trait = pagan_branch_2 }
				25 = { add_trait = pagan_branch_3 }
				25 = { add_trait = pagan_branch_4 }
			}
		}

		set_character_flag = invited_soldier
		save_event_target_as = invited_character
	}
}

spawn_creature_champion_effect = {
	if = {
		limit = { has_religion_feature = religion_matriarchal }

		create_random_soldier = {
			random_traits = yes
			culture = bear
			dynasty = none
			female = yes

			attributes = {
				diplomacy = 4
				learning = 4
				stewardship = 4
				intrigue = 4
				martial = 12
			}
		}
	}
	else = {
		create_random_soldier = {
			random_traits = yes
			culture = bear
			dynasty = none
			female = 20

			attributes = {
				diplomacy = 4
				learning = 4
				stewardship = 4
				intrigue = 4
				martial = 12
			}
		}
	}

	new_character = {
		set_graphical_culture = event_target:target_ruler

		# No genetic defects
		remove_trait = weak
		remove_trait = slow
		remove_trait = imbecile
		remove_trait = dull
		remove_trait = dwarf
		remove_trait = giant
		remove_trait = hunchback
		remove_trait = clubfooted

		# Not a coward
		remove_trait = craven
		remove_trait = paranoid

		# Has a purely fighter lifestyle
		remove_trait = mystic
		remove_trait = socializer
		remove_trait = gamer
		remove_trait = hedonist
		remove_trait = duelist
		remove_trait = hunter
		remove_trait = strategist
		remove_trait = administrator
		remove_trait = architect
		remove_trait = gardener
		remove_trait = schemer
		remove_trait = impaler
		remove_trait = seducer
		remove_trait = seductress
		remove_trait = theologian
		remove_trait = scholar

		# Isn't incompetent
		remove_trait = misguided_warrior
		remove_trait = tough_soldier
		remove_trait = skilled_tactician

		add_trait = brilliant_strategist

		# Powerful animal
		add_trait = robust
		add_trait = strong

		random_list = { # Give the Bear a pet, for fun
			10 = {
				add_character_modifier = {
					name = pet_hunting_dog
					duration = -1
				}

				character_event = {
					id = WoL.5290 # Dog dies
					years = 7
					random = 1000
				}
			}

			10 = {
				add_character_modifier = {
					name = pet_hunting_eagle
					duration = -1
				}

				character_event = {
					id = HF.25631 # Death
					years = 20
					random = 1500
				}
			}

			10 = {
				add_character_modifier = {
					name = pet_cat
					duration = -1
				}

				character_event = {
					id = 77802 # Cat dies
					years = 7
					random = 1000
				}
			}
		}

		random_list = {
			10 = { add_trait = narrow_flank_leader }
			10 = { add_trait = defensive_leader }
			10 = { add_trait = experimenter }
			10 = { add_trait = flanker }
			10 = { add_trait = heavy_infantry_leader }
			10 = { add_trait = inspiring_leader }
			10 = { add_trait = organizer }
			10 = { add_trait = siege_leader }
			10 = { add_trait = trickster }
			10 = { add_trait = aggressive_leader }
		}

		random_list = { # Flavor Randomization
			20 = {
				add_trait = giant
				add_trait = robust
				add_trait = hunter
				change_martial = 2
				give_nickname = nick_the_giant
			}

			20 = {
				trigger = {
					has_dlc = "Reapers"
					race_is_one_eyed = no
				}
				add_trait = giant
				add_trait = robust
				add_trait = strategist
				add_trait = one_eyed
				change_martial = 1
				give_nickname = nick_the_cyclops
			}

			20 = {
				add_trait = holy_warrior
				add_trait = scarred
				change_martial = 3
				give_nickname = nick_the_hammer
			}

			20 = {
				add_trait = charitable
				add_trait = poet
				change_martial = 2
				give_nickname = nick_the_generous
			}

			20 = {
				add_trait = robust
				remove_trait = temperate
				add_trait = wroth
				add_trait = falconer
				change_martial = 1
				give_nickname = nick_the_ill_tempered
			}

			20 = {
				add_trait = unyielding_leader
				remove_trait = wroth
				add_trait = patient
				change_martial = 2
				give_nickname = nick_the_defender
			}

			20 = {
				add_trait = aggressive_leader
				remove_trait = patient
				add_trait = wroth
				change_martial = 3
				give_nickname = nick_the_destroyer
			}

			20 = {
				add_trait = shrewd
				add_trait = brave
				change_martial = 2
				give_nickname = nick_the_brave
			}

			20 = {
				add_trait = robust
				add_trait = hunter
				add_trait = gregarious
				change_martial = 1
				give_nickname = nick_the_jolly
			}

			20 = {
				add_trait = genius
				add_trait = socializer
				add_trait = poet
				change_martial = 4
				give_nickname = nick_the_noble
			}

			20 = {
				add_trait = zealous
				add_trait = duelist
				add_trait = genius
				change_martial = 4
				give_nickname = nick_the_witch_hunter
			}

			20 = {
				remove_trait = humble
				add_trait = proud
				add_trait = duelist
				change_martial = 2
				give_nickname = nick_the_proud
			}

			20 = {
				add_trait = hunter
				add_trait = shrewd
				change_martial = 3
				give_nickname = nick_the_hunter
			}

			20 = {
				trigger = { has_dlc = "Reapers" }

				add_trait = disfigured
				add_trait = scarred
				add_trait = genius
				change_martial = 2
				change_intrigue = 12
				give_nickname = nick_of_a_thousand_faces
			}

			20 = {
				add_trait = genius
				add_trait = clubfooted
				change_martial = 1
				give_nickname = nick_the_bear
			}

			20 = {
				add_trait = trusting
				add_trait = quick
				change_martial = 4
				give_nickname = nick_the_loyal
			}

			20 = {
				add_trait = ugly
				add_trait = strong
				add_trait = duelist
				change_martial = 1
				give_nickname = nick_the_boar
			}

			20 = {
				add_trait = fair
				add_trait = strategist
				change_martial = 4
				give_nickname = nick_the_lion
			}

			20 = {
				add_trait = brave
				add_trait = duelist
				change_martial = 3
				give_nickname = nick_the_dragon
			}

			20 = {
				add_trait = shrewd
				add_trait = hedonist
				change_martial = 4
				give_nickname = nick_the_quarreller
			}

			20 = {
				add_trait = shrewd
				add_trait = cavalry_leader
				change_martial = 2
				give_nickname = nick_the_wolf
			}
		}

		if = {
			limit = {
				has_religion_feature = religion_no_leader
				religion_group = pagan_group
			}

			random_list = {
				 5 = { add_trait = pagan_branch_1 }
				25 = { add_trait = pagan_branch_2 }
				25 = { add_trait = pagan_branch_3 }
				25 = { add_trait = pagan_branch_4 }
			}
		}

		set_character_flag = invited_soldier
		save_event_target_as = invited_character
	}
}

#### For creating bloodlines in general ####
#### If your bloodline requires a specific religion, one which should *not change* if the founder changes religion, this needs to be set.
#### IMPORTANT: If religions are added: add new religion checks in new else-if limits and in the religion_same_as_bloodline_founder_trigger scripted trigger.
set_bloodline_founder_religion_flag_effect = {
	if = {
		limit = {
			OR = {
				religion = jaziri
				religion = jaziri_reformed
			}
		}
		new_bloodline = { set_bloodline_flag = requires_jaziri_religion }
	}
	else_if = {
		limit = {
			OR = {
				religion = yuir
				religion = yuir_reformed
			}
		}
		new_bloodline = { set_bloodline_flag = requires_yuir_religion }
	}
	else_if = {
		limit = {
			#OR = {
				religion = toteteohuan
			#	religion = toteteohuan_reformed
			#}
		}
		new_bloodline = { set_bloodline_flag = requires_toteteohuan_religion }
	}
	else_if = {
		limit = {
			OR = {
				religion = nogari
				religion = nogari_reformed
			}
		}
		new_bloodline = { set_bloodline_flag = requires_nogari_religion }
	}
	else_if = {
		limit = {
			OR = {
				religion = earthmother
				religion = earthmother_reformed
			}
		}
		new_bloodline = { set_bloodline_flag = requires_earthmother_religion }
	}
	else_if = {
		limit = {
			OR = {
				religion = ulutiuan
				religion = ulutiuan_reformed
			}
		}
		new_bloodline = { set_bloodline_flag = requires_ulutiuan_religion }
	}
	else_if = {
		limit = {
			religion = ubtao_worship
		}
		new_bloodline = { set_bloodline_flag = requires_ubtao_religion }
	}
	else_if = {
		limit = {
			OR = {
				religion = orc_pantheon
				religion = orc_reformed
			}
		}
		new_bloodline = { set_bloodline_flag = requires_orc_religion }
	}
	else_if = {
		limit = {
			OR = {
				religion = goblin_pantheon
				religion = goblin_reformed
			}
		}
		new_bloodline = { set_bloodline_flag = requires_goblin_religion }
	}		
	else_if = {
		limit = { religion = triadic }
		new_bloodline = { set_bloodline_flag = requires_triadic_religion }
	}
	else_if = {
		limit = { religion = arcane }
		new_bloodline = { set_bloodline_flag = requires_arcane_religion }
	}
	else_if = {
		limit = { religion = rasallesian }
		new_bloodline = { set_bloodline_flag = requires_rasallesian_religion }
	}
	else_if = {
		limit = { religion = chessic }
		new_bloodline = { set_bloodline_flag = requires_chessic_religion }
	}
	else_if = {
		limit = { religion = mercantile }
		new_bloodline = { set_bloodline_flag = requires_mercantile_religion }
	}
	else_if = {
		limit = { religion = inventive }
		new_bloodline = { set_bloodline_flag = requires_inventive_religion }
	}
	else_if = {
		limit = { religion = joyful }
		new_bloodline = { set_bloodline_flag = requires_joyful_religion }
	}
	else_if = {
		limit = { religion = calishite_faith }
		new_bloodline = { set_bloodline_flag = requires_calishite_faith_religion }
	}
	else_if = {
		limit = { religion = lapal_faith }
		new_bloodline = { set_bloodline_flag = requires_lapal_religion }
	}
	else_if = {
		limit = { religion = chauntean_faith }
		new_bloodline = { set_bloodline_flag = requires_chauntean_faith_religion }
	}
	else_if = {
		limit = { religion = mulhorandi_faith }
		new_bloodline = { set_bloodline_flag = requires_mulhorandi_faith_religion }
	}
	else_if = {
		limit = { religion = untheric_faith }
		new_bloodline = { set_bloodline_flag = requires_untheric_faith_religion }
	}
	else_if = {
		limit = { religion = enlil }
		new_bloodline = { set_bloodline_flag = requires_enlil_religion }
	}	
	else_if = {
		limit = { religion = halfling_pantheon }
		new_bloodline = { set_bloodline_flag = requires_halfling_pantheon_religion }
	}
	else_if = {
		limit = { religion = solar }
		new_bloodline = { set_bloodline_flag = requires_solar_religion }
	}
	else_if = {
		limit = { religion = deities_of_fury }
		new_bloodline = { set_bloodline_flag = requires_deities_of_fury_religion }
	}
	else_if = {
		limit = { religion = natural }
		new_bloodline = { set_bloodline_flag = requires_natural_religion }
	}
	else_if = {
		limit = { religion = kossuth }
		new_bloodline = { set_bloodline_flag = requires_kossuth_religion }
	}
	else_if = {
		limit = { religion = geomancy }
		new_bloodline = { set_bloodline_flag = requires_geomancy_religion }
	}
	else_if = {
		limit = { religion = primordial }
		new_bloodline = { set_bloodline_flag = requires_primordial_religion }
	}
	else_if = {
		limit = { religion = tuigan_shamanism }
		new_bloodline = { set_bloodline_flag = requires_tuigan_shamanism_religion }
	}
	else_if = {
		limit = { religion = uthgardt_faith }
		new_bloodline = { set_bloodline_flag = requires_uthgardt_faith_religion }
	}
	else_if = {
		limit = { religion = martial_faith }
		new_bloodline = { set_bloodline_flag = requires_martial_faith_religion }
	}
	else_if = {
		limit = { religion = dead_three }
		new_bloodline = { set_bloodline_flag = requires_dead_three_religion }
	}
	else_if = {
		limit = { religion = shadow_gods }
		new_bloodline = { set_bloodline_flag = requires_shadow_gods_religion }
	}
	else_if = {
		limit = { religion = ghaunadaur }
		new_bloodline = { set_bloodline_flag = requires_ghaunadaur_religion }
	}
	else_if = {
		limit = { religion = loviatar }
		new_bloodline = { set_bloodline_flag = requires_loviatar_religion }
	}
	else_if = {
		limit = { religion = church_of_cyric }
		new_bloodline = { set_bloodline_flag = requires_church_of_cyric_religion }
	}
	else_if = {
		limit = { religion = abyssal_cult }
		new_bloodline = { set_bloodline_flag = requires_abyssal_cult_religion }
	}
	else_if = {
		limit = { religion = infernal }
		new_bloodline = { set_bloodline_flag = requires_infernal_religion }
	}
	else_if = {
		limit = { religion = scale_cult }
		new_bloodline = { set_bloodline_flag = requires_scale_cult_religion }
	}
	else_if = {
		limit = { religion = thasmudyanic }
		new_bloodline = { set_bloodline_flag = requires_thasmudyanic_religion }
	}
	else_if = {
		limit = { religion = ten_thousand_gods }
		new_bloodline = { set_bloodline_flag = requires_ten_thousand_gods_religion }
	}
	else_if = {
		limit = { religion = qisma }
		new_bloodline = { set_bloodline_flag = requires_qisma_religion }
	}
	else_if = {
		limit = { religion = pantheist_league }
		new_bloodline = { set_bloodline_flag = requires_pantheist_league_religion }
	}
	else_if = {
		limit = { religion = muhjari }
		new_bloodline = { set_bloodline_flag = requires_muhjari_religion }
	}
	else_if = {
		limit = { religion = kahin }
		new_bloodline = { set_bloodline_flag = requires_kahin_religion }
	}
	else_if = {
		limit = { religion = padhran }
		new_bloodline = { set_bloodline_flag = requires_padhran_religion }
	}
	else_if = {
		limit = { religion = the_path }
		new_bloodline = { set_bloodline_flag = requires_the_path_religion }
	}
	else_if = {
		limit = { religion = chung_tao }
		new_bloodline = { set_bloodline_flag = requires_chung_tao_religion }
	}
	else_if = {
		limit = { religion = nine_travelers }
		new_bloodline = { set_bloodline_flag = requires_nine_travelers_religion }
	}
	else_if = {
		limit = { religion = adama }
		new_bloodline = { set_bloodline_flag = requires_adama_religion }
	}
	else_if = {
		limit = { religion = elven_pantheon }
		new_bloodline = { set_bloodline_flag = requires_elven_pantheon_religion }
	}
	else_if = {
		limit = { religion = asathalfinare }
		new_bloodline = { set_bloodline_flag = requires_asathalfinare_religion }
	}
	else_if = {
		limit = { religion = sylvan }
		new_bloodline = { set_bloodline_flag = requires_sylvan_religion }
	}
	else_if = {
		limit = { religion = eilistraee }
		new_bloodline = { set_bloodline_flag = requires_eilistraee_religion }
	}
	else_if = {
		limit = { religion = lolth_cult }
		new_bloodline = { set_bloodline_flag = requires_lolth_cult_religion }
	}
	else_if = {
		limit = { religion = kiaransalee }
		new_bloodline = { set_bloodline_flag = requires_kiaransalee_religion }
	}
	else_if = {
		limit = { religion = vhaeraun }
		new_bloodline = { set_bloodline_flag = requires_vhaeraun_religion }
	}
	else_if = {
		limit = { religion = dwarven_pantheon }
		new_bloodline = { set_bloodline_flag = requires_dwarven_pantheon_religion }
	}
	else_if = {
		limit = { religion = laduguer }
		new_bloodline = { set_bloodline_flag = requires_laduguer_religion }
	}
	else_if = {
		limit = { religion = gnome_pantheon }
		new_bloodline = { set_bloodline_flag = requires_gnome_pantheon_religion }
	}
	else_if = {
		limit = { religion = urdlen }
		new_bloodline = { set_bloodline_flag = requires_urdlen_religion }
	}
	else_if = {
		limit = { religion = giant_pantheon }
		new_bloodline = { set_bloodline_flag = requires_giant_pantheon_religion }
	}
	else_if = {
		limit = { religion = vaprak }
		new_bloodline = { set_bloodline_flag = requires_vaprak_religion }
	}
	else_if = {
		limit = { religion = karontor }
		new_bloodline = { set_bloodline_flag = requires_karontor_religion }
	}
	else_if = {
		limit = { religion = draconic_pantheon }
		new_bloodline = { set_bloodline_flag = requires_draconic_pantheon_religion }
	}
	else_if = {
		limit = { religion = bahamut }
		new_bloodline = { set_bloodline_flag = requires_bahamut_religion }
	}
	else_if = {
		limit = { religion = tiamat }
		new_bloodline = { set_bloodline_flag = requires_tiamat_religion }
	}
	else_if = {
		limit = { religion = faithless }
		new_bloodline = { set_bloodline_flag = requires_faithless_religion }
	}
	else_if = {
		limit = { religion = entropy }
		new_bloodline = { set_bloodline_flag = requires_entropy_religion }
	}
	else_if = {
		limit = { religion = blue_flame }
		new_bloodline = { set_bloodline_flag = requires_blue_flame_religion }
	}
	else_if = {
		limit = { religion = ancestral_cult }
		new_bloodline = { set_bloodline_flag = requires_ancestral_cult_religion }
	}
	else_if = {
		limit = { religion = qukoku }
		new_bloodline = { set_bloodline_flag = requires_qukoku_religion }
	}	
	else_if = {
		limit = { religion = beholder_pantheon }
		new_bloodline = { set_bloodline_flag = requires_beholder_pantheon_religion }
	}
	else_if = {
		limit = { religion = illithid_pantheon }
		new_bloodline = { set_bloodline_flag = requires_illithid_pantheon_religion }
	}
	else_if = {
		limit = { religion = faceless_god }
		new_bloodline = { set_bloodline_flag = requires_faceless_god_religion }
	}
	# else = {
		# # Add new religions in new else-if limits.
	# }
}

murder_bloodline_check_effect = {
	change_variable = {
		which = bloodline_murdered_people
		value = 1
	}

	if = {
		limit = { has_ambition = obj_forge_bloodline }

		if = { # First check for pure Murder Bloodline
			limit = {
				check_variable = {
					which = bloodline_murdered_people
					value >= 30
				}
			}

			set_character_flag = flag_about_to_murder_bloodline

			character_event = {
				id = HF.24025
				days = 25
				random = 25
			}
		}
		else_if = { # Then check for Murder War Hybrid
			limit = {
				check_variable = {
					which = bloodline_murdered_people
					value >= 20
				}

				check_variable = {
					which = bloodline_won_wars
					value >= 10
				}
			}

			set_character_flag = flag_about_to_murder_bloodline

			narrative_event = {
				id = HF.24045
				days = 25
				random = 25
			}
		}
		else_if = { # Then check for Murder Peace Hybrid
			limit = {
				check_variable = {
					which = bloodline_murdered_people
					value >= 20
				}

				check_variable = {
					which = bloodline_peaceful_years
					value >= 15
				}
			}

			set_character_flag = flag_about_to_murder_bloodline

			narrative_event = {
				id = HF.24046
				days = 25
				random = 25
			}
		}
		else_if = { # Then check for Murder Builder Hybrid
			limit = {
				check_variable = {
					which = bloodline_murdered_people
					value >= 20
				}

				check_variable = {
					which = bloodline_built_holdings
					value >= 15
				}
			}

			set_character_flag = flag_about_to_murder_bloodline

			narrative_event = {
				id = HF.24048
				days = 25
				random = 25
			}
		}
	}
}