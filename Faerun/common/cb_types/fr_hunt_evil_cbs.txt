# overthrow_evil_ruler
# smite_evil_cb
# bahamut_dragonfall
# purge_beholder_cb
# tyr_apprehend_criminal

overthrow_evil_ruler = {
	name = CB_NAME_OVERTHROW_EVIL_RULER
	war_name = WAR_OVERTHROW_EVIL_RULER
	sprite = 33
	truce_days = 900
	sort_priority = 500

	is_holy_war = yes
	is_permanent = yes
	can_ask_to_join_war = yes
	allowed_to_target_tributaries = no
	apply_short_occ_mod = no # Do not apply the 'recently_conquered' modifier to Holdings

	can_use_gui = {
		ROOT = {
			show_scope_change = no
			piety >= 250
			war_cost = yes
		}
	}

	can_use = {
		FROM = {
			OR = {
				has_character_modifier = true_villain_modifier
				has_character_modifier = undead_realm_lord

				trigger_if = {
					limit = { has_character_modifier = fr_nomad_conquerer_modifier }
					NOT = { ROOT = { government = nomadic_tribal_government } }
				}

				trigger_if = {
					limit = { has_character_modifier = known_satanist }
					ROOT = {
						NOR = {
							secret_religion = infernal
							has_character_modifier = known_satanist
							has_character_modifier = syncretic_infernal
						}
					}
				}
			}
		}

		ROOT = {
			is_evil_religion = no

			NOR = {
				religion = triadic
				religion = bahamut
				has_character_modifier = syncretic_triadic
				has_character_modifier = syncretic_bahamut
				mercenary = yes
				trait = creature_monster
			}
		}
	}

	can_use_title = {
		FROM = {
			any_realm_title = {
				location = {
					any_neighbor_province = { # have a border
						trigger_if = {
							limit = { has_owner = yes }

							owner = {
								OR = {
									character = ROOT
									is_vassal_or_below_of = ROOT
								}
							}
						}
						trigger_else = {
							is_land = no # first sea zone

							any_neighbor_province = {
								trigger_if = {
									limit = { has_owner = yes }

									owner = {
										OR = {
											character = ROOT
											is_vassal_or_below_of = ROOT
										}
									}
								}
								trigger_else = {
									is_land = no # second sea zone

									any_neighbor_province = {
										owner = {
											OR = {
												character = ROOT
												is_vassal_or_below_of = ROOT
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}

	is_valid = {
		FROM = {
			is_landed = yes
			OR = {
				is_evil_religion = yes
				has_character_modifier = true_villain_modifier
				has_character_modifier = undead_realm_lord
				has_character_modifier = fr_nomad_conquerer_modifier
				has_character_modifier = known_satanist
			}
		}
	}

	on_add = {
		attacker = {
			show_scope_change = no
			piety = -250
			declare_war_effect = yes
		}
	}

	on_success = {
		attacker = {
			show_scope_change = no

			participation_scaled_piety = 100
			participation_scaled_prestige = 100
			attacker_victory_effect = yes

			add_rival = FROM

			if = {
				limit = { uses_decadence = yes }
				participation_scaled_decadence = -10
			}

			religion_authority = {
				modifier = won_holy_war
				years = 20
			}

			hidden_effect = {
				if = {
					limit = { has_ambition = obj_strengthen_religion }
					change_variable = {
						which = strengthen_religion
						value = 1
					}
				}
			}
		}

		any_attacker = {
			limit = { NOT = { character = attacker } }

			hidden_effect = {
				participation_scaled_piety = 100
				participation_scaled_prestige = 100

				if = {
					limit = { uses_decadence = yes }
					participation_scaled_decadence = -10
				}
				if = {
					limit = { has_ambition = obj_strengthen_religion }
					change_variable = {
						which = strengthen_religion
						value = 1
					}
				}
			}
		}

		defender = {
			show_scope_change = no

			prestige = -500
			imprison = ROOT

			if = { # lower crown authority
				limit = { NOT = { has_dlc = "Conclave" } }

				any_demesne_title = {
					limit = { is_crown_law_title = yes }

					trigger_switch = {
						on_trigger = has_law

						crown_authority_1 = { add_law = crown_authority_0 }
						crown_authority_2 = { add_law = crown_authority_0 }
						crown_authority_3 = { add_law = crown_authority_1 }
						crown_authority_4 = { add_law = crown_authority_2 }
					}
				}
			}
			else = {
				any_demesne_title = { # All titles
					limit = {
						OR = {
							tier = DUKE
							tier = KING
							tier = EMPEROR
						}
						NOT = { has_law = revoke_title_law_0 }
					}

					trigger_switch = {
						on_trigger = has_law

						revoke_title_law_1 = { add_law = revoke_title_law_0 }
						revoke_title_law_2 = { add_law = revoke_title_law_0 }
					}
				}
			}

			custom_tooltip = {
				text = abdicates_to_new_ruler_tooltip
				capital_scope = {
					county = { save_event_target_as = depose_evil_ruler_capital }
				}

				random_realm_character = {
					preferred_limit = {
						is_heir = defender
						independent = no
						is_evil_religion = no
						defender = { NOT = { has_dynasty_flag = evil_once_punished } }
					}
					preferred_limit = {
						is_child_of = defender
						independent = no
						is_evil_religion = no
						defender = { NOT = { has_dynasty_flag = evil_once_punished } }
					}
					preferred_limit = {
						dynasty = FROM
						is_close_relative = defender
						independent = no
						NOT = { is_married = defender }
						olrox_is_good_religion_trigger = yes
						defender = { NOT = { has_dynasty_flag = evil_once_punished } }
					}
					preferred_limit = {
						dynasty = FROM
						is_close_relative = defender
						independent = no
						NOT = { is_married = defender }
						is_evil_religion = no
						defender = { NOT = { has_dynasty_flag = evil_once_punished } }
					}
					preferred_limit = {
						vassal_of = FROM
						is_powerful_vassal = yes
						is_incapable = no
						is_adult = yes
						olrox_is_good_religion_trigger = yes
					}
					preferred_limit = {
						is_vassal_or_below_of = defender
						is_powerful_vassal = yes
						is_incapable = no
						is_adult = yes
						olrox_is_good_religion_trigger = yes
					}
					preferred_limit = {
						vassal_of = FROM
						is_powerful_vassal = yes
						is_incapable = no
						is_adult = yes
						is_evil_religion = no
					}
					preferred_limit = {
						is_vassal_or_below_of = defender
						is_powerful_vassal = yes
						is_incapable = no
						is_adult = yes
						is_evil_religion = no
					}
					preferred_limit = {
						vassal_of = FROM
						is_incapable = no
						is_adult = yes
						olrox_is_good_religion_trigger = yes
					}
					preferred_limit = {
						is_vassal_or_below_of = defender
						is_incapable = no
						is_adult = yes
						olrox_is_good_religion_trigger = yes
					}
					preferred_limit = {
						vassal_of = FROM
						is_incapable = no
						is_adult = yes
						is_evil_religion = no
					}
					preferred_limit = {
						is_vassal_or_below_of = defender
						is_incapable = no
						is_adult = yes
						is_evil_religion = no
					}
					preferred_limit = {
						is_ruler = no
						is_heir = no
						is_adult = yes
						is_incapable = no
						is_evil_religion = no
					}
					save_event_target_as = depose_evil_heir
				}

				if = {
					limit = {
						OR = {
							has_character_modifier = undead_realm_lord
							has_character_modifier = fr_nomad_conquerer_modifier
							event_target:depose_evil_heir = {
								is_evil_religion = yes
							}
						}
					}
					random_demesne_title = {
						limit = { tier = COUNT }

						location = {
							create_character = {
								religion = ROOT
								culture = THIS
								dynasty = random
								random_traits = yes
								female = 50
								age = 20
								health = 7
								fertility = 0.7
								attributes = {
									martial = 10
									diplomacy = 10
									stewardship = 10
								}
								flag = is_religious_liberation_ruler
							}
							new_character = {
								remove_trait = cynical
								add_trait = zealous
								set_character_flag = ai_flag_refuse_conversion
								wealth = 500
								prestige = 500
								piety = 500
								save_event_target_as = new_ruler
							}
						}
					}

					any_demesne_title = {
						event_target:new_ruler = {
							usurp_title = {
								target = PREV
								type = invasion
							}
						}
					}

					attacker = {
						opinion = {
							modifier = in_non_aggression_pact
							who = event_target:new_ruler
							years = 10
							origin_description = EVTTITLE_overthrow_evil_ruler
						}
					}

					event_target:new_ruler = {
						opinion = {
							modifier = in_non_aggression_pact
							who = attacker
							years = 10
							origin_description = EVTTITLE_overthrow_evil_ruler
						}

						if = {
							limit = {
								is_female = yes
								NOR = {
									trait = homosexual
									trait = asexual
								}
							}
							location = {
								create_character = {
									religion = event_target:new_ruler
									culture = event_target:new_ruler
									dynasty = none
									random_traits = yes
									female = no
									age = 20
									health = 7
									fertility = 0.7
									flag = is_religious_liberation_ruler
								}
								new_character = {
									remove_trait = cynical
									add_trait = zealous
									add_spouse_matrilineal = event_target:new_ruler
									add_lover = event_target:new_ruler
								}
							}
						}
						else_if = {
							limit = {
								is_female = no
								NOR = {
									trait = homosexual
									trait = asexual
								}
							}
							location = {
								create_character = {
									religion = event_target:new_ruler
									culture = event_target:new_ruler
									dynasty = none
									random_traits = yes
									female = yes
									age = 20
									health = 7
									fertility = 0.7
									flag = is_religious_liberation_ruler
								}
								new_character = {
									remove_trait = cynical
									add_trait = zealous
									add_spouse = event_target:new_ruler
									add_lover = event_target:new_ruler
								}
							}
						}
						else_if = {
							limit = {
								is_female = yes
								trait = homosexual
							}
							location = {
								create_character = {
									religion = event_target:new_ruler
									culture = event_target:new_ruler
									dynasty = none
									random_traits = yes
									female = yes
									age = 20
									health = 7
									fertility = 0.7
									flag = is_religious_liberation_ruler
								}
								new_character = {
									remove_trait = cynical
									add_trait = zealous
									add_spouse_matrilineal = event_target:new_ruler
									add_lover = event_target:new_ruler
								}
							}
						}
						else_if = {
							limit = {
								is_female = no
								trait = homosexual
							}
							location = {
								create_character = {
									religion = event_target:new_ruler
									culture = event_target:new_ruler
									dynasty = none
									random_traits = yes
									female = no
									age = 20
									health = 7
									fertility = 0.7
									flag = is_religious_liberation_ruler
								}
								new_character = {
									remove_trait = cynical
									add_trait = zealous
									add_spouse = event_target:new_ruler
									add_lover = event_target:new_ruler
								}
							}
						}

						capital_holding = {
							refill_holding_levy = yes
						}
					}
				}

				else = {
					if = {
						limit = {
							event_target:depose_evil_heir = {
								NOT = { dynasty = FROM }
								higher_tier_than = COUNT
							}
						}
						gain_title_plus_barony_if_unlanded = {
							target = event_target:depose_evil_ruler_capital
							type = invasion
						}
					}
					abdicate_to = event_target:depose_evil_heir
				}

				set_dynasty_flag = evil_once_punished
			}
		}
	}

	on_fail = {
		attacker = {
			show_scope_change = no

			prestige = -100
			piety = -100
			add_rival = defender
		}

		defender = {
			show_scope_change = no

			participation_scaled_prestige = 50
			participation_scaled_piety = 50
		}

		any_defender = {
			limit = { NOT = { character = defender } }
			hidden_effect = {
				participation_scaled_piety = 50
				participation_scaled_prestige = 50
			}
		}
	}

	on_reverse_demand = {
		attacker = {
			show_scope_change = no

			prestige = -200
			piety = -200
			transfer_scaled_wealth = {
				to = defender
				value = 4.0
			}
			add_rival = defender
		}

		defender = {
			show_scope_change = no

			participation_scaled_prestige = 100
			participation_scaled_piety = 100
			defender_victory_effect = yes

			if = {
				limit = { uses_decadence = yes }
				participation_scaled_decadence = -10
			}

			religion_authority = {
				name = won_holy_war
				years = 20
			}

			hidden_effect = {
				if = {
					limit = { has_ambition = obj_strengthen_religion }

					change_variable = {
						which = strengthen_religion
						value = 1
					}
				}
			}
		}

		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_effect = {
				participation_scaled_piety = 100
				participation_scaled_prestige = 100

				if = {
					limit = { uses_decadence = yes }
					participation_scaled_decadence = -10
				}

				if = {
					limit = { has_ambition = obj_strengthen_religion }

					change_variable = {
						which = strengthen_religion
						value = 1
					}
				}
			}
		}
	}

	on_defender_leader_death = {
		any_attacker = {
			letter_event = { id = 251 } # Our enemy has died, the war has ended
		}

		end_war = invalid
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}

	attacker_ai_defeat_worth = {
		factor = 100
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}

	defender_ai_defeat_worth = {
		factor = 100
	}

	ai_will_do = {
		factor = 0.5 # Low prio CB

		mult_modifier = {
			factor = 0.5
			ROOT = {
				trait = slothful
			}
		}
		mult_modifier = {
			factor = 0.2
			ROOT = {
				trait = impaler
			}
		}
		mult_modifier = {
			factor = 0.1
			ROOT = {
				trait = cruel
			}
		}
		mult_modifier = {
			factor = 0.5
			ROOT = {
				trait = deceitful
			}
		}
		mult_modifier = {
			factor = 3
			ROOT = {
				trait = kind
			}
		}
		mult_modifier = {
			factor = 2
			ROOT = {
				trait = just
			}
		}
		mult_modifier = {
			factor = 3
			ROOT = {
				trait = brave
			}
		}
		mult_modifier = {
			factor = 4
			ROOT = {
				trait = ambitious
			}
		}
		mult_modifier = {
			factor = 4
			ROOT = {
				trait = zealous
			}
		}
		mult_modifier = {
			factor = 0.01
			ROOT = {
				lower_real_tier_than = DUKE
			}
		}
	}
}

smite_evil_cb = {
	name = CB_NAME_SMITE_EVIL
	war_name = WAR_NAME_SMITE_EVIL
	sprite = 33
	truce_days = 900
	sort_priority = 500

	is_holy_war = yes
	is_permanent = yes
	can_ask_to_join_war = yes
	allowed_to_target_tributaries = no
	apply_short_occ_mod = no # Do not apply the 'recently_conquered' modifier to Holdings

	can_use_gui = {
		ROOT = {
			show_scope_change = no
			NOT = { has_character_modifier = smote_evil }

			trigger_if = {
				limit = {
					religion = triadic
					FROM = { olrox_is_good_religion_trigger = yes }
				}
				piety >= 125
			}
			trigger_else = {
				piety >= 75
			}
			war_cost = yes
		}
	}

	can_use = {
		ROOT = {
			OR = {
				religion = triadic
				religion = bahamut
				has_character_modifier = syncretic_triadic
				has_character_modifier = syncretic_bahamut
			}

			NOR = {
				mercenary = yes
				trait = creature_monster
			}
		}

		FROM = {
			OR = {
				is_evil_religion = yes
				AND ={
					trait = creature_fiend
					olrox_is_good_religion_trigger = no # to catch anomalous fiends and spare them
				}
				has_character_modifier = true_villain_modifier
				has_character_modifier = undead_realm_lord

				trigger_if = {
					limit = { has_character_modifier = fr_nomad_conquerer_modifier }
					NOT = { ROOT = { government = nomadic_tribal_government } }
				}

				trigger_if = {
					limit = { has_character_modifier = known_satanist }
					ROOT = {
						NOR = {
							secret_religion = infernal
							has_character_modifier = known_satanist
						}
					}
				}

				ROOT = {
					is_religious_enemy_of_PREV_trigger = yes
				}
			}
			NOT = { trait = creature_monster }

			distance_from_realm = {
				who = ROOT
				value < 500
			}
		}

		OR = {
			is_landed = yes
			is_patrician = yes
		}
	}

	is_valid = {
		ROOT = {
			OR = {
				religion = triadic
				religion = bahamut
				has_character_modifier = syncretic_triadic
				has_character_modifier = syncretic_bahamut
			}
		}

		FROM = {
			OR = {
				is_evil_religion = yes
				AND ={
					trait = creature_fiend
					olrox_is_good_religion_trigger = no # to catch anomalous fiends and spare them
				}
				has_character_modifier = true_villain_modifier
				has_character_modifier = undead_realm_lord
				has_character_modifier = fr_nomad_conquerer_modifier
				has_character_modifier = known_satanist
				ROOT = {
					is_religious_enemy_of_PREV_trigger = yes
				}
			}
		}
	}

	on_add = {
		attacker = {
			show_scope_change = no
			piety = -75
			declare_war_effect = yes
		}
	}

	on_success = {
		attacker = {
			show_scope_change = no

			participation_scaled_piety = 100
			participation_scaled_prestige = 100
			attacker_victory_effect = yes

			if = {
				limit = { uses_decadence = yes }
				participation_scaled_decadence = -10
			}

			religion_authority = {
				modifier = won_holy_war
				years = 20
			}

			hidden_effect = {
				if = {
					limit = { has_ambition = obj_strengthen_religion }
					change_variable = {
						which = strengthen_religion
						value = 1
					}
				}
			}

			add_character_modifier = {
				name = smote_evil
				years = 1
			}
		}

		any_attacker = {
			limit = { NOT = { character = attacker } }
			hidden_effect = {
				participation_scaled_piety = 100
				participation_scaled_prestige = 100

				if = {
					limit = { uses_decadence = yes }
					participation_scaled_decadence = -10
				}

				if = {
					limit = { has_ambition = obj_strengthen_religion }
					change_variable = {
						which = strengthen_religion
						value = 1
					}
				}
			}
		}

		defender = {
			show_scope_change = no

			prestige = -400

			imprison = attacker

			any_vassal = {
				limit = { higher_tier_than = BARON }
				set_defacto_liege = THIS
			}

			custom_tooltip = {
				text = abdicates_to_new_ruler_tooltip
				create_character = {
					age = 30
					random_traits = yes
					female = random
					religion = ROOT
					culture = ROOT
					dynasty = random
					flag = is_religious_liberation_ruler
				}
				new_character = {
					defender = {
						abdicate_to = PREV
					}

					capital_holding = {
						refill_holding_levy = yes
					}
					primary_title = {
						if = {
							limit = {
								PREV = {
									is_nomadic = no
									NOT = { government = celestial_bureaucracy }
								}
								OR = {
									has_law = revoke_title_law_0
									has_law = revoke_title_law_1
								}
							}
							add_law = revoke_title_law_2
						}
					}
					any_demesne_province = {
						religion = PREV
					}
					any_realm_character = {
						limit = {
							ai = yes
							OR = {
								AND = {
									trait = creature_fiend
									olrox_is_good_religion_trigger = no # to catch anomalous fiends and spare them
								}
								trait = undead
							}
						}
						death = {
							death_reason = death_execution
							killer = PREV
						}
					}
					any_realm_character = {
						limit = {
							ai = yes
							is_landed = no
							is_known_undead = yes
						}
						banish = yes
					}
					any_vassal = {
						limit = {
							ai = yes
							OR = {
								is_evil_religion = yes
								AND ={
									trait = creature_fiend
									olrox_is_good_religion_trigger = no # to catch anomalous fiends and spare them
								}
								has_character_modifier = true_villain_modifier
								has_character_modifier = undead_realm_lord
								has_character_modifier = fr_nomad_conquerer_modifier
								has_character_modifier = known_satanist
								ROOT = {
									is_religious_enemy_of_PREV_trigger = yes
								}
							}
						}
						imprison = PREV
					}
				}
			}
		}
	}

	on_fail = {
		attacker = {
			show_scope_change = no

			prestige = -100
			piety = -100
		}

		defender = {
			show_scope_change = no

			participation_scaled_prestige = 50
			participation_scaled_piety = 50
		}

		any_defender = {
			limit = { NOT = { character = defender } }
			hidden_effect = {
				participation_scaled_piety = 50
				participation_scaled_prestige = 50
			}
		}
	}

	on_reverse_demand = {
		attacker = {
			show_scope_change = no

			prestige = -200
			piety = -200
			transfer_scaled_wealth = {
				to = defender
				value = 4.0
			}
		}

		defender = {
			show_scope_change = no

			participation_scaled_prestige = 100
			participation_scaled_piety = 100
			defender_victory_effect = yes

			if = {
				limit = { uses_decadence = yes }
				participation_scaled_decadence = -10
			}

			religion_authority = {
				name = won_holy_war
				years = 20
			}

			hidden_effect = {
				if = {
					limit = { has_ambition = obj_strengthen_religion }

					change_variable = {
						which = strengthen_religion
						value = 1
					}
				}
			}
		}

		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_effect = {
				participation_scaled_piety = 100
				participation_scaled_prestige = 100

				if = {
					limit = { uses_decadence = yes }
					participation_scaled_decadence = -10
				}

				if = {
					limit = { has_ambition = obj_strengthen_religion }

					change_variable = {
						which = strengthen_religion
						value = 1
					}
				}
			}
		}
	}

	on_defender_leader_death = {
		any_attacker = {
			letter_event = { id = 251 } # Our enemy has died, the war has ended
		}

		end_war = invalid
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}

	attacker_ai_defeat_worth = {
		factor = 100
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}

	defender_ai_defeat_worth = {
		factor = 100
	}

	ai_will_do = {
		factor = 0.5

		mult_modifier = {
			factor = 0.5
			ROOT = {
				trait = slothful
			}
		}
		mult_modifier = {
			factor = 0.2
			ROOT = {
				trait = impaler
			}
		}
		mult_modifier = {
			factor = 0.1
			ROOT = {
				trait = cruel
			}
		}
		mult_modifier = {
			factor = 0.5
			ROOT = {
				trait = deceitful
			}
		}
		mult_modifier = {
			factor = 3
			ROOT = {
				trait = kind
			}
		}
		mult_modifier = {
			factor = 2
			ROOT = {
				trait = just
			}
		}
		mult_modifier = {
			factor = 3
			ROOT = {
				trait = brave
			}
		}
		mult_modifier = {
			factor = 4
			ROOT = {
				trait = ambitious
			}
		}
		mult_modifier = {
			factor = 4
			ROOT = {
				trait = zealous
			}
		}
	}
}

bahamut_dragonfall = {
	name = CB_NAME_DRAGONFALL
	war_name = WAR_NAME_DRAGONFALL
	sprite = 33
	truce_days = 900
	sort_priority = 550

	is_holy_war = yes
	is_permanent = yes
	can_ask_to_join_war = yes
	allowed_to_target_tributaries = no

	can_use_gui = {
		ROOT = {
			show_scope_change = no
			NOT = { has_character_modifier = dragon_slain }
			war_cost = yes
		}
	}

	can_use = {
		ROOT = {
			OR = {
				religion = bahamut
				has_character_modifier = syncretic_bahamut
			}

			mercenary = no
			NOT = { trait = creature_monster }
		}

		FROM = {
			prisoner = no
			OR = {
				culture = red_dragon
				culture = blue_dragon
				culture = green_dragon
				culture = white_dragon
				culture = black_dragon
				culture = brown_dragon
				culture = shadow_dragon
				AND = {
					trait = creature_dragon
					trait = lich
				}
				AND = {
					trait = creature_dragon
					is_evil_religion = yes
				}
			}
			olrox_is_good_religion_trigger = no
			NOT = { trait = creature_monster }

			distance_from_realm = {
				who = ROOT
				value < 500
			}
		}
	}

	is_valid = {
		ROOT = {
			OR = {
				religion = bahamut
				has_character_modifier = syncretic_bahamut
			}
		}

		FROM = {
			OR = {
				culture = red_dragon
				culture = blue_dragon
				culture = green_dragon
				culture = white_dragon
				culture = black_dragon
				culture = brown_dragon
				culture = shadow_dragon
				AND = {
					trait = creature_dragon
					trait = lich
				}
				AND = {
					trait = creature_dragon
					is_evil_religion = yes
				}
			}
			olrox_is_good_religion_trigger = no
		}
	}

	on_add = {
		attacker = {
			show_scope_change = no
			declare_war_effect = yes
		}
	}

	on_success = {
		attacker = {
			show_scope_change = no

			participation_scaled_piety = 150
			participation_scaled_prestige = 50
			attacker_victory_effect = yes

			if = {
				limit = { uses_decadence = yes }
				participation_scaled_decadence = -10
			}

			religion_authority = {
				modifier = won_holy_war
				years = 20
			}

			hidden_effect = {
				if = {
					limit = { has_ambition = obj_strengthen_religion }
					change_variable = {
						which = strengthen_religion
						value = 1
					}
				}
			}

			add_character_modifier = {
				name = dragon_slain
				years = 1
			}
		}

		any_attacker = {
			limit = { NOT = { character = attacker } }
			hidden_effect = {
				participation_scaled_piety = 150
				participation_scaled_prestige = 50

				if = {
					limit = { uses_decadence = yes }
					participation_scaled_decadence = -10
				}

				if = {
					limit = { has_ambition = obj_strengthen_religion }
					change_variable = {
						which = strengthen_religion
						value = 1
					}
				}
			}
		}

		defender = {
			show_scope_change = no

			death = {
				death_reason = death_execution
				killer = attacker
			}
		}
	}

	on_fail = {
		attacker = {
			show_scope_change = no

			prestige = -100
			piety = -100
		}

		defender = {
			show_scope_change = no

			participation_scaled_prestige = 50
			participation_scaled_piety = 50
		}

		any_defender = {
			limit = { NOT = { character = defender } }
			hidden_effect = {
				participation_scaled_piety = 50
				participation_scaled_prestige = 50
			}
		}
	}

	on_reverse_demand = {
		attacker = {
			show_scope_change = no

			prestige = -200
			piety = -200
			transfer_scaled_wealth = {
				to = defender
				value = 4.0
			}
		}

		defender = {
			show_scope_change = no

			participation_scaled_prestige = 100
			participation_scaled_piety = 100
			defender_victory_effect = yes

			if = {
				limit = { uses_decadence = yes }
				participation_scaled_decadence = -10
			}

			religion_authority = {
				name = won_holy_war
				years = 20
			}

			hidden_effect = {
				if = {
					limit = { has_ambition = obj_strengthen_religion }

					change_variable = {
						which = strengthen_religion
						value = 1
					}
				}
			}
		}

		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_effect = {
				participation_scaled_piety = 100
				participation_scaled_prestige = 100

				if = {
					limit = { uses_decadence = yes }
					participation_scaled_decadence = -10
				}

				if = {
					limit = { has_ambition = obj_strengthen_religion }

					change_variable = {
						which = strengthen_religion
						value = 1
					}
				}
			}
		}
	}

	on_defender_leader_death = {
		any_attacker = {
			letter_event = { id = 251 } # Our enemy has died, the war has ended
		}

		end_war = invalid
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}

	attacker_ai_defeat_worth = {
		factor = 100
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}

	defender_ai_defeat_worth = {
		factor = 100
	}

	ai_will_do = {
		factor = 0.5

		mult_modifier = {
			factor = 0.5
			ROOT = {
				trait = slothful
			}
		}
		mult_modifier = {
			factor = 0.5
			ROOT = {
				trait = content
			}
		}
		mult_modifier = {
			factor = 2
			ROOT = {
				trait = just
			}
		}
		mult_modifier = {
			factor = 3
			ROOT = {
				trait = brave
			}
		}
		mult_modifier = {
			factor = 4
			ROOT = {
				trait = ambitious
			}
		}
		mult_modifier = {
			factor = 4
			ROOT = {
				trait = zealous
			}
		}
	}
}

purge_beholder_cb = {
	name = CB_NAME_PURGE_BEHOLDER
	war_name = WAR_NAME_PURGE_BEHOLDER
	sprite = 33
	truce_days = 900
	sort_priority = 550

	is_holy_war = yes
	is_permanent = yes
	can_ask_to_join_war = yes
	allowed_to_target_tributaries = no
	apply_short_occ_mod = no # Do not apply the 'recently_conquered' modifier to Holdings

	can_use_gui = {
		ROOT = {
			show_scope_change = no
			NOT = { has_character_modifier = beholders_defeated }

			trigger_if = {
				limit = {
					religion = triadic
					FROM = { olrox_is_good_religion_trigger = yes }
				}
				piety >= 80
			}
			trigger_else = {
				piety >= 30
			}
			war_cost = yes
		}
	}

	can_use = {
		ROOT = {
			trait = patron_helm
			mercenary = no
		}

		FROM = {
			trait = creature_beholder
			NOT = { culture = spectator }

			distance_from_realm = {
				who = ROOT
				value < 500
			}
		}
	}

	is_valid = {
		ROOT = {
			trait = patron_helm
		}

		FROM = {
			trait = creature_beholder
		}
	}

	on_add = {
		attacker = {
			show_scope_change = no
			piety = -30
			declare_war_effect = yes
		}
	}

	on_success = {
		attacker = {
			show_scope_change = no

			participation_scaled_piety = 100
			participation_scaled_prestige = 100
			attacker_victory_effect = yes

			if = {
				limit = { uses_decadence = yes }
				participation_scaled_decadence = -10
			}

			religion_authority = {
				modifier = won_holy_war
				years = 20
			}

			hidden_effect = {
				if = {
					limit = { has_ambition = obj_strengthen_religion }
					change_variable = {
						which = strengthen_religion
						value = 1
					}
				}
			}

			add_character_modifier = {
				name = beholders_defeated
				years = 1
			}
		}

		any_attacker = {
			limit = { NOT = { character = attacker } }
			hidden_effect = {
				participation_scaled_piety = 100
				participation_scaled_prestige = 100

				if = {
					limit = { uses_decadence = yes }
					participation_scaled_decadence = -10
				}

				if = {
					limit = { has_ambition = obj_strengthen_religion }
					change_variable = {
						which = strengthen_religion
						value = 1
					}
				}
			}
		}

		defender = {
			show_scope_change = no

			any_vassal = {
				limit = { higher_tier_than = BARON }
				set_defacto_liege = THIS
			}

			any_demesne_title = {
				limit = {
					real_tier = COUNT
					county = {
						culture = beholder
					}
				}
				county = {
					culture = ROOT
					religion = ROOT
				}
			}

			custom_tooltip = {
				text = abdicates_to_new_ruler_tooltip
				create_character = {
					age = 30
					random_traits = yes
					female = random
					religion = ROOT
					culture = ROOT
					dynasty = random
					flag = is_religious_liberation_ruler
					trait = patron_helm
				}
				new_character = {
					defender = {
						abdicate_to = PREV
					}

					capital_holding = {
						refill_holding_levy = yes
					}
				}
			}

			death = {
				death_reason = death_execution
				killer = attacker
			}
		}
	}

	on_fail = {
		attacker = {
			show_scope_change = no

			prestige = -100
			piety = -100
		}

		defender = {
			show_scope_change = no

			participation_scaled_prestige = 50
			participation_scaled_piety = 50
		}

		any_defender = {
			limit = { NOT = { character = defender } }
			hidden_effect = {
				participation_scaled_piety = 50
				participation_scaled_prestige = 50
			}
		}
	}

	on_reverse_demand = {
		attacker = {
			show_scope_change = no

			prestige = -200
			piety = -200
			transfer_scaled_wealth = {
				to = defender
				value = 4.0
			}
		}

		defender = {
			show_scope_change = no

			participation_scaled_prestige = 100
			participation_scaled_piety = 100
			defender_victory_effect = yes

			if = {
				limit = { uses_decadence = yes }
				participation_scaled_decadence = -10
			}

			religion_authority = {
				name = won_holy_war
				years = 20
			}

			hidden_effect = {
				if = {
					limit = { has_ambition = obj_strengthen_religion }

					change_variable = {
						which = strengthen_religion
						value = 1
					}
				}
			}
		}

		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_effect = {
				participation_scaled_piety = 100
				participation_scaled_prestige = 100

				if = {
					limit = { uses_decadence = yes }
					participation_scaled_decadence = -10
				}

				if = {
					limit = { has_ambition = obj_strengthen_religion }

					change_variable = {
						which = strengthen_religion
						value = 1
					}
				}
			}
		}
	}

	on_defender_leader_death = {
		any_attacker = {
			letter_event = { id = 251 } # Our enemy has died, the war has ended
		}

		end_war = invalid
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}

	attacker_ai_defeat_worth = {
		factor = 100
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}

	defender_ai_defeat_worth = {
		factor = 100
	}

	ai_will_do = {
		factor = 0.5

		mult_modifier = {
			factor = 0.5
			ROOT = {
				trait = slothful
			}
		}
		mult_modifier = {
			factor = 0.5
			ROOT = {
				trait = content
			}
		}
		mult_modifier = {
			factor = 2
			ROOT = {
				trait = just
			}
		}
		mult_modifier = {
			factor = 3
			ROOT = {
				trait = brave
			}
		}
		mult_modifier = {
			factor = 4
			ROOT = {
				trait = ambitious
			}
		}
		mult_modifier = {
			factor = 4
			ROOT = {
				trait = zealous
			}
		}
	}
}

# tyr_apprehend_criminal = {
# 	name = CB_NAME_APPREHEND_CRIMINAL
# 	war_name = WAR_NAME_APPREHEND_CRIMINAL
# 	sprite = 33
# 	truce_days = 900
# 	sort_priority = 550

# 	is_holy_war = yes
# 	is_permanent = yes
# 	can_ask_to_join_war = yes
# 	allowed_to_target_tributaries = no

# 	can_use_gui = {
# 		ROOT = {
# 			show_scope_change = no
# 			NOT = { has_character_modifier = apprehended_criminal }

# 			trigger_if = {
# 				limit = {
# 					religion = triadic
# 					FROM = { olrox_is_good_religion_trigger = yes }
# 				}
# 				piety >= 80
# 			}
# 			trigger_else = {
# 				piety >= 30
# 			}
# 			war_cost = yes
# 		}
# 	}

# 	can_use = {
# 		ROOT = {
# 			trait = patron_tyr
# 			mercenary = no
# 		}

# 		FROM = {
# 			is_criminal = yes
# 			prisoner = no
# 			NOT = { trait = creature_monster }

# 			distance_from_realm = {
# 				who = ROOT
# 				value < 500
# 			}
# 		}
# 	}

# 	is_valid = {
# 		ROOT = {
# 			trait = patron_tyr
# 		}

# 		FROM = {
# 			is_criminal = yes
# 		}
# 	}

# 	on_add = {
# 		attacker = {
# 			show_scope_change = no
# 			piety = -30
# 			declare_war_effect = yes
# 		}
# 	}

# 	on_success = {
# 		attacker = {
# 			show_scope_change = no

# 			participation_scaled_piety = 150
# 			participation_scaled_prestige = 50
# 			attacker_victory_effect = yes

# 			if = {
# 				limit = { uses_decadence = yes }
# 				participation_scaled_decadence = -10
# 			}

# 			religion_authority = {
# 				modifier = won_holy_war
# 				years = 20
# 			}

# 			hidden_effect = {
# 				if = {
# 					limit = { has_ambition = obj_strengthen_religion }
# 					change_variable = {
# 						which = strengthen_religion
# 						value = 1
# 					}
# 				}
# 			}

# 			add_character_modifier = {
# 				name = apprehended_criminal
# 				years = 1
# 			}
# 		}

# 		any_attacker = {
# 			limit = { NOT = { character = attacker } }
# 			hidden_effect = {
# 				participation_scaled_piety = 150
# 				participation_scaled_prestige = 50

# 				if = {
# 					limit = { uses_decadence = yes }
# 					participation_scaled_decadence = -10
# 				}

# 				if = {
# 					limit = { has_ambition = obj_strengthen_religion }
# 					change_variable = {
# 						which = strengthen_religion
# 						value = 1
# 					}
# 				}
# 			}
# 		}

# 		defender = {
# 			show_scope_change = no

# 			prestige = -400
# 			imprison = ROOT
# 		}
# 	}

# 	on_fail = {
# 		attacker = {
# 			show_scope_change = no

# 			prestige = -100
# 			piety = -100
# 		}

# 		defender = {
# 			show_scope_change = no

# 			participation_scaled_prestige = 50
# 			participation_scaled_piety = 50
# 		}

# 		any_defender = {
# 			limit = { NOT = { character = defender } }
# 			hidden_effect = {
# 				participation_scaled_piety = 50
# 				participation_scaled_prestige = 50
# 			}
# 		}
# 	}

# 	on_reverse_demand = {
# 		attacker = {
# 			show_scope_change = no

# 			prestige = -200
# 			piety = -200
# 			transfer_scaled_wealth = {
# 				to = defender
# 				value = 4.0
# 			}
# 		}

# 		defender = {
# 			show_scope_change = no

# 			participation_scaled_prestige = 100
# 			participation_scaled_piety = 100
# 			defender_victory_effect = yes

# 			if = {
# 				limit = { uses_decadence = yes }
# 				participation_scaled_decadence = -10
# 			}

# 			religion_authority = {
# 				name = won_holy_war
# 				years = 20
# 			}

# 			hidden_effect = {
# 				if = {
# 					limit = { has_ambition = obj_strengthen_religion }

# 					change_variable = {
# 						which = strengthen_religion
# 						value = 1
# 					}
# 				}
# 			}
# 		}

# 		any_defender = {
# 			limit = { NOT = { character = FROM } }
# 			hidden_effect = {
# 				participation_scaled_piety = 100
# 				participation_scaled_prestige = 100

# 				if = {
# 					limit = { uses_decadence = yes }
# 					participation_scaled_decadence = -10
# 				}

# 				if = {
# 					limit = { has_ambition = obj_strengthen_religion }

# 					change_variable = {
# 						which = strengthen_religion
# 						value = 1
# 					}
# 				}
# 			}
# 		}
# 	}

# 	on_defender_leader_death = {
# 		any_attacker = {
# 			letter_event = { id = 251 } # Our enemy has died, the war has ended
# 		}

# 		end_war = invalid
# 	}

# 	attacker_ai_victory_worth = {
# 		factor = -1 # always accept
# 	}

# 	attacker_ai_defeat_worth = {
# 		factor = 100
# 	}

# 	defender_ai_victory_worth = {
# 		factor = -1 # always accept
# 	}

# 	defender_ai_defeat_worth = {
# 		factor = 100
# 	}

# 	ai_will_do = {
# 		factor = 0.5

# 		mult_modifier = {
# 			factor = 0.5
# 			ROOT = {
# 				trait = slothful
# 			}
# 		}
# 		mult_modifier = {
# 			factor = 0.5
# 			ROOT = {
# 				trait = content
# 			}
# 		}
# 		mult_modifier = {
# 			factor = 2
# 			ROOT = {
# 				trait = just
# 			}
# 		}
# 		mult_modifier = {
# 			factor = 3
# 			ROOT = {
# 				trait = brave
# 			}
# 		}
# 		mult_modifier = {
# 			factor = 4
# 			ROOT = {
# 				trait = ambitious
# 			}
# 		}
# 		mult_modifier = {
# 			factor = 4
# 			ROOT = {
# 				trait = zealous
# 			}
# 		}
# 	}
# }


purge_undead_cb = {
	name = CB_NAME_PURGE_UNDEAD
	war_name = WAR_NAME_PURGE_UNDEAD
	sprite = 33
	truce_days = 900
	sort_priority = 550

	is_holy_war = yes
	is_permanent = yes
	can_ask_to_join_war = yes
	allowed_to_target_tributaries = no
	apply_short_occ_mod = no # Do not apply the 'recently_conquered' modifier to Holdings

	can_use_gui = {
		ROOT = {
			show_scope_change = no
			NOT = { has_character_modifier = undead_defeated }

			trigger_if = {
				limit = {
					religion = triadic
					FROM = { olrox_is_good_religion_trigger = yes }
				}
				piety >= 80
			}
			trigger_else = {
				piety >= 30
			}
			war_cost = yes
		}
	}

	can_use = {
		ROOT = {
			trait = patron_kelemvor
			mercenary = no
		}

		FROM = {
			OR = {
				trait = undead
				trait = lich
				trait = archlich
				has_character_modifier = known_vamp_modifier
				trait = lich_baelnorn
			}

			distance_from_realm = {
				who = ROOT
				value < 500
			}
		}
	}

	is_valid = {
		ROOT = {
			trait = patron_kelemvor
		}

		FROM = {
			OR = {
				trait = undead
				trait = lich
				trait = archlich
				trait = lich_baelnorn
			}
		}
	}

	on_add = {
		attacker = {
			show_scope_change = no
			piety = -30
			declare_war_effect = yes
		}
	}

	on_success = {
		attacker = {
			show_scope_change = no

			participation_scaled_piety = 100
			participation_scaled_prestige = 100
			attacker_victory_effect = yes

			if = {
				limit = { uses_decadence = yes }
				participation_scaled_decadence = -10
			}

			religion_authority = {
				modifier = won_holy_war
				years = 20
			}

			hidden_effect = {
				if = {
					limit = { has_ambition = obj_strengthen_religion }
					change_variable = {
						which = strengthen_religion
						value = 1
					}
				}
			}

			add_character_modifier = {
				name = undead_defeated
				years = 1
			}
		}

		any_attacker = {
			limit = { NOT = { character = attacker } }
			hidden_effect = {
				participation_scaled_piety = 100
				participation_scaled_prestige = 100

				if = {
					limit = { uses_decadence = yes }
					participation_scaled_decadence = -10
				}

				if = {
					limit = { has_ambition = obj_strengthen_religion }
					change_variable = {
						which = strengthen_religion
						value = 1
					}
				}
			}
		}

		defender = {
			show_scope_change = no

			any_vassal = {
				limit = { higher_tier_than = BARON }
				set_defacto_liege = THIS
			}

			any_demesne_title = {
				limit = {
					real_tier = COUNT
					county = {
						has_province_modifier = undead_province
					}
				}
				county = {
					remove_province_modifier = undead_province
				}
			}

			custom_tooltip = {
				text = abdicates_to_new_ruler_tooltip
				create_character = {
					age = 30
					random_traits = yes
					female = random
					religion = ROOT
					culture = ROOT
					dynasty = random
					flag = is_religious_liberation_ruler
					trait = patron_kelemvor
				}
				new_character = {
					defender = {
						abdicate_to = PREV
					}

					capital_holding = {
						refill_holding_levy = yes
					}
				}
			}

			death = {
				death_reason = death_execution
				killer = attacker
			}
		}
	}

	on_fail = {
		attacker = {
			show_scope_change = no

			prestige = -100
			piety = -100
		}

		defender = {
			show_scope_change = no

			participation_scaled_prestige = 50
			participation_scaled_piety = 50
		}

		any_defender = {
			limit = { NOT = { character = defender } }
			hidden_effect = {
				participation_scaled_piety = 50
				participation_scaled_prestige = 50
			}
		}
	}

	on_reverse_demand = {
		attacker = {
			show_scope_change = no

			prestige = -200
			piety = -200
			transfer_scaled_wealth = {
				to = defender
				value = 4.0
			}
		}

		defender = {
			show_scope_change = no

			participation_scaled_prestige = 100
			participation_scaled_piety = 100
			defender_victory_effect = yes

			if = {
				limit = { uses_decadence = yes }
				participation_scaled_decadence = -10
			}

			religion_authority = {
				name = won_holy_war
				years = 20
			}

			hidden_effect = {
				if = {
					limit = { has_ambition = obj_strengthen_religion }

					change_variable = {
						which = strengthen_religion
						value = 1
					}
				}
			}
		}

		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_effect = {
				participation_scaled_piety = 100
				participation_scaled_prestige = 100

				if = {
					limit = { uses_decadence = yes }
					participation_scaled_decadence = -10
				}

				if = {
					limit = { has_ambition = obj_strengthen_religion }

					change_variable = {
						which = strengthen_religion
						value = 1
					}
				}
			}
		}
	}

	on_defender_leader_death = {
		any_attacker = {
			letter_event = { id = 251 } # Our enemy has died, the war has ended
		}

		end_war = invalid
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}

	attacker_ai_defeat_worth = {
		factor = 100
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}

	defender_ai_defeat_worth = {
		factor = 100
	}

	ai_will_do = {
		factor = 0.5

		mult_modifier = {
			factor = 0.5
			ROOT = {
				trait = slothful
			}
		}
		mult_modifier = {
			factor = 0.5
			ROOT = {
				trait = content
			}
		}
		mult_modifier = {
			factor = 2
			ROOT = {
				trait = just
			}
		}
		mult_modifier = {
			factor = 3
			ROOT = {
				trait = brave
			}
		}
		mult_modifier = {
			factor = 4
			ROOT = {
				trait = ambitious
			}
		}
		mult_modifier = {
			factor = 4
			ROOT = {
				trait = zealous
			}
		}
	}
}